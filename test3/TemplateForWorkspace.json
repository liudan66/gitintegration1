{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "asaworkspacevshah"
		},
		"ADBDeltaLake_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'ADBDeltaLake'"
		},
		"AzureMLService1_servicePrincipalKey": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalKey' of 'AzureMLService1'"
		},
		"CosmosDb1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDb1'"
		},
		"LSAzureSqlOD_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LSAzureSqlOD'"
		},
		"asadatalakevshah_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'asadatalakevshah'"
		},
		"asastorevshah_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'asastorevshah'"
		},
		"asaworkspacevshah-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'asaworkspacevshah-WorkspaceDefaultSqlServer'"
		},
		"dwYelp_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'dwYelp'"
		},
		"dwyelp2_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'dwyelp2'"
		},
		"explrazstorage_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'explrazstorage'"
		},
		"sfdc_vrlshah_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'sfdc_vrlshah'"
		},
		"sfdc_vrlshah_securityToken": {
			"type": "secureString",
			"metadata": "Secure string for 'securityToken' of 'sfdc_vrlshah'"
		},
		"sqlpool01_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sqlpool01'"
		},
		"sqlpool01_workload01_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sqlpool01_workload01'"
		},
		"sqlpool01_workload02_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sqlpool01_workload02'"
		},
		"AzureMLService1_properties_typeProperties_subscriptionId": {
			"type": "string",
			"defaultValue": "982f0ec6-f886-45e3-9ba3-e777611a1369"
		},
		"AzureMLService1_properties_typeProperties_resourceGroupName": {
			"type": "string",
			"defaultValue": "Synapse-MCW"
		},
		"AzureMLService1_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "22d4f4ff-e719-4440-8b43-da4c0caea12f"
		},
		"AzureMLService1_properties_typeProperties_tenant": {
			"type": "string",
			"defaultValue": "72f988bf-86f1-41af-91ab-2d7cd011db47"
		},
		"asadatalakevshah_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://asadatalakevshah.dfs.core.windows.net"
		},
		"asakeyvaultvshah_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://asakeyvaultvshah.vault.azure.net/"
		},
		"asaworkspacevshah-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://asadatalakevshah.dfs.core.windows.net"
		},
		"ctrxdatalake01_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'ctrxdatalake01'"
		},
		"explrazstorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://explrazstorage.dfs.core.windows.net"
		},
		"sfdc_vrlshah_properties_typeProperties_environmentUrl": {
			"type": "string",
			"defaultValue": "https://login.salesforce.com"
		},
		"sfdc_vrlshah_properties_typeProperties_username": {
			"type": "string",
			"defaultValue": "vrlshah@yahoo.com"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/DebugFailCase3')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "catest",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "56g",
					"driverCores": 8,
					"executorMemory": "56g",
					"executorCores": 8,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/be3e6d5c-f54f-474d-ae7e-128a5af5a691/resourceGroups/BCDR_Test01/providers/Microsoft.Synapse/workspaces/targetwsvenkatp1/bigDataPools/catest",
						"name": "catest",
						"type": "Spark",
						"endpoint": "https://dantestpara.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/catest",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 10,
						"cores": 8,
						"memory": 56,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							}
						},
						"source": [
							"%%pyspark\n",
							"\n",
							"# Designed to fail with a runtime error based on the input data\n",
							"from pyspark.sql.functions import udf\n",
							"from pyspark.sql.types import IntegerType\n",
							"\n",
							"def f(value):\n",
							"    return 100 / (value-74)\n",
							"udf_f = udf(f, IntegerType())\n",
							"\n",
							"u = \"abfss://datasets@contosolake.dfs.core.windows.net/SearchLog/SearchLog.parquet\"\n",
							"df = spark.read.load(u,format='parquet')\n",
							"df2 = df.withColumn( 'f', udf_f(\"latency\"))\n",
							"df2.show(100)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Pipeline 1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Notebook1",
						"type": "SynapseNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "DebugFailCase3",
								"type": "NotebookReference"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2021-02-24T03:28:11Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/notebooks/DebugFailCase3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger 2')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Pipeline 1",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 16,
						"startTime": "2021-02-24T06:33:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Pipeline 1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 2 - Copy Campaign Analytics Data')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ASAMCW_Exercise_2_Campaign_Analytics_Data",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ASAMCW_Exercise_2_Campaign_Analytics_Data",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"campaignanalyticscsv": {},
									"campaignanlyticsasa": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "asadatalakevshah",
									"type": "LinkedServiceReference"
								},
								"folderPath": "staging/mcwcampaignanalytics"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:16Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/ASAMCW_Exercise_2_Campaign_Analytics_Data')]",
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 2 - Copy Customer Information')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy Customer Information",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi_mcw.CustomerInfo",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "UserName",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "UserName",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Gender",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Gender",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Phone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Email",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Email",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CreditCard",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CreditCard",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "asamcw_customerinfo_csv",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "asamcw_customerinfo_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:09Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_customerinfo_csv')]",
				"[concat(variables('workspaceId'), '/datasets/asamcw_customerinfo_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 2 - Copy Product Information')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy Product Information",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi_mcw.Product",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": true
								},
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "String",
											"ordinal": 1
										},
										"sink": {
											"name": "ProductId",
											"type": "Int16"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 2
										},
										"sink": {
											"name": "Seasonality",
											"type": "Byte"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 3
										},
										"sink": {
											"name": "Price",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 4
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "asamcw_product_csv",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "asamcw_product_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:02Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_product_csv')]",
				"[concat(variables('workspaceId'), '/datasets/asamcw_product_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 2 - Copy Sale Data')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "ASAMCW_Exercise_2_2018_and_2019_Sales",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ASAMCW_Exercise_2_2018_and_2019_Sales",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"salesdata": {},
									"sale": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "asadatalakevshah",
									"type": "LinkedServiceReference"
								},
								"folderPath": "staging/mcwsales"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:12Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/ASAMCW_Exercise_2_2018_and_2019_Sales')]",
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 7 - ExecuteBusinessAnalystQueries')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Analyst",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(1,10)",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Workload 2 for Data Analyst",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "select count(X.A) from (\nselect CAST(CustomerId as nvarchar(20)) as A from wwi_mcw.SaleSmall) X where A like '%3%'",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "asamcw_wwi_salesmall_workload1_asa",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:39:50Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_wwi_salesmall_workload1_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW - Exercise 7 - ExecuteDataAnalystAndCEOQueries')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "CEO",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(1,20)",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Workload 1 for CEO",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "select count(X.A) from (\nselect CAST(CustomerId as nvarchar(20)) as A from wwi_mcw.SaleSmall) X where A like '%3%'",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "asamcw_wwi_salesmall_workload1_asa",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					},
					{
						"name": "Analyst",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@range(1,20)",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Workload 2 for Data Analyst",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "SqlDWSource",
											"sqlReaderQuery": "select count(X.A) from (\nselect CAST(CustomerId as nvarchar(20)) as A from wwi_mcw.SaleSmall) X where A like '%3%'",
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "asamcw_wwi_salesmall_workload2_asa",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							]
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:39:58Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_wwi_salesmall_workload1_asa')]",
				"[concat(variables('workspaceId'), '/datasets/asamcw_wwi_salesmall_workload2_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyPipeline_YelpBusiness')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_xl6",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "sample-data/kaggle/Yelp/business.json"
							},
							{
								"name": "Destination",
								"value": "dbo.Yelp_Business"
							}
						],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink"
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastorevshah",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['business_id']"
										},
										"sink": {
											"name": "business_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['name']"
										},
										"sink": {
											"name": "name",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['address']"
										},
										"sink": {
											"name": "address",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['city']"
										},
										"sink": {
											"name": "city",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['state']"
										},
										"sink": {
											"name": "state",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['postal_code']"
										},
										"sink": {
											"name": "postal_code",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['latitude']"
										},
										"sink": {
											"name": "latitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['longitude']"
										},
										"sink": {
											"name": "longitude",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['stars']"
										},
										"sink": {
											"name": "stars",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['review_count']"
										},
										"sink": {
											"name": "review_count",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['is_open']"
										},
										"sink": {
											"name": "is_open",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['categories']"
										},
										"sink": {
											"name": "categories",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_YelpBusiness_xl6",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_YelpBusiness_xl6",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:20Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_YelpBusiness_xl6')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_YelpBusiness_xl6')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastorevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyPipeline_YelpCheckin')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_icc",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "sample-data/kaggle/Yelp/checkin.json"
							},
							{
								"name": "Destination",
								"value": "dbo.yelp_checkin"
							}
						],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink"
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastorevshah",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['business_id']"
										},
										"sink": {
											"name": "business_id",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['date']"
										},
										"sink": {
											"name": "date",
											"type": "String"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_YelpCheckin_icc",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_YelpCheckin_icc",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:15Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_YelpCheckin_icc')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_YelpCheckin_icc')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastorevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ProcessCosmosDBTelemetry')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "AvgSpeedByCity",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AvgSpeedByCityJSON",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SODtelemetry": {},
									"AvgSpeedByCity": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:31Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/AvgSpeedByCityJSON')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpBusiness')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Dataflow_YelpBusiness",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Dataflow_YelpBusiness",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"jsonYelpBusiness": {},
									"asaYelpBusiness": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "asastorevshah",
									"type": "LinkedServiceReference"
								},
								"folderPath": "staging"
							},
							"integrationRuntime": {
								"referenceName": "AzureIntegrationRuntime01",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:24Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/Dataflow_YelpBusiness')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastorevshah')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AzureIntegrationRuntime01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpCheckin')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Dataflow_YelpCheckin",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Dataflow_YelpCheckin",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"jsonYelpCheckin": {},
									"asaYelpCheckin": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "asastorevshah",
									"type": "LinkedServiceReference"
								},
								"folderPath": "staging"
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:20Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/Dataflow_YelpCheckin')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastorevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/csv2sfdc-upsert')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SalesforceSink",
								"writeBatchSize": 5000,
								"writeBehavior": "upsert",
								"externalIdFieldName": "Id",
								"ignoreNullValues": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AccountID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Id",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ParentId",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ParentId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingStreet",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingStreet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingCity",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingCity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingState",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingState",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingPostalCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingPostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingCountry",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingLatitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingLatitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "BillingLongitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingLongitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "BillingGeocodeAccuracy",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BillingGeocodeAccuracy",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingStreet",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingStreet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingCity",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingCity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingState",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingState",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingPostalCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingPostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingCountry",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingLatitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingLatitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ShippingLongitude",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingLongitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ShippingGeocodeAccuracy",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ShippingGeocodeAccuracy",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Phone",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Fax",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Fax",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AccountNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Website",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Website",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Sic",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Sic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Industry",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Industry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AnnualRevenue",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AnnualRevenue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "NumberOfEmployees",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NumberOfEmployees",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Ownership",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Ownership",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TickerSymbol",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TickerSymbol",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Rating",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Rating",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Site",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "OwnerId",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "OwnerId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Jigsaw",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Jigsaw",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CleanStatus",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CleanStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AccountSource",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AccountSource",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DunsNumber",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DunsNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Tradestyle",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Tradestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NaicsCode",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NaicsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NaicsDesc",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NaicsDesc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "YearStarted",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "YearStarted",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SicDesc",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SicDesc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DandbCompanyId",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DandbCompanyId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CustomerPriority__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CustomerPriority__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SLA__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SLA__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Active__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Active__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NumberofLocations__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NumberofLocations__c",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "UpsellOpportunity__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "UpsellOpportunity__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SLASerialNumber__c",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SLASerialNumber__c",
											"type": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DestinationDataset_fi2",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SourceDataset_fi2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:31Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_fi2')]",
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_fi2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/load_citrixsample')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "citrixdelim2parquet",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dfcitrixcustdelimload",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:42:38Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/dfcitrixcustdelimload')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sfdc2csv')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_fi2",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "Account"
							},
							{
								"name": "Destination",
								"value": "sfdc//accounts"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SalesforceSource",
								"readBehavior": "queryAll"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Id",
											"type": "String"
										},
										"sink": {
											"name": "key"
										}
									},
									{
										"source": {
											"name": "IsDeleted",
											"type": "Boolean"
										},
										"sink": {
											"name": "IsDeleted",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "MasterRecordId",
											"type": "String"
										},
										"sink": {
											"name": "MasterRecordId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Name",
											"type": "String"
										},
										"sink": {
											"name": "Name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Type",
											"type": "String"
										},
										"sink": {
											"name": "Type",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ParentId",
											"type": "String"
										},
										"sink": {
											"name": "ParentId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingStreet",
											"type": "String"
										},
										"sink": {
											"name": "BillingStreet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingCity",
											"type": "String"
										},
										"sink": {
											"name": "BillingCity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingState",
											"type": "String"
										},
										"sink": {
											"name": "BillingState",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingPostalCode",
											"type": "String"
										},
										"sink": {
											"name": "BillingPostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingCountry",
											"type": "String"
										},
										"sink": {
											"name": "BillingCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "BillingLatitude",
											"type": "Decimal"
										},
										"sink": {
											"name": "BillingLatitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "BillingLongitude",
											"type": "Decimal"
										},
										"sink": {
											"name": "BillingLongitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "BillingGeocodeAccuracy",
											"type": "String"
										},
										"sink": {
											"name": "BillingGeocodeAccuracy",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingStreet",
											"type": "String"
										},
										"sink": {
											"name": "ShippingStreet",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingCity",
											"type": "String"
										},
										"sink": {
											"name": "ShippingCity",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingState",
											"type": "String"
										},
										"sink": {
											"name": "ShippingState",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingPostalCode",
											"type": "String"
										},
										"sink": {
											"name": "ShippingPostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingCountry",
											"type": "String"
										},
										"sink": {
											"name": "ShippingCountry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ShippingLatitude",
											"type": "Decimal"
										},
										"sink": {
											"name": "ShippingLatitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ShippingLongitude",
											"type": "Decimal"
										},
										"sink": {
											"name": "ShippingLongitude",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "ShippingGeocodeAccuracy",
											"type": "String"
										},
										"sink": {
											"name": "ShippingGeocodeAccuracy",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Phone",
											"type": "String"
										},
										"sink": {
											"name": "Phone",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Fax",
											"type": "String"
										},
										"sink": {
											"name": "Fax",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AccountNumber",
											"type": "String"
										},
										"sink": {
											"name": "AccountNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Website",
											"type": "String"
										},
										"sink": {
											"name": "Website",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "PhotoUrl",
											"type": "String"
										},
										"sink": {
											"name": "PhotoUrl",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Sic",
											"type": "String"
										},
										"sink": {
											"name": "Sic",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Industry",
											"type": "String"
										},
										"sink": {
											"name": "Industry",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AnnualRevenue",
											"type": "Decimal"
										},
										"sink": {
											"name": "AnnualRevenue",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "NumberOfEmployees",
											"type": "Int32"
										},
										"sink": {
											"name": "NumberOfEmployees",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Ownership",
											"type": "String"
										},
										"sink": {
											"name": "Ownership",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "TickerSymbol",
											"type": "String"
										},
										"sink": {
											"name": "TickerSymbol",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Rating",
											"type": "String"
										},
										"sink": {
											"name": "Rating",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String"
										},
										"sink": {
											"name": "Site",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "OwnerId",
											"type": "String"
										},
										"sink": {
											"name": "OwnerId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CreatedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreatedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "CreatedById",
											"type": "String"
										},
										"sink": {
											"name": "CreatedById",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "LastModifiedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastModifiedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "LastModifiedById",
											"type": "String"
										},
										"sink": {
											"name": "LastModifiedById",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SystemModstamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "SystemModstamp",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "LastActivityDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastActivityDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "LastViewedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastViewedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "LastReferencedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastReferencedDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Jigsaw",
											"type": "String"
										},
										"sink": {
											"name": "Jigsaw",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "JigsawCompanyId",
											"type": "String"
										},
										"sink": {
											"name": "JigsawCompanyId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CleanStatus",
											"type": "String"
										},
										"sink": {
											"name": "CleanStatus",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "AccountSource",
											"type": "String"
										},
										"sink": {
											"name": "AccountSource",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DunsNumber",
											"type": "String"
										},
										"sink": {
											"name": "DunsNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Tradestyle",
											"type": "String"
										},
										"sink": {
											"name": "Tradestyle",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NaicsCode",
											"type": "String"
										},
										"sink": {
											"name": "NaicsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NaicsDesc",
											"type": "String"
										},
										"sink": {
											"name": "NaicsDesc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "YearStarted",
											"type": "String"
										},
										"sink": {
											"name": "YearStarted",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SicDesc",
											"type": "String"
										},
										"sink": {
											"name": "SicDesc",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "DandbCompanyId",
											"type": "String"
										},
										"sink": {
											"name": "DandbCompanyId",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CustomerPriority__c",
											"type": "String"
										},
										"sink": {
											"name": "CustomerPriority__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SLA__c",
											"type": "String"
										},
										"sink": {
											"name": "SLA__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Active__c",
											"type": "String"
										},
										"sink": {
											"name": "Active__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "NumberofLocations__c",
											"type": "Decimal"
										},
										"sink": {
											"name": "NumberofLocations__c",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "UpsellOpportunity__c",
											"type": "String"
										},
										"sink": {
											"name": "UpsellOpportunity__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SLASerialNumber__c",
											"type": "String"
										},
										"sink": {
											"name": "SLASerialNumber__c",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SLAExpirationDate__c",
											"type": "DateTime"
										},
										"sink": {
											"name": "SLAExpirationDate__c",
											"type": "DateTime"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_fi2",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_fi2",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-01-12T22:41:26Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_fi2')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_fi2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AvgCitySpeed')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "staging"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_YelpBusiness_xl6')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dwyelp2",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "business_id",
						"type": "nvarchar"
					},
					{
						"name": "name",
						"type": "nvarchar"
					},
					{
						"name": "address",
						"type": "nvarchar"
					},
					{
						"name": "city",
						"type": "nvarchar"
					},
					{
						"name": "state",
						"type": "nvarchar"
					},
					{
						"name": "postal_code",
						"type": "nvarchar"
					},
					{
						"name": "latitude",
						"type": "float",
						"precision": 15
					},
					{
						"name": "longitude",
						"type": "float",
						"precision": 15
					},
					{
						"name": "stars",
						"type": "float",
						"precision": 15
					},
					{
						"name": "review_count",
						"type": "nvarchar"
					},
					{
						"name": "is_open",
						"type": "nvarchar"
					},
					{
						"name": "categories",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Yelp_Business"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dwyelp2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_YelpCheckin_icc')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "business_id",
						"type": "nvarchar"
					},
					{
						"name": "date",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "yelp_checkin"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_fi2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "accounts",
						"fileSystem": "sfdc"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_YelpBusiness_xl6')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "business.json",
						"folderPath": "kaggle/Yelp",
						"fileSystem": "sample-data"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"business_id": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"address": {
							"type": "string"
						},
						"city": {
							"type": "string"
						},
						"state": {
							"type": "string"
						},
						"postal_code": {
							"type": "string"
						},
						"latitude": {
							"type": "number"
						},
						"longitude": {
							"type": "number"
						},
						"stars": {
							"type": "number"
						},
						"review_count": {
							"type": "integer"
						},
						"is_open": {
							"type": "integer"
						},
						"attributes": {
							"type": "object",
							"properties": {
								"GoodForKids": {
									"type": "string"
								},
								"RestaurantsReservations": {
									"type": "string"
								},
								"GoodForMeal": {
									"type": "string"
								},
								"BusinessParking": {
									"type": "string"
								},
								"Caters": {
									"type": "string"
								},
								"NoiseLevel": {
									"type": "string"
								},
								"RestaurantsTableService": {
									"type": "string"
								},
								"RestaurantsTakeOut": {
									"type": "string"
								},
								"RestaurantsPriceRange2": {
									"type": "string"
								},
								"OutdoorSeating": {
									"type": "string"
								},
								"BikeParking": {
									"type": "string"
								},
								"Ambience": {
									"type": "string"
								},
								"HasTV": {
									"type": "string"
								},
								"WiFi": {
									"type": "string"
								},
								"Alcohol": {
									"type": "string"
								},
								"RestaurantsAttire": {
									"type": "string"
								},
								"RestaurantsGoodForGroups": {
									"type": "string"
								},
								"RestaurantsDelivery": {
									"type": "string"
								},
								"BusinessAcceptsCreditCards": {
									"type": "string"
								},
								"BusinessAcceptsBitcoin": {
									"type": "string"
								},
								"ByAppointmentOnly": {
									"type": "string"
								},
								"AcceptsInsurance": {
									"type": "string"
								}
							}
						},
						"categories": {
							"type": "string"
						},
						"hours": {
							"type": "object",
							"properties": {
								"Monday": {
									"type": "string"
								},
								"Tuesday": {
									"type": "string"
								},
								"Wednesday": {
									"type": "string"
								},
								"Thursday": {
									"type": "string"
								},
								"Friday": {
									"type": "string"
								},
								"Saturday": {
									"type": "string"
								},
								"Sunday": {
									"type": "string"
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_YelpCheckin_icc')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "checkin.json",
						"folderPath": "kaggle/Yelp",
						"fileSystem": "sample-data"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"business_id": {
							"type": "string"
						},
						"date": {
							"type": "string"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_fi2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sfdc_vrlshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SalesforceObject",
				"schema": [],
				"typeProperties": {
					"objectApiName": "Account"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sfdc_vrlshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpBusiness')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "business.json",
						"folderPath": "kaggle/Yelp",
						"fileSystem": "sample-data"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"business_id": {
							"type": "string"
						},
						"name": {
							"type": "string"
						},
						"address": {
							"type": "string"
						},
						"city": {
							"type": "string"
						},
						"state": {
							"type": "string"
						},
						"postal_code": {
							"type": "string"
						},
						"latitude": {
							"type": "number"
						},
						"longitude": {
							"type": "number"
						},
						"stars": {
							"type": "number"
						},
						"review_count": {
							"type": "integer"
						},
						"is_open": {
							"type": "integer"
						},
						"attributes": {
							"type": "object",
							"properties": {
								"GoodForKids": {
									"type": "string"
								},
								"RestaurantsReservations": {
									"type": "string"
								},
								"GoodForMeal": {
									"type": "string"
								},
								"BusinessParking": {
									"type": "string"
								},
								"Caters": {
									"type": "string"
								},
								"NoiseLevel": {
									"type": "string"
								},
								"RestaurantsTableService": {
									"type": "string"
								},
								"RestaurantsTakeOut": {
									"type": "string"
								},
								"RestaurantsPriceRange2": {
									"type": "string"
								},
								"OutdoorSeating": {
									"type": "string"
								},
								"BikeParking": {
									"type": "string"
								},
								"Ambience": {
									"type": "string"
								},
								"HasTV": {
									"type": "string"
								},
								"WiFi": {
									"type": "string"
								},
								"Alcohol": {
									"type": "string"
								},
								"RestaurantsAttire": {
									"type": "string"
								},
								"RestaurantsGoodForGroups": {
									"type": "string"
								},
								"RestaurantsDelivery": {
									"type": "string"
								},
								"BusinessAcceptsCreditCards": {
									"type": "string"
								},
								"BusinessAcceptsBitcoin": {
									"type": "string"
								},
								"ByAppointmentOnly": {
									"type": "string"
								},
								"AcceptsInsurance": {
									"type": "string"
								}
							}
						},
						"categories": {
							"type": "string"
						},
						"hours": {
							"type": "object",
							"properties": {
								"Monday": {
									"type": "string"
								},
								"Tuesday": {
									"type": "string"
								},
								"Wednesday": {
									"type": "string"
								},
								"Thursday": {
									"type": "string"
								},
								"Friday": {
									"type": "string"
								},
								"Saturday": {
									"type": "string"
								},
								"Sunday": {
									"type": "string"
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpBusiness_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "dwYelp",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "Yelp_Business"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/dwYelp')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpCheckin')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "checkin.json",
						"folderPath": "kaggle/Yelp",
						"fileSystem": "sample-data"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"business_id": {
							"type": "string"
						},
						"date": {
							"type": "string"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/YelpCheckin_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "yelp_checkin"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_campaignanalytics_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "Region",
						"type": "nvarchar"
					},
					{
						"name": "Country",
						"type": "nvarchar"
					},
					{
						"name": "ProductCategory",
						"type": "nvarchar"
					},
					{
						"name": "CampaignName",
						"type": "nvarchar"
					},
					{
						"name": "Analyst",
						"type": "nvarchar"
					},
					{
						"name": "Revenue",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "RevenueTarget",
						"type": "decimal",
						"precision": 10,
						"scale": 2
					},
					{
						"name": "City",
						"type": "nvarchar"
					},
					{
						"name": "State",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "CampaignAnalytics"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_campaignanalytics_csv')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "campaignanalytics.csv",
						"folderPath": "campaign-analytics",
						"fileSystem": "wwi-02"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_customerinfo_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "UserName",
						"type": "nvarchar"
					},
					{
						"name": "Gender",
						"type": "nvarchar"
					},
					{
						"name": "Phone",
						"type": "nvarchar"
					},
					{
						"name": "Email",
						"type": "nvarchar"
					},
					{
						"name": "CreditCard",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "CustomerInfo"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_customerinfo_csv')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "customerinfo.csv",
						"folderPath": "customer-info",
						"fileSystem": "wwi-02"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "UserName",
						"type": "String"
					},
					{
						"name": "Gender",
						"type": "String"
					},
					{
						"name": "Phone",
						"type": "String"
					},
					{
						"name": "Email",
						"type": "String"
					},
					{
						"name": "CreditCard",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_product_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionId",
						"type": "uniqueidentifier"
					},
					{
						"name": "CustomerId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductId",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "Quantity",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Price",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TotalAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TransactionDateId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProfitAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "Hour",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Minute",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "StoreId",
						"type": "smallint",
						"precision": 5
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "Product"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_product_csv')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "generator-product.csv",
						"folderPath": "data-generators/generator-product",
						"container": "wwi-02"
					},
					"columnDelimiter": ",",
					"escapeChar": "",
					"quoteChar": ""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_sale_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionId",
						"type": "uniqueidentifier"
					},
					{
						"name": "CustomerId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductId",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "Quantity",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Price",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TotalAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TransactionDateId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProfitAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "Hour",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Minute",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "StoreId",
						"type": "smallint",
						"precision": 5
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "SaleSmall"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_sales_parquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalakevshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "sale-small",
						"fileSystem": "wwi-02"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "TransactionId",
						"type": "UTF8"
					},
					{
						"name": "CustomerId",
						"type": "INT32"
					},
					{
						"name": "ProductId",
						"type": "INT_16"
					},
					{
						"name": "Quantity",
						"type": "INT_8"
					},
					{
						"name": "Price",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TotalAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TransactionDate",
						"type": "INT32"
					},
					{
						"name": "ProfitAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "Hour",
						"type": "INT_8"
					},
					{
						"name": "Minute",
						"type": "INT_8"
					},
					{
						"name": "StoreId",
						"type": "INT_16"
					},
					{
						"name": "Year",
						"type": "UTF8"
					},
					{
						"name": "Quarter",
						"type": "UTF8"
					},
					{
						"name": "Month",
						"type": "UTF8"
					},
					{
						"name": "Day",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalakevshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_wwi_salesmall_workload1_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01_workload01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionId",
						"type": "uniqueidentifier"
					},
					{
						"name": "CustomerId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductId",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "Quantity",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Price",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TotalAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TransactionDateId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProfitAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "Hour",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Minute",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "StoreId",
						"type": "smallint",
						"precision": 5
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "SaleSmall"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01_workload01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asamcw_wwi_salesmall_workload2_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01_workload02",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionId",
						"type": "uniqueidentifier"
					},
					{
						"name": "CustomerId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProductId",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "Quantity",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Price",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TotalAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "TransactionDateId",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ProfitAmount",
						"type": "decimal",
						"precision": 9,
						"scale": 2
					},
					{
						"name": "Hour",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "Minute",
						"type": "tinyint",
						"precision": 3
					},
					{
						"name": "StoreId",
						"type": "smallint",
						"precision": 5
					}
				],
				"typeProperties": {
					"schema": "wwi_mcw",
					"table": "SaleSmall"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01_workload02')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/citrixcustdelimparquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "cntnr-ms-csa"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/citrixcustomdelimiter')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "explrazstorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "SRDETA0_sample.dat",
						"fileSystem": "cntnr-ms-csa"
					},
					"columnDelimiter": "",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "f_instance_id",
						"type": "String"
					},
					{
						"name": "f_join_id",
						"type": "String"
					},
					{
						"name": "f_action_type",
						"type": "String"
					},
					{
						"name": "f_trigger_date",
						"type": "String"
					},
					{
						"name": "f_kb_solution_id",
						"type": "String"
					},
					{
						"name": "f_platform_id",
						"type": "String"
					},
					{
						"name": "f_project_number",
						"type": "String"
					},
					{
						"name": "f_last_update_date",
						"type": "String"
					},
					{
						"name": "f_creation_date",
						"type": "String"
					},
					{
						"name": "f_incident_number",
						"type": "String"
					},
					{
						"name": "f_problem_summary",
						"type": "String"
					},
					{
						"name": "f_resource_type_code",
						"type": "String"
					},
					{
						"name": "f_problem_code",
						"type": "String"
					},
					{
						"name": "f_expected_resolution_date",
						"type": "String"
					},
					{
						"name": "f_actual_resolution_date",
						"type": "String"
					},
					{
						"name": "f_incident_date",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_1",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_2",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_3",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_4",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_5",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_6",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_7",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_8",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_9",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_10",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_11",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_12",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_13",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_14",
						"type": "String"
					},
					{
						"name": "f_incident_attribute_15",
						"type": "String"
					},
					{
						"name": "f_incident_context",
						"type": "String"
					},
					{
						"name": "f_record_is_valid_flag",
						"type": "String"
					},
					{
						"name": "f_resolution_code",
						"type": "String"
					},
					{
						"name": "f_interfaced_to_depot_flag",
						"type": "String"
					},
					{
						"name": "f_incident_type",
						"type": "String"
					},
					{
						"name": "f_severity",
						"type": "String"
					},
					{
						"name": "f_status",
						"type": "String"
					},
					{
						"name": "f_urgency",
						"type": "String"
					},
					{
						"name": "f_closed_flag",
						"type": "String"
					},
					{
						"name": "f_filed_by_employee_flag",
						"type": "String"
					},
					{
						"name": "f_current_serial_number_nv",
						"type": "String"
					},
					{
						"name": "f_purchase_order_num",
						"type": "String"
					},
					{
						"name": "f_original_order_number",
						"type": "String"
					},
					{
						"name": "f_date_closed",
						"type": "String"
					},
					{
						"name": "f_publish_flag",
						"type": "String"
					},
					{
						"name": "f_customer_po_number",
						"type": "String"
					},
					{
						"name": "f_customer_ticket_number",
						"type": "String"
					},
					{
						"name": "f_obligation_date",
						"type": "String"
					},
					{
						"name": "f_sr_creation_channel_code",
						"type": "String"
					},
					{
						"name": "f_customer_type_code",
						"type": "String"
					},
					{
						"name": "f_inv_item_revision",
						"type": "String"
					},
					{
						"name": "f_inv_component_version",
						"type": "String"
					},
					{
						"name": "f_inv_subcomponent_version",
						"type": "String"
					},
					{
						"name": "f_time_difference",
						"type": "String"
					},
					{
						"name": "f_object_version_number",
						"type": "String"
					},
					{
						"name": "f_contact_type_code",
						"type": "String"
					},
					{
						"name": "f_color_severity",
						"type": "String"
					},
					{
						"name": "f_color_status",
						"type": "String"
					},
					{
						"name": "f_color_urgency",
						"type": "String"
					},
					{
						"name": "f_contract_number",
						"type": "String"
					},
					{
						"name": "f_platform_version",
						"type": "String"
					},
					{
						"name": "f_tier",
						"type": "String"
					},
					{
						"name": "f_tier_version",
						"type": "String"
					},
					{
						"name": "f_operating_system",
						"type": "String"
					},
					{
						"name": "f_operating_system_version",
						"type": "String"
					},
					{
						"name": "f_database",
						"type": "String"
					},
					{
						"name": "f_db_version",
						"type": "String"
					},
					{
						"name": "f_group_type_code",
						"type": "String"
					},
					{
						"name": "f_product_revision",
						"type": "String"
					},
					{
						"name": "f_component_version",
						"type": "String"
					},
					{
						"name": "f_subcomponent_version",
						"type": "String"
					},
					{
						"name": "f_comm_pref_code",
						"type": "String"
					},
					{
						"name": "f_last_update_channel_code",
						"type": "String"
					},
					{
						"name": "f_cust_pref_lang_code",
						"type": "String"
					},
					{
						"name": "f_error_code",
						"type": "String"
					},
					{
						"name": "f_external_reference",
						"type": "String"
					},
					{
						"name": "f_incident_occurred_date",
						"type": "String"
					},
					{
						"name": "f_incident_resolved_date",
						"type": "String"
					},
					{
						"name": "f_inc_responded_by_date",
						"type": "String"
					},
					{
						"name": "f_cert",
						"type": "String"
					},
					{
						"name": "f_resolution_summary",
						"type": "String"
					},
					{
						"name": "f_kit",
						"type": "String"
					},
					{
						"name": "f_incident_address",
						"type": "String"
					},
					{
						"name": "f_incident_city",
						"type": "String"
					},
					{
						"name": "f_incident_state",
						"type": "String"
					},
					{
						"name": "f_incident_country",
						"type": "String"
					},
					{
						"name": "f_incident_province",
						"type": "String"
					},
					{
						"name": "f_incident_postal_code",
						"type": "String"
					},
					{
						"name": "f_incident_county",
						"type": "String"
					},
					{
						"name": "f_external_attribute_1",
						"type": "String"
					},
					{
						"name": "f_external_attribute_2",
						"type": "String"
					},
					{
						"name": "f_external_attribute_3",
						"type": "String"
					},
					{
						"name": "f_external_attribute_4",
						"type": "String"
					},
					{
						"name": "f_external_attribute_5",
						"type": "String"
					},
					{
						"name": "f_external_attribute_6",
						"type": "String"
					},
					{
						"name": "f_external_attribute_7",
						"type": "String"
					},
					{
						"name": "f_external_attribute_8",
						"type": "String"
					},
					{
						"name": "f_external_attribute_9",
						"type": "String"
					},
					{
						"name": "f_external_attribute_10",
						"type": "String"
					},
					{
						"name": "f_external_attribute_11",
						"type": "String"
					},
					{
						"name": "f_external_attribute_12",
						"type": "String"
					},
					{
						"name": "f_external_attribute_13",
						"type": "String"
					},
					{
						"name": "f_external_attribute_14",
						"type": "String"
					},
					{
						"name": "f_external_attribute_15",
						"type": "String"
					},
					{
						"name": "f_external_context",
						"type": "String"
					},
					{
						"name": "f_coverage_type",
						"type": "String"
					},
					{
						"name": "f_incident_point_of_interest",
						"type": "String"
					},
					{
						"name": "f_incident_cross_street",
						"type": "String"
					},
					{
						"name": "f_incident_direction_qualifier",
						"type": "String"
					},
					{
						"name": "f_incident_distance_qualifier",
						"type": "String"
					},
					{
						"name": "f_incident_distance_qual_uom",
						"type": "String"
					},
					{
						"name": "f_incident_address2",
						"type": "String"
					},
					{
						"name": "f_incident_address3",
						"type": "String"
					},
					{
						"name": "f_incident_address4",
						"type": "String"
					},
					{
						"name": "f_incident_address_style",
						"type": "String"
					},
					{
						"name": "f_incident_addr_lines_phonetic",
						"type": "String"
					},
					{
						"name": "f_incident_po_box_number",
						"type": "String"
					},
					{
						"name": "f_incident_house_number",
						"type": "String"
					},
					{
						"name": "f_incident_street_suffix",
						"type": "String"
					},
					{
						"name": "f_incident_street",
						"type": "String"
					},
					{
						"name": "f_incident_street_number",
						"type": "String"
					},
					{
						"name": "f_incident_floor",
						"type": "String"
					},
					{
						"name": "f_incident_suite",
						"type": "String"
					},
					{
						"name": "f_incident_postal_plus4_code",
						"type": "String"
					},
					{
						"name": "f_incident_position",
						"type": "String"
					},
					{
						"name": "f_incident_location_directions",
						"type": "String"
					},
					{
						"name": "f_incident_location_desc",
						"type": "String"
					},
					{
						"name": "f_incident_location_type",
						"type": "String"
					},
					{
						"name": "f_item_serial_number",
						"type": "String"
					},
					{
						"name": "f_incident_type_maint_flag",
						"type": "String"
					},
					{
						"name": "f_cmro_flag",
						"type": "String"
					},
					{
						"name": "f_incident_last_modified_date",
						"type": "String"
					},
					{
						"name": "f_language_code",
						"type": "String"
					},
					{
						"name": "f_territory_name",
						"type": "String"
					},
					{
						"name": "f_contact_relationship_code",
						"type": "String"
					},
					{
						"name": "f_contact_relationship_meaning",
						"type": "String"
					},
					{
						"name": "f_owning_department_code",
						"type": "String"
					},
					{
						"name": "f_current_serial_number",
						"type": "String"
					},
					{
						"name": "f_erp_external_reference",
						"type": "String"
					},
					{
						"name": "f_customer_type_meaning",
						"type": "String"
					},
					{
						"name": "f_sr_creation_channel_meaning",
						"type": "String"
					},
					{
						"name": "f_problem_code_meaning",
						"type": "String"
					},
					{
						"name": "f_problem_code_description",
						"type": "String"
					},
					{
						"name": "f_resolution_code_meaning",
						"type": "String"
					},
					{
						"name": "f_resolution_code_description",
						"type": "String"
					},
					{
						"name": "f_billing_method",
						"type": "String"
					},
					{
						"name": "f_billing_details1",
						"type": "String"
					},
					{
						"name": "f_billing_details2",
						"type": "String"
					},
					{
						"name": "f_last_update_channel_meaning",
						"type": "String"
					},
					{
						"name": "f_service_tier",
						"type": "String"
					},
					{
						"name": "f_customer_email",
						"type": "String"
					},
					{
						"name": "f_contact_primary_flag",
						"type": "String"
					},
					{
						"name": "f_contact_email",
						"type": "String"
					},
					{
						"name": "f_contact_phone",
						"type": "String"
					},
					{
						"name": "f_contact_ext",
						"type": "String"
					},
					{
						"name": "f_contact_point_type_code",
						"type": "String"
					},
					{
						"name": "f_contact_point_type_meaning",
						"type": "String"
					},
					{
						"name": "f_contact_phone_type_code",
						"type": "String"
					},
					{
						"name": "f_contact_phone_type_meaning",
						"type": "String"
					},
					{
						"name": "f_customer_phone",
						"type": "String"
					},
					{
						"name": "f_customer_phone_type_code",
						"type": "String"
					},
					{
						"name": "f_customer_phone_type_meaning",
						"type": "String"
					},
					{
						"name": "f_ship_to_contact_number",
						"type": "String"
					},
					{
						"name": "f_ship_to_title",
						"type": "String"
					},
					{
						"name": "f_ship_to_first_name",
						"type": "String"
					},
					{
						"name": "f_ship_to_last_name",
						"type": "String"
					},
					{
						"name": "f_bill_to_contact_number",
						"type": "String"
					},
					{
						"name": "f_bill_to_title",
						"type": "String"
					},
					{
						"name": "f_bill_to_first_name",
						"type": "String"
					},
					{
						"name": "f_bill_to_last_name",
						"type": "String"
					},
					{
						"name": "f_contact_number",
						"type": "String"
					},
					{
						"name": "f_contact_title",
						"type": "String"
					},
					{
						"name": "f_contact_first_name",
						"type": "String"
					},
					{
						"name": "f_contact_last_name",
						"type": "String"
					},
					{
						"name": "f_contact_type_meaning",
						"type": "String"
					},
					{
						"name": "f_inv_component",
						"type": "String"
					},
					{
						"name": "f_inv_component_description",
						"type": "String"
					},
					{
						"name": "f_inv_subcomponent",
						"type": "String"
					},
					{
						"name": "f_inv_subcomponent_description",
						"type": "String"
					},
					{
						"name": "f_incident_owner_number",
						"type": "String"
					},
					{
						"name": "f_incident_owner_name",
						"type": "String"
					},
					{
						"name": "f_group_owner_number",
						"type": "String"
					},
					{
						"name": "f_group_owner_name",
						"type": "String"
					},
					{
						"name": "f_cust_pref_lang_description",
						"type": "String"
					},
					{
						"name": "f_instance_number",
						"type": "String"
					},
					{
						"name": "f_system_name",
						"type": "String"
					},
					{
						"name": "f_last_update_login_name",
						"type": "String"
					},
					{
						"name": "f_timezone_name",
						"type": "String"
					},
					{
						"name": "f_last_updated_by_name",
						"type": "String"
					},
					{
						"name": "f_created_by_name",
						"type": "String"
					},
					{
						"name": "f_sr_organization",
						"type": "String"
					},
					{
						"name": "f_cust_account_number",
						"type": "String"
					},
					{
						"name": "f_cust_account_name",
						"type": "String"
					},
					{
						"name": "f_bill_to_account_number",
						"type": "String"
					},
					{
						"name": "f_bill_to_account_name",
						"type": "String"
					},
					{
						"name": "f_ship_to_account_number",
						"type": "String"
					},
					{
						"name": "f_ship_to_account_name",
						"type": "String"
					},
					{
						"name": "f_party_number",
						"type": "String"
					},
					{
						"name": "f_customer_name",
						"type": "String"
					},
					{
						"name": "f_contact_address",
						"type": "String"
					},
					{
						"name": "f_contact_city",
						"type": "String"
					},
					{
						"name": "f_contact_state",
						"type": "String"
					},
					{
						"name": "f_contact_country",
						"type": "String"
					},
					{
						"name": "f_contact_postal_code",
						"type": "String"
					},
					{
						"name": "f_contact_province",
						"type": "String"
					},
					{
						"name": "f_bill_to_customer_number",
						"type": "String"
					},
					{
						"name": "f_bill_to_customer_name",
						"type": "String"
					},
					{
						"name": "f_ship_to_customer_number",
						"type": "String"
					},
					{
						"name": "f_ship_to_customer_name",
						"type": "String"
					},
					{
						"name": "f_support_site_number",
						"type": "String"
					},
					{
						"name": "f_support_site_name",
						"type": "String"
					},
					{
						"name": "f_ship_to_site_number",
						"type": "String"
					},
					{
						"name": "f_bill_to_site_number",
						"type": "String"
					},
					{
						"name": "f_install_site_number",
						"type": "String"
					},
					{
						"name": "f_resource_type_meaning",
						"type": "String"
					},
					{
						"name": "f_group_type_meaning",
						"type": "String"
					},
					{
						"name": "f_product_category",
						"type": "String"
					},
					{
						"name": "f_category_set_name",
						"type": "String"
					},
					{
						"name": "f_inventory_item_number",
						"type": "String"
					},
					{
						"name": "f_inventory_item_description",
						"type": "String"
					},
					{
						"name": "f_contract_number_modifier",
						"type": "String"
					},
					{
						"name": "f_contract_servline_number",
						"type": "String"
					},
					{
						"name": "f_contract_subline_number",
						"type": "String"
					},
					{
						"name": "f_inv_org_code",
						"type": "String"
					},
					{
						"name": "f_inv_platform_org_code",
						"type": "String"
					},
					{
						"name": "f_maint_org_code",
						"type": "String"
					},
					{
						"name": "f_employee_number",
						"type": "String"
					},
					{
						"name": "f_employee_name",
						"type": "String"
					},
					{
						"name": "f_qa_collection_name",
						"type": "String"
					},
					{
						"name": "f_owner_assigned_time",
						"type": "String"
					},
					{
						"name": "f_unassigned_indicator",
						"type": "String"
					},
					{
						"name": "f_group_territory_name",
						"type": "String"
					},
					{
						"name": "f_customer_site_number",
						"type": "String"
					},
					{
						"name": "f_eta_win_start",
						"type": "String"
					},
					{
						"name": "f_eta_win_end",
						"type": "String"
					},
					{
						"name": "f_batch_nbr",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/explrazstorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ctrx_orders')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ctrxdatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "orderline_all.parquet",
						"folderPath": "order",
						"container": "nextgen-c360"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/ctrxdatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ds_sod_telemetry')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LSAzureSqlOD",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "vin",
						"type": "varchar"
					},
					{
						"name": "speed",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "city",
						"type": "varchar"
					},
					{
						"name": "fuel",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "contosoauto_telemetry"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LSAzureSqlOD')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sfdc_account')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sfdc_vrlshah",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SalesforceObject",
				"schema": [],
				"typeProperties": {
					"objectApiName": "Account"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sfdc_vrlshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ADBDeltaLake')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "https://adb-1034356426411799.19.azuredatabricks.net\ndapi102cc27955abe1b7c381d4ba09504c97",
				"annotations": [],
				"type": "AzureDatabricksDeltaLake",
				"typeProperties": {
					"domain": "https://adb-1034356426411799.19.azuredatabricks.net",
					"clusterId": "0107-165008-swing718",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('ADBDeltaLake_accessToken')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ATL_DAI_CSAs')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "9c44d704-6ad4-4d51-a5e8-0a740c2e0db2",
					"tenantID": "72f988bf-86f1-41af-91ab-2d7cd011db47"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureMLService1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureMLService",
				"typeProperties": {
					"subscriptionId": "[parameters('AzureMLService1_properties_typeProperties_subscriptionId')]",
					"resourceGroupName": "[parameters('AzureMLService1_properties_typeProperties_resourceGroupName')]",
					"mlWorkspaceName": "amlworkspacevshah",
					"servicePrincipalId": "[parameters('AzureMLService1_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalKey": {
						"type": "SecureString",
						"value": "[parameters('AzureMLService1_servicePrincipalKey')]"
					},
					"tenant": "[parameters('AzureMLService1_properties_typeProperties_tenant')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDb1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDb1_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LSAzureSqlOD')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LSAzureSqlOD_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AzureIntegrationRuntime01",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AzureIntegrationRuntime01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asadatalakevshah')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('asadatalakevshah_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('asadatalakevshah_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AzureIntegrationRuntime01",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AzureIntegrationRuntime01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asakeyvaultvshah')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('asakeyvaultvshah_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asastorevshah')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('asastorevshah_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asaworkspacevshah-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('asaworkspacevshah-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asaworkspacevshah-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('asaworkspacevshah-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ctrxdatalake01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('ctrxdatalake01_sasUri')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dwYelp')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('dwYelp_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "asakeyvaultvshah",
							"type": "LinkedServiceReference"
						},
						"secretName": "SQL-USER-ASA"
					}
				},
				"connectVia": {
					"referenceName": "AzureIntegrationRuntime01",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AzureIntegrationRuntime01')]",
				"[concat(variables('workspaceId'), '/linkedServices/asakeyvaultvshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dwyelp2')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('dwyelp2_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "asakeyvaultvshah",
							"type": "LinkedServiceReference"
						},
						"secretName": "SQL-USER-ASA"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/linkedServices/asakeyvaultvshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/explrazstorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('explrazstorage_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('explrazstorage_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sfdc_vrlshah')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "Salesforce",
				"typeProperties": {
					"environmentUrl": "[parameters('sfdc_vrlshah_properties_typeProperties_environmentUrl')]",
					"username": "[parameters('sfdc_vrlshah_properties_typeProperties_username')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('sfdc_vrlshah_password')]"
					},
					"securityToken": {
						"type": "SecureString",
						"value": "[parameters('sfdc_vrlshah_securityToken')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sqlpool01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('sqlpool01_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "asakeyvaultvshah",
							"type": "LinkedServiceReference"
						},
						"secretName": "SQL-USER-ASA"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asakeyvaultvshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sqlpool01_workload01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('sqlpool01_workload01_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "asakeyvaultvshah",
							"type": "LinkedServiceReference"
						},
						"secretName": "SQL-USER-ASA"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asakeyvaultvshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sqlpool01_workload02')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('sqlpool01_workload02_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "asakeyvaultvshah",
							"type": "LinkedServiceReference"
						},
						"secretName": "SQL-USER-ASA"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asakeyvaultvshah')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureIntegrationRuntime01')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "MemoryOptimized",
							"coreCount": 16,
							"timeToLive": 60
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW_Exercise_2_2018_and_2019_Sales')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "asamcw_sales_parquet",
								"type": "DatasetReference"
							},
							"name": "salesdata"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "asamcw_sale_asa",
								"type": "DatasetReference"
							},
							"name": "sale"
						}
					],
					"transformations": [],
					"script": "source(output(\n\t\tTransactionId as string,\n\t\tCustomerId as integer,\n\t\tProductId as short,\n\t\tQuantity as byte,\n\t\tPrice as decimal(38,18),\n\t\tTotalAmount as decimal(38,18),\n\t\tTransactionDate as integer,\n\t\tProfitAmount as decimal(38,18),\n\t\tHour as byte,\n\t\tMinute as byte,\n\t\tStoreId as short,\n\t\tYear as string,\n\t\tQuarter as string,\n\t\tMonth as string,\n\t\tDay as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['sale-small/Year=2018/*/*/*/*','sale-small/Year=2019/*/*/*/*']) ~> salesdata\nsalesdata sink(input(\n\t\tTransactionId as string,\n\t\tCustomerId as integer,\n\t\tProductId as integer,\n\t\tQuantity as integer,\n\t\tPrice as decimal(9,2),\n\t\tTotalAmount as decimal(9,2),\n\t\tTransactionDateId as integer,\n\t\tProfitAmount as decimal(9,2),\n\t\tHour as integer,\n\t\tMinute as integer,\n\t\tStoreId as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tmapColumn(\n\t\tTransactionId,\n\t\tCustomerId,\n\t\tProductId,\n\t\tQuantity,\n\t\tPrice,\n\t\tTotalAmount,\n\t\tTransactionDateId = TransactionDate,\n\t\tProfitAmount,\n\t\tHour,\n\t\tMinute,\n\t\tStoreId\n\t)) ~> sale"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_sales_parquet')]",
				"[concat(variables('workspaceId'), '/datasets/asamcw_sale_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ASAMCW_Exercise_2_Campaign_Analytics_Data')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "asamcw_campaignanalytics_csv",
								"type": "DatasetReference"
							},
							"name": "campaignanalyticscsv"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "asamcw_campaignanalytics_asa",
								"type": "DatasetReference"
							},
							"name": "campaignanlyticsasa"
						}
					],
					"transformations": [
						{
							"name": "mapcampaignanalytics"
						},
						{
							"name": "convertandaddcolums"
						},
						{
							"name": "selectcampaignanalyticscolumns"
						}
					],
					"script": "source(output(\n\t\t{_col0_} as string,\n\t\t{_col1_} as string,\n\t\t{_col2_} as string,\n\t\t{_col3_} as string,\n\t\t{_col4_} as string,\n\t\t{_col5_} as double,\n\t\t{_col6_} as string,\n\t\t{_col7_} as double,\n\t\t{_col8_} as string,\n\t\t{_col9_} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tskipLines: 1) ~> campaignanalyticscsv\ncampaignanalyticscsv select(mapColumn(\n\t\tRegion = {_col0_},\n\t\tCountry = {_col1_},\n\t\tProductCategory = {_col2_},\n\t\tCampaignName = {_col3_},\n\t\tRevenuePart1 = {_col4_},\n\t\tRevenue = {_col5_},\n\t\tRevenueTargetPart1 = {_col6_},\n\t\tRevenueTarget = {_col7_},\n\t\tCity = {_col8_},\n\t\tState = {_col9_}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> mapcampaignanalytics\nmapcampaignanalytics derive(Revenue = toDecimal(replace(concat(toString(RevenuePart1), toString(Revenue)), '\\\\', ''), 10, 2, '$###,###.##'),\n\t\tRevenueTarget = toDecimal(replace(concat(toString(RevenueTargetPart1), toString(RevenueTarget)), '\\\\', ''), 10, 2, '$###,###.##'),\n\t\tAnalyst = iif(isNull(City), '', replace('DataAnalyst'+ City,' ',''))) ~> convertandaddcolums\nconvertandaddcolums select(mapColumn(\n\t\tRegion,\n\t\tCountry,\n\t\tProductCategory,\n\t\tCampaignName,\n\t\tRevenue,\n\t\tRevenueTarget,\n\t\tCity,\n\t\tState,\n\t\tAnalyst\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> selectcampaignanalyticscolumns\nselectcampaignanalyticscolumns sink(input(\n\t\tRegion as string,\n\t\tCountry as string,\n\t\tProductCategory as string,\n\t\tCampaignName as string,\n\t\tAnalyst as string,\n\t\tRevenue as decimal(10,2),\n\t\tRevenueTarget as decimal(10,2),\n\t\tCity as string,\n\t\tState as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tstaged: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> campaignanlyticsasa"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/asamcw_campaignanalytics_csv')]",
				"[concat(variables('workspaceId'), '/datasets/asamcw_campaignanalytics_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AvgSpeedByCityJSON')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ds_sod_telemetry",
								"type": "DatasetReference"
							},
							"name": "SODtelemetry"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AvgCitySpeed",
								"type": "DatasetReference"
							},
							"name": "AvgSpeedByCity"
						}
					],
					"transformations": [
						{
							"name": "AggSpeed"
						}
					],
					"script": "source(output(\n\t\tvin as string,\n\t\tspeed as long,\n\t\tcity as string,\n\t\tfuel as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> SODtelemetry\nSODtelemetry aggregate(groupBy(city),\n\tspeed = avg(speed)) ~> AggSpeed\nAggSpeed sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['AvgSpeedByCity.json'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AvgSpeedByCity"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/ds_sod_telemetry')]",
				"[concat(variables('workspaceId'), '/datasets/AvgCitySpeed')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataflow_YelpBusiness')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "YelpBusiness",
								"type": "DatasetReference"
							},
							"name": "jsonYelpBusiness"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "YelpBusiness_asa",
								"type": "DatasetReference"
							},
							"name": "asaYelpBusiness"
						}
					],
					"transformations": [],
					"script": "source(output(\n\t\tbusiness_id as string,\n\t\tname as string,\n\t\taddress as string,\n\t\tcity as string,\n\t\tstate as string,\n\t\tpostal_code as string,\n\t\tlatitude as double,\n\t\tlongitude as double,\n\t\tstars as double,\n\t\treview_count as string,\n\t\tis_open as string,\n\t\tattributes as (GoodForKids as string, RestaurantsReservations as string, GoodForMeal as string, BusinessParking as string, Caters as string, NoiseLevel as string, RestaurantsTableService as string, RestaurantsTakeOut as string, RestaurantsPriceRange2 as string, OutdoorSeating as string, BikeParking as string, Ambience as string, HasTV as string, WiFi as string, Alcohol as string, RestaurantsAttire as string, RestaurantsGoodForGroups as string, RestaurantsDelivery as string, BusinessAcceptsCreditCards as string, BusinessAcceptsBitcoin as string, ByAppointmentOnly as string, AcceptsInsurance as string),\n\t\tcategories as string,\n\t\thours as (Monday as string, Tuesday as string, Wednesday as string, Thursday as string, Friday as string, Saturday as string, Sunday as string)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'documentPerLine') ~> jsonYelpBusiness\njsonYelpBusiness sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tmapColumn(\n\t\tbusiness_id,\n\t\tname,\n\t\taddress,\n\t\tcity,\n\t\tstate,\n\t\tpostal_code,\n\t\tlatitude,\n\t\tlongitude,\n\t\tstars,\n\t\treview_count,\n\t\tis_open,\n\t\tcategories\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> asaYelpBusiness"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/YelpBusiness')]",
				"[concat(variables('workspaceId'), '/datasets/YelpBusiness_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataflow_YelpCheckin')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "YelpCheckin",
								"type": "DatasetReference"
							},
							"name": "jsonYelpCheckin"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "YelpCheckin_asa",
								"type": "DatasetReference"
							},
							"name": "asaYelpCheckin"
						}
					],
					"transformations": [],
					"script": "source(output(\n\t\tbusiness_id as string,\n\t\tdate as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'documentPerLine') ~> jsonYelpCheckin\njsonYelpCheckin sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tmapColumn(\n\t\tbusiness_id,\n\t\tdate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> asaYelpCheckin"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/YelpCheckin')]",
				"[concat(variables('workspaceId'), '/datasets/YelpCheckin_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dfcitrixcustdelimload')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "citrixcustomdelimiter",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "citrixcustdelimparquet",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [],
					"script": "source(output(\n\t\tf_instance_id as string,\n\t\tf_join_id as string,\n\t\tf_action_type as string,\n\t\tf_trigger_date as string,\n\t\tf_kb_solution_id as string,\n\t\tf_platform_id as string,\n\t\tf_project_number as string,\n\t\tf_last_update_date as string,\n\t\tf_creation_date as string,\n\t\tf_incident_number as string,\n\t\tf_problem_summary as string,\n\t\tf_resource_type_code as string,\n\t\tf_problem_code as string,\n\t\tf_expected_resolution_date as string,\n\t\tf_actual_resolution_date as string,\n\t\tf_incident_date as string,\n\t\tf_incident_attribute_1 as string,\n\t\tf_incident_attribute_2 as string,\n\t\tf_incident_attribute_3 as string,\n\t\tf_incident_attribute_4 as string,\n\t\tf_incident_attribute_5 as string,\n\t\tf_incident_attribute_6 as string,\n\t\tf_incident_attribute_7 as string,\n\t\tf_incident_attribute_8 as string,\n\t\tf_incident_attribute_9 as string,\n\t\tf_incident_attribute_10 as string,\n\t\tf_incident_attribute_11 as string,\n\t\tf_incident_attribute_12 as string,\n\t\tf_incident_attribute_13 as string,\n\t\tf_incident_attribute_14 as string,\n\t\tf_incident_attribute_15 as string,\n\t\tf_incident_context as string,\n\t\tf_record_is_valid_flag as string,\n\t\tf_resolution_code as string,\n\t\tf_interfaced_to_depot_flag as string,\n\t\tf_incident_type as string,\n\t\tf_severity as string,\n\t\tf_status as string,\n\t\tf_urgency as string,\n\t\tf_closed_flag as string,\n\t\tf_filed_by_employee_flag as string,\n\t\tf_current_serial_number_nv as string,\n\t\tf_purchase_order_num as string,\n\t\tf_original_order_number as string,\n\t\tf_date_closed as string,\n\t\tf_publish_flag as string,\n\t\tf_customer_po_number as string,\n\t\tf_customer_ticket_number as string,\n\t\tf_obligation_date as string,\n\t\tf_sr_creation_channel_code as string,\n\t\tf_customer_type_code as string,\n\t\tf_inv_item_revision as string,\n\t\tf_inv_component_version as string,\n\t\tf_inv_subcomponent_version as string,\n\t\tf_time_difference as string,\n\t\tf_object_version_number as string,\n\t\tf_contact_type_code as string,\n\t\tf_color_severity as string,\n\t\tf_color_status as string,\n\t\tf_color_urgency as string,\n\t\tf_contract_number as string,\n\t\tf_platform_version as string,\n\t\tf_tier as string,\n\t\tf_tier_version as string,\n\t\tf_operating_system as string,\n\t\tf_operating_system_version as string,\n\t\tf_database as string,\n\t\tf_db_version as string,\n\t\tf_group_type_code as string,\n\t\tf_product_revision as string,\n\t\tf_component_version as string,\n\t\tf_subcomponent_version as string,\n\t\tf_comm_pref_code as string,\n\t\tf_last_update_channel_code as string,\n\t\tf_cust_pref_lang_code as string,\n\t\tf_error_code as string,\n\t\tf_external_reference as string,\n\t\tf_incident_occurred_date as string,\n\t\tf_incident_resolved_date as string,\n\t\tf_inc_responded_by_date as string,\n\t\tf_cert as string,\n\t\tf_resolution_summary as string,\n\t\tf_kit as string,\n\t\tf_incident_address as string,\n\t\tf_incident_city as string,\n\t\tf_incident_state as string,\n\t\tf_incident_country as string,\n\t\tf_incident_province as string,\n\t\tf_incident_postal_code as string,\n\t\tf_incident_county as string,\n\t\tf_external_attribute_1 as string,\n\t\tf_external_attribute_2 as string,\n\t\tf_external_attribute_3 as string,\n\t\tf_external_attribute_4 as string,\n\t\tf_external_attribute_5 as string,\n\t\tf_external_attribute_6 as string,\n\t\tf_external_attribute_7 as string,\n\t\tf_external_attribute_8 as string,\n\t\tf_external_attribute_9 as string,\n\t\tf_external_attribute_10 as string,\n\t\tf_external_attribute_11 as string,\n\t\tf_external_attribute_12 as string,\n\t\tf_external_attribute_13 as string,\n\t\tf_external_attribute_14 as string,\n\t\tf_external_attribute_15 as string,\n\t\tf_external_context as string,\n\t\tf_coverage_type as string,\n\t\tf_incident_point_of_interest as string,\n\t\tf_incident_cross_street as string,\n\t\tf_incident_direction_qualifier as string,\n\t\tf_incident_distance_qualifier as string,\n\t\tf_incident_distance_qual_uom as string,\n\t\tf_incident_address2 as string,\n\t\tf_incident_address3 as string,\n\t\tf_incident_address4 as string,\n\t\tf_incident_address_style as string,\n\t\tf_incident_addr_lines_phonetic as string,\n\t\tf_incident_po_box_number as string,\n\t\tf_incident_house_number as string,\n\t\tf_incident_street_suffix as string,\n\t\tf_incident_street as string,\n\t\tf_incident_street_number as string,\n\t\tf_incident_floor as string,\n\t\tf_incident_suite as string,\n\t\tf_incident_postal_plus4_code as string,\n\t\tf_incident_position as string,\n\t\tf_incident_location_directions as string,\n\t\tf_incident_location_desc as string,\n\t\tf_incident_location_type as string,\n\t\tf_item_serial_number as string,\n\t\tf_incident_type_maint_flag as string,\n\t\tf_cmro_flag as string,\n\t\tf_incident_last_modified_date as string,\n\t\tf_language_code as string,\n\t\tf_territory_name as string,\n\t\tf_contact_relationship_code as string,\n\t\tf_contact_relationship_meaning as string,\n\t\tf_owning_department_code as string,\n\t\tf_current_serial_number as string,\n\t\tf_erp_external_reference as string,\n\t\tf_customer_type_meaning as string,\n\t\tf_sr_creation_channel_meaning as string,\n\t\tf_problem_code_meaning as string,\n\t\tf_problem_code_description as string,\n\t\tf_resolution_code_meaning as string,\n\t\tf_resolution_code_description as string,\n\t\tf_billing_method as string,\n\t\tf_billing_details1 as string,\n\t\tf_billing_details2 as string,\n\t\tf_last_update_channel_meaning as string,\n\t\tf_service_tier as string,\n\t\tf_customer_email as string,\n\t\tf_contact_primary_flag as string,\n\t\tf_contact_email as string,\n\t\tf_contact_phone as string,\n\t\tf_contact_ext as string,\n\t\tf_contact_point_type_code as string,\n\t\tf_contact_point_type_meaning as string,\n\t\tf_contact_phone_type_code as string,\n\t\tf_contact_phone_type_meaning as string,\n\t\tf_customer_phone as string,\n\t\tf_customer_phone_type_code as string,\n\t\tf_customer_phone_type_meaning as string,\n\t\tf_ship_to_contact_number as string,\n\t\tf_ship_to_title as string,\n\t\tf_ship_to_first_name as string,\n\t\tf_ship_to_last_name as string,\n\t\tf_bill_to_contact_number as string,\n\t\tf_bill_to_title as string,\n\t\tf_bill_to_first_name as string,\n\t\tf_bill_to_last_name as string,\n\t\tf_contact_number as string,\n\t\tf_contact_title as string,\n\t\tf_contact_first_name as string,\n\t\tf_contact_last_name as string,\n\t\tf_contact_type_meaning as string,\n\t\tf_inv_component as string,\n\t\tf_inv_component_description as string,\n\t\tf_inv_subcomponent as string,\n\t\tf_inv_subcomponent_description as string,\n\t\tf_incident_owner_number as string,\n\t\tf_incident_owner_name as string,\n\t\tf_group_owner_number as string,\n\t\tf_group_owner_name as string,\n\t\tf_cust_pref_lang_description as string,\n\t\tf_instance_number as string,\n\t\tf_system_name as string,\n\t\tf_last_update_login_name as string,\n\t\tf_timezone_name as string,\n\t\tf_last_updated_by_name as string,\n\t\tf_created_by_name as string,\n\t\tf_sr_organization as string,\n\t\tf_cust_account_number as string,\n\t\tf_cust_account_name as string,\n\t\tf_bill_to_account_number as string,\n\t\tf_bill_to_account_name as string,\n\t\tf_ship_to_account_number as string,\n\t\tf_ship_to_account_name as string,\n\t\tf_party_number as string,\n\t\tf_customer_name as string,\n\t\tf_contact_address as string,\n\t\tf_contact_city as string,\n\t\tf_contact_state as string,\n\t\tf_contact_country as string,\n\t\tf_contact_postal_code as string,\n\t\tf_contact_province as string,\n\t\tf_bill_to_customer_number as string,\n\t\tf_bill_to_customer_name as string,\n\t\tf_ship_to_customer_number as string,\n\t\tf_ship_to_customer_name as string,\n\t\tf_support_site_number as string,\n\t\tf_support_site_name as string,\n\t\tf_ship_to_site_number as string,\n\t\tf_bill_to_site_number as string,\n\t\tf_install_site_number as string,\n\t\tf_resource_type_meaning as string,\n\t\tf_group_type_meaning as string,\n\t\tf_product_category as string,\n\t\tf_category_set_name as string,\n\t\tf_inventory_item_number as string,\n\t\tf_inventory_item_description as string,\n\t\tf_contract_number_modifier as string,\n\t\tf_contract_servline_number as string,\n\t\tf_contract_subline_number as string,\n\t\tf_inv_org_code as string,\n\t\tf_inv_platform_org_code as string,\n\t\tf_maint_org_code as string,\n\t\tf_employee_number as string,\n\t\tf_employee_name as string,\n\t\tf_qa_collection_name as string,\n\t\tf_owner_assigned_time as string,\n\t\tf_unassigned_indicator as string,\n\t\tf_group_territory_name as string,\n\t\tf_customer_site_number as string,\n\t\tf_eta_win_start as string,\n\t\tf_eta_win_end as string,\n\t\tf_batch_nbr as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/citrixcustomdelimiter')]",
				"[concat(variables('workspaceId'), '/datasets/citrixcustdelimparquet')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AlterTransId')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "ALTER TABLE [wwi_mcw].[SaleSmall] ALTER COLUMN TransactionId NVARCHAR(50) NOT NULL;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/BringYourData')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/*This sample uses COPY command to load data. You can either modify parameters or use BulkCopy utility by right clicking data from storage account to generate this script for loading your own data */\n \n    IF NOT EXISTS (SELECT * FROM information_schema.tables WHERE table_name = 'Weather')\n        CREATE TABLE [dbo].[Weather](\n            [usaf] [nvarchar](200) NULL,\n            [wban] [nvarchar](200) NULL,\n            [datetime] [datetime] NULL,\n            [latitude] [float] NULL,\n            [longitude] [float] NULL,\n            [elevation] [float] NULL,\n            [windAngle] [int] NULL,\n            [windSpeed] [float] NULL,\n            [temperature] [float] NULL,\n            [seaLvlPressure] [float] NULL,\n            [cloudCoverage] [nvarchar](200) NULL,\n            [presentWeatherIndicator] [int] NULL,\n            [pastWeatherIndicator] [int] NULL,\n            [precipTime] [float] NULL,\n            [precipDepth] [float] NULL,\n            [snowDepth] [float] NULL,\n            [stationName] [nvarchar](200) NULL,\n            [countryOrRegion] [nvarchar](200) NULL,\n            [p_k] [nvarchar](200) NULL,\n            [year] [int] NULL,\n            [day] [int] NULL,\n            [version] [float] NULL,\n            [month] [int] NULL\n        )\n        WITH\n        (\n            DISTRIBUTION = ROUND_ROBIN,\n            CLUSTERED COLUMNSTORE INDEX\n        )\n        GO\n    \n    COPY INTO Weather FROM 'https://azureopendatastorage.blob.core.windows.net/isdweatherdatacontainer/ISDWeather/year=2018/month=2/'\n    WITH (\n       FILE_TYPE = 'PARQUET',\n       CREDENTIAL=(IDENTITY= 'Shared Access Signature', SECRET='\"\"')\n    ) OPTION (LABEL = 'COPY: Getting started');",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDBLinkSOD')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--Createdatabase\n--CreatedatabaseRetailCosmosDB\n\ndrop view contosoauto_telemetry\n--CREATE VIEW contosoauto_telemetry AS\nGO\n\nDECLARE @cosmosdb varchar(30);\nDECLARE @cosmosdbAcct varchar(30);\nDECLARE @cosmosdbRegion varchar(500);\nDECLARE @cosmosdbKey varchar(500);\nDECLARE @conn varchar(1000);\nDECLARE @qry_avg_speed varchar(1000);\nSET @cosmosdbAcct = 'cst-vshah';\nSET @cosmosdb = 'ContosoAuto';\nSET @cosmosdbRegion = 'westus';\nSET @cosmosdbKey = 'PlaceholderPassword'\n--'sJ9IcyCO480PycdZhA7pyamN6eSFpksZ156e0DtxUy3IcMOg0Atz5qyyB3O3XvqvYDla6meYYDcryohg1P3Pbw==';\n\nSET @conn='CREATE VIEW contosoauto_telemetry AS SELECT *\nFROM OPENROWSET( \n       ''CosmosDB''\n        , ''account=' + @cosmosdbAcct + ';database=' + @cosmosdb + ';region=' + @cosmosdbRegion + ';key=' + @cosmosdbKey + ''',\n       telemetry) with ( vin varchar(100), speed bigint, city varchar(100), fuel varchar(100) ) as rows'\n--select @conn\n\nexec(@conn)\n\n/*\nCREATE VIEW contosoauto_telemetry AS \nSELECT city, avg(speed) as avg_speed\nFROM OPENROWSET( \n       'CosmosDB',\n      'account=cst-vshah;database=ContosoAuto;region=westus;key=sJ9IcyCO480PycdZhA7pyamN6eSFpksZ156e0DtxUy3IcMOg0Atz5qyyB3O3XvqvYDla6meYYDcryohg1P3Pbw==',\n      telemetry) with ( vin varchar(100), speed bigint, city varchar(100), fuel varchar(100) ) as rows\ngroup by city\n*/\n\n--Analytical Store query NOT using any RUs\nSET @qry_avg_speed='SELECT city, avg(speed) as avg_speed\nFROM OPENROWSET( \n       ''CosmosDB''\n        , ''account=' + @cosmosdbAcct + ';database=' + @cosmosdb + ';region=' + @cosmosdbRegion + ';key=' + @cosmosdbKey + ''',\n       telemetry) with ( vin varchar(100), speed bigint, city varchar(100), fuel varchar(100) ) as rows group by city'\nselect @qry_avg_speed\nexec(@qry_avg_speed)\nGO\n\nselect count(*) from dbo.contosoauto_telemetry\n\nselect city, avg(speed) as avg_speed from dbo.contosoauto_telemetry\ngroup by city",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "RetailCosmosDB"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CreateAADLogin')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- Create login,\n\nCREATE USER [jepeach@microsoft.com] FROM EXTERNAL PROVIDER;\n\n  -- Create user in master database (so the user can connect using ssms or ADS)\nCREATE USER [jepeach@microsoft.com]\nFOR LOGIN [jepeach@microsoft.com]\nWITH DEFAULT_SCHEMA = dbo\nGO\n\nEXEC sp_addrolemember 'db_owner', 'jepeach@microsoft.com'  \n\nuser sqlpool01;\n--ALTER ROLE db_owner ADD MEMBER jepeach@microsoft.com",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex7-DynamicMgmtViews')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT *\nFROM sys.dm_pdw_exec_requests\nWHERE status not in ('Completed','Failed','Cancelled')\n  AND session_id <> session_id()\nORDER BY submit_time DESC;\n\nSELECT TOP 10 *\nFROM sys.dm_pdw_exec_requests\nORDER BY total_elapsed_time DESC;\n\nSELECT *\nFROM sys.tables\nOPTION (LABEL = 'My Query');\n\nSELECT  *\nFROM sys.dm_pdw_exec_requests\nWHERE [label] = 'My Query';\n\nSELECT * FROM sys.dm_pdw_request_steps\nWHERE request_id = 'QID4127'\nORDER BY step_index;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex7-workloadisolation')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "IF NOT EXISTS (SELECT * FROM sys.workload_management_workload_groups where name = 'CEODemo')\nBEGIN\n    Create WORKLOAD GROUP CEODemo WITH  \n    ( MIN_PERCENTAGE_RESOURCE = 50        -- integer value\n    ,REQUEST_MIN_RESOURCE_GRANT_PERCENT = 25 --  \n    ,CAP_PERCENTAGE_RESOURCE = 100\n    )\nEND\n\nIF NOT EXISTS (SELECT * FROM sys.workload_management_workload_classifiers where  name = 'CEODreamDemo')\nBEGIN\n    Create Workload Classifier CEODreamDemo with\n    ( Workload_Group ='CEODemo',MemberName='asa.sql.workload02',IMPORTANCE = BELOW_NORMAL);\nEND\n\nIF  EXISTS (SELECT * FROM sys.workload_management_workload_classifiers where group_name = 'CEODemo')\nBEGIN\n    Drop Workload Classifier CEODreamDemo\n    DROP WORKLOAD GROUP CEODemo\n    --- Creates a workload group 'CEODemo'.\n        Create  WORKLOAD GROUP CEODemo WITH  \n    (MIN_PERCENTAGE_RESOURCE = 26 -- integer value\n        ,REQUEST_MIN_RESOURCE_GRANT_PERCENT = 3.25 -- factor of 26 (guaranteed more than 4 concurrencies)\n    ,CAP_PERCENTAGE_RESOURCE = 100\n    )\n    --- Creates a workload Classifier 'CEODreamDemo'.\n    Create Workload Classifier CEODreamDemo with\n    (Workload_Group ='CEODemo',MemberName='asa.sql.workload02',IMPORTANCE = BELOW_NORMAL);\nEND",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex7-workloadmgmt')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--First, let's confirm that there are no queries currently being run by users logged in as CEONYC or AnalystNYC.\n\nSELECT s.login_name, r.[Status], r.Importance, submit_time,\nstart_time ,s.session_id FROM sys.dm_pdw_exec_sessions s\nJOIN sys.dm_pdw_exec_requests r ON s.session_id = r.session_id\nWHERE s.login_name IN ('asa.sql.workload01','asa.sql.workload02') and Importance\nis not NULL AND r.[status] in ('Running','Suspended')\n--and submit_time>dateadd(minute,-2,getdate())\nORDER BY submit_time ,s.login_name;\n\nSELECT s.login_name, r.[Status], r.Importance, submit_time, start_time ,s.session_id FROM sys.dm_pdw_exec_sessions s\nJOIN sys.dm_pdw_exec_requests r ON s.session_id = r.session_id\nWHERE s.login_name IN ('asa.sql.workload01','asa.sql.workload02') and Importance\nis not NULL AND r.[status] in ('Running','Suspended') and submit_time>dateadd(minute,-4,getdate())\nORDER BY submit_time ,status;\n\nIF EXISTS (SELECT * FROM sys.workload_management_workload_classifiers WHERE name = 'CEO')\nBEGIN\n    DROP WORKLOAD CLASSIFIER CEO;\nEND\nCREATE WORKLOAD CLASSIFIER CEO\n  WITH (WORKLOAD_GROUP = 'largerc'\n  ,MEMBERNAME = 'asa.sql.workload01',IMPORTANCE = High);",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/NYTaxiHolidaysJoin')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "WITH taxi_rides AS\n(\n    SELECT\n        CAST([tpepPickupDateTime] AS DATE) AS [current_day],\n        COUNT(*) as rides_per_day\n    FROM  \n        OPENROWSET(\n            BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n            FORMAT='PARQUET'\n        ) AS [nyc]\n    WHERE nyc.filepath(1) = '2016'\n    GROUP BY CAST([tpepPickupDateTime] AS DATE)\n),\npublic_holidays AS\n(\n    SELECT\n        holidayname as holiday,\n        date\n    FROM\n        OPENROWSET(\n            BULK 'https://azureopendatastorage.blob.core.windows.net/holidaydatacontainer/Processed/*.parquet',\n            FORMAT='PARQUET'\n        ) AS [holidays]\n    WHERE countryorregion = 'United States' AND YEAR(date) = 2016\n)\nSELECT\n*\nFROM taxi_rides t\nLEFT OUTER JOIN public_holidays p on t.current_day = p.date\nORDER BY current_day ASC",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/NYTaxiRidesPerYr')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n    YEAR(tpepPickupDateTime) AS current_year,\n    COUNT(*) AS rides_per_year\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc]\nWHERE nyc.filepath(1) >= '2009' AND nyc.filepath(1) <= '2019'\nGROUP BY YEAR(tpepPickupDateTime)\nORDER BY 1 ASC\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PDW_SHOWSPACEUSED')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "DBCC PDW_SHOWSPACEUSED (<table name>)",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PUPYmodelTest')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT Customer,Product_Group,Product_Family,AAG_Category,\nProbability,Forecast_Category,Sector,Promo,Total_Price,Quantity,COGS_Total,\nFinal_PSRP,Program_Discount,Channel_Discount,Price_USD_ACV,PUPY,License_count,license_bucket,\nEdition,Model,Revenue_Type,Geo,Stage,Close_Date,offering_category \nFROM [default].[dbo].[vw_pupy_prediction_oppty]\n where Product_Family in ('Citrix Workspace')\n order by PUPY desc",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "default",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Query nested types in Parquet and JSON files')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/* The example extracts scalar and objects values from COVID-19 Open Research Dataset JSON file with nested objects is shown below.*/\nSELECT\n    title = JSON_VALUE(doc, '$.metadata.title'),\n    first_author = JSON_QUERY(doc, '$.metadata.authors[0]'),\n    first_author_name = JSON_VALUE(doc, '$.metadata.authors[0].first'),\n    complex_object = doc\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/covid19temp/comm_use_subset/pdf_json/000b7d1517ceebb34e1e3e817695b6de03e2fa78.json',\n        FORMAT='CSV', FIELDTERMINATOR ='0x0b', FIELDQUOTE = '0x0b', ROWTERMINATOR = '0x0b'\n    )\n    WITH ( doc varchar(MAX) ) AS docs;\n\n\n/* Project nested or repeated data */\nSELECT\n    DateStruct, TimeStruct, TimestampStruct, DecimalStruct, FloatStruct\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/structExample.parquet',\n        FORMAT='PARQUET'\n    )\n    WITH (\n        DateStruct VARCHAR(8000),\n        TimeStruct VARCHAR(8000),\n        TimestampStruct VARCHAR(8000),\n        DecimalStruct VARCHAR(8000),\n        FloatStruct VARCHAR(8000)\n    ) AS [r];\n\n/* The following query reads the justSimpleArray.parquet file. */\nSELECT\n    SimpleArray\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/justSimpleArray.parquet',\n        FORMAT='PARQUET'\n    ) AS [r];\n\n\n/* Read properties from nested object columns */\nSELECT\n    title = JSON_VALUE(complex_column, '$.metadata.title'),\n    first_author_name = JSON_VALUE(complex_column, '$.metadata.authors[0].first'),\n    body_text = JSON_VALUE(complex_column, '$.body_text.text'),\n    complex_column\nFROM\n    OPENROWSET( BULK 'https://azureopendatastorage.blob.core.windows.net/covid19temp/comm_use_subset/pdf_json/000b7d1517ceebb34e1e3e817695b6de03e2fa78.json',\n                FORMAT='CSV', FIELDTERMINATOR ='0x0b', FIELDQUOTE = '0x0b', ROWTERMINATOR = '0x0b' ) WITH ( complex_column varchar(MAX) ) AS docs;\n\n/* The following query reads the structExample.parquet file and shows how to surface elements of a nested column. */\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/structExample.parquet',\n        FORMAT='PARQUET'\n    )\n    WITH (\n        [DateValue] DATE '$.DateStruct.Date',\n        [TimeStruct.Time] TIME,\n        [TimestampStruct.Timestamp] DATETIME2,\n        DecimalValue DECIMAL(18, 5) '$.DecimalStruct.Decimal',\n        [FloatStruct.Float] FLOAT\n    ) AS [r];\n\n\n/* Access elements from repeated columns */\nSELECT\n    *,\n    JSON_VALUE(SimpleArray, '$[0]') AS FirstElement,\n    JSON_VALUE(SimpleArray, '$[1]') AS SecondElement,\n    JSON_VALUE(SimpleArray, '$[2]') AS ThirdElement\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/justSimpleArray.parquet',\n        FORMAT='PARQUET'\n    ) AS [r];\n\n\n/* Access sub-objects from complex columns */\nSELECT\n    MapOfPersons,\n    JSON_QUERY(MapOfPersons, '$.\"John Doe\"') AS [John]\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/mapExample.parquet',\n        FORMAT='PARQUET'\n    ) AS [r];\n\n/* Explicitly reference the columns that you want to return in WITH clause */\nSELECT DocId,\n    MapOfPersons,\n    JSON_QUERY(MapOfPersons, '$.\"John Doe\"') AS [John]\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/mapExample.parquet',\n        FORMAT='PARQUET'\n    )\n    WITH (DocId bigint, MapOfPersons VARCHAR(max)) AS [r];\n\n\n/* Project values from repeated columns */\nSELECT\n    SimpleArray, Element\nFROM\n    OPENROWSET(\n        BULK 'https://sqlondemandstorage.blob.core.windows.net/public-parquet/nested/justSimpleArray.parquet',\n        FORMAT='PARQUET'\n    ) AS arrays\n    CROSS APPLY OPENJSON (SimpleArray) WITH (Element int '$') as array_values\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/R01112021-alter-weathertbl')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "changed stationName data length from 250 to 200",
				"folder": {
					"name": "virshah"
				},
				"content": {
					"query": "ALTER table [dbo].[Weather] \n    alter column [stationName] nvarchar(250)",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "SQLPool01",
						"databaseName": "SQLPool01"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SOD_Permissions')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "use master\ngo\nCREATE LOGIN [asa.adf.user] with password='PlaceholderPassword' --'P@ssword1!';\ngo\n\nuse RetailCosmosDB -- Use your DB name\ngo\nCREATE USER [asa.adf.user] FROM LOGIN [asa.adf.user];\n\nuse RetailCosmosDB -- Use your DB name\ngo\nalter role db_owner Add member [asa.adf.user]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "RetailCosmosDB"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 1')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [TransactionId]\n,[CustomerId]\n,[ProductId]\n,[Quantity]\n,[Price]\n,[TotalAmount]\n,[TransactionDateId]\n,[ProfitAmount]\n,[Hour]\n,[Minute]\n,[StoreId]\n FROM [wwi_mcw].[SaleSmall]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 12')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "ALTER TABLE [wwi_mcw].[SaleSmall] ALTER COLUMN TransactionId NVARCHAR(50) NOT NULL;\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 2')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP (100) [ProductId]\n,[Seasonality]\n,[Price]\n,[Profit]\n FROM [wwi_mcw].[Product]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 3')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n    TransactionDate, ProductId,\n    CAST(SUM(ProfitAmount) AS decimal(18,2)) AS [(sum) Profit],\n    CAST(AVG(ProfitAmount) AS decimal(18,2)) AS [(avg) Profit],\n    SUM(Quantity) AS [(sum) Quantity]\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakevshah.dfs.core.windows.net/wwi-02/sale-small/Year=2010/Quarter=Q4/Month=12/Day=20101231/sale-small-20101231-snappy.parquet',\n        FORMAT='PARQUET'\n    ) AS [r] GROUP BY r.TransactionDate, r.ProductId;\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 4')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n    Seasonality,\n    SUM(Price) as TotalSalesPrice,\n    SUM(Profit) as TotalProfit\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakevshah.dfs.core.windows.net/wwi-02/data-generators/generator-product/generator-product.csv',\n        FORMAT='CSV',\n        FIRSTROW = 1\n    ) WITH (\n        ProductID INT,\n        Seasonality INT,\n        Price DECIMAL(10,2),\n        Profit DECIMAL(10,2)\n    ) as csv\nGROUP BY\n    csv.Seasonality",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 5')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n    products.*\nFROM\n    OPENROWSET(\n        BULK 'https://asadatalakevshah.dfs.core.windows.net/wwi-02/product-json/json-data/*.json',\n        FORMAT='CSV',\n        FIELDTERMINATOR ='0x0b',\n        FIELDQUOTE = '0x0b',\n        ROWTERMINATOR = '0x0b'\n    )\n    WITH (\n        jsonContent NVARCHAR(200)\n    ) AS [raw]\nCROSS APPLY OPENJSON(jsonContent)\nWITH (\n    ProductId INT,\n    Seasonality INT,\n    Price DECIMAL(10,2),\n    Profit DECIMAL(10,2)\n) AS products",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 6')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "    /*  Column-level security feature in Azure Synapse simplifies the design and coding of security in applications.\n    It ensures column level security by restricting column access to protect sensitive data. */\n\n/* Scenario: In this scenario we will be working with two users. The first one is the CEO, he has access to all\n    data. The second one is DataAnalystMiami, this user doesn't have access to the confidential Revenue column\n    in the CampaignAnalytics table. Follow this lab, one step at a time to see how Column-level security removes access to the\n    Revenue column to DataAnalystMiami */\n\n--Step 1: Let us see how this feature in Azure Synapse works. Before that let us have a look at the Campaign Analytics table.\nselect  Top 100 * from wwi_mcw.CampaignAnalytics\nwhere City is not null and state is not null\n\n/*  Consider a scenario where there are two users.\n    A CEO, who is an authorized  personnel with access to all the information in the database\n    and a Data Analyst, to whom only required information should be presented.*/\n\n-- Step:2 Verify the existence of the CEO and DataAnalystMiami users in the Datawarehouse.\nSELECT Name as [User1] FROM sys.sysusers WHERE name = N'CEO';\nSELECT Name as [User2] FROM sys.sysusers WHERE name = N'DataAnalystMiami';\n\n\n-- Step:3 Now let us enforcing column level security for the DataAnalystMiami.\n/*  The CampaignAnalytics table in the warehouse has information like ProductID, Analyst, CampaignName, Quantity, Region, State, City, RevenueTarget and Revenue.\n    The Revenue generated from every campaign is classified and should be hidden from DataAnalystMiami.\n*/\n\nREVOKE SELECT ON wwi_mcw.CampaignAnalytics FROM DataAnalystMiami;\nGRANT SELECT ON wwi_mcw.CampaignAnalytics([Analyst], [Country], [CampaignName], [Region], [State], [City], [RevenueTarget]) TO DataAnalystMiami;\n-- This provides DataAnalystMiami access to all the columns of the Sale table but Revenue.\n\n-- Step:4 Then, to check if the security has been enforced, we execute the following query with current User As 'DataAnalystMiami', this will result in an error\n--  since DataAnalystMiami doesn't have select access to the Revenue column\nEXECUTE AS USER ='DataAnalystMiami';\nselect TOP 100 * from wwi_mcw.CampaignAnalytics;\n---\n-- The following query will succeed since we are not including the Revenue column in the query.\nEXECUTE AS USER ='DataAnalystMiami';\nselect [Analyst],[CampaignName], [Region], [State], [City], [RevenueTarget] from wwi_mcw.CampaignAnalytics;\n\n-- Step:5 Whereas, the CEO of the company should be authorized with all the information present in the warehouse.To do so, we execute the following query.\nRevert;\nGRANT SELECT ON wwi_mcw.CampaignAnalytics TO CEO;  --Full access to all columns.\n\n-- Step:6 Let us check if our CEO user can see all the information that is present. Assign Current User As 'CEO' and the execute the query\nEXECUTE AS USER ='CEO'\nselect * from wwi_mcw.CampaignAnalytics\nRevert;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 7')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/* Row level Security (RLS) in Azure Synapse enables us to use group membership to control access to rows in a table.\nAzure Synapse applies the access restriction every time the data access is attempted from any user.\nLet see how we can implement row level security in Azure Synapse.*/\n\n-- Row-Level Security (RLS), 1: Filter predicates\n-- Step:1 The Sale table has two Analyst values: DataAnalystMiami and DataAnalystSanDiego. \n--     Each analyst has jurisdiction across a specific Region. DataAnalystMiami on the South East Region\n--      and DataAnalystSanDiego on the Far West region.\nSELECT DISTINCT Analyst, Region FROM wwi_mcw.CampaignAnalytics order by Analyst ;\n\n/* Scenario: WWI requires that an Analyst only see the data for their own data from their own region. The CEO should see ALL data.\n    In the Sale table, there is an Analyst column that we can use to filter data to a specific Analyst value. */\n\n/* We will define this filter using what is called a Security Predicate. This is an inline table-valued function that allows\n    us to evaluate additional logic, in this case determining if the Analyst executing the query is the same as the Analyst\n    specified in the Analyst column in the row. The function returns 1 (will return the row) when a row in the Analyst column is the same as the user executing the query (@Analyst = USER_NAME()) or if the user executing the query is the CEO user (USER_NAME() = 'CEO')\n    whom has access to all data.\n*/\n\n-- Review any existing security predicates in the database\nSELECT * FROM sys.security_predicates\n\n--Step:2 Create a new Schema to hold the security predicate, then define the predicate function. It returns 1 (or True) when\n--  a row should be returned in the parent query.\nGO\nCREATE SCHEMA Security\nGO\nCREATE FUNCTION Security.fn_securitypredicate(@Analyst AS sysname)  \n    RETURNS TABLE  \nWITH SCHEMABINDING  \nAS  \n    RETURN SELECT 1 AS fn_securitypredicate_result\n    WHERE @Analyst = USER_NAME() OR USER_NAME() = 'CEO'\nGO\n-- Now we define security policy that adds the filter predicate to the Sale table. This will filter rows based on their login name.\nCREATE SECURITY POLICY SalesFilter  \nADD FILTER PREDICATE Security.fn_securitypredicate(Analyst)\nON wwi_mcw.CampaignAnalytics\nWITH (STATE = ON);\n\n------ Allow SELECT permissions to the Sale Table.------\nGRANT SELECT ON wwi_mcw.CampaignAnalytics TO CEO, DataAnalystMiami, DataAnalystSanDiego;\n\n-- Step:3 Let us now test the filtering predicate, by selecting data from the Sale table as 'DataAnalystMiami' user.\nEXECUTE AS USER = 'DataAnalystMiami'\nSELECT * FROM wwi_mcw.CampaignAnalytics;\nrevert;\n-- As we can see, the query has returned rows here Login name is DataAnalystMiami\n\n-- Step:4 Let us test the same for  'DataAnalystSanDiego' user.\nEXECUTE AS USER = 'DataAnalystSanDiego';\nSELECT * FROM wwi_mcw.CampaignAnalytics;\nrevert;\n-- RLS is working indeed.\n\n-- Step:5 The CEO should be able to see all rows in the table.\nEXECUTE AS USER = 'CEO';  \nSELECT * FROM wwi_mcw.CampaignAnalytics;\nrevert;\n-- And he can.\n\n--Step:6 To disable the security policy we just created above, we execute the following.\nALTER SECURITY POLICY SalesFilter  \nWITH (STATE = OFF);\n\nDROP SECURITY POLICY SalesFilter;\nDROP FUNCTION Security.fn_securitypredicate;\nDROP SCHEMA Security;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 8')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "----- Dynamic Data Masking (DDM) ---------\n/*  Dynamic data masking helps prevent unauthorized access to sensitive data by enabling customers\n    to designate how much of the sensitive data to reveal with minimal impact on the application layer.\n    Let see how */\n\n/* Scenario: WWI has identified sensitive information in the CustomerInfo table. They would like us to\n    obfuscate the CreditCard and Email columns of the CustomerInfo table to DataAnalysts */\n\n-- Step:1 Let's first get a view of CustomerInfo table.\nSELECT TOP (100) * FROM wwi_mcw.CustomerInfo;\n\n-- Step:2 Let's confirm that there are no Dynamic Data Masking (DDM) applied on columns.\nSELECT c.name, tbl.name as table_name, c.is_masked, c.masking_function  \nFROM sys.masked_columns AS c  \nJOIN sys.tables AS tbl\n    ON c.[object_id] = tbl.[object_id]  \nWHERE is_masked = 1\n    AND tbl.name = 'CustomerInfo';\n-- No results returned verify that no data masking has been done yet.\n\n-- Step:3 Now let's mask 'CreditCard' and 'Email' Column of 'CustomerInfo' table.\nALTER TABLE wwi_mcw.CustomerInfo  \nALTER COLUMN [CreditCard] ADD MASKED WITH (FUNCTION = 'partial(0,\"XXXX-XXXX-XXXX-\",4)');\nGO\nALTER TABLE wwi_mcw.CustomerInfo\nALTER COLUMN Email ADD MASKED WITH (FUNCTION = 'email()');\nGO\n-- The columns are successfully masked.\n\n-- Step:4 Let's see Dynamic Data Masking (DDM) applied on the two columns.\nSELECT c.name, tbl.name as table_name, c.is_masked, c.masking_function  \nFROM sys.masked_columns AS c  \nJOIN sys.tables AS tbl\n    ON c.[object_id] = tbl.[object_id]  \nWHERE is_masked = 1\n    AND tbl.name ='CustomerInfo';\n\n-- Step:5 Now, let's grant SELECT permission to 'DataAnalystMiami' on the 'CustomerInfo' table.\nGRANT SELECT ON wwi_mcw.CustomerInfo TO DataAnalystMiami;  \n\n-- Step:6 Logged in as  'DataAnalystMiami' let's execute the select query and view the result.\nEXECUTE AS USER = 'DataAnalystMiami';  \nSELECT * FROM wwi_mcw.CustomerInfo;\n\n-- Step:7 Let's remove the data masking using UNMASK permission\nGRANT UNMASK TO DataAnalystMiami;\nEXECUTE AS USER = 'DataAnalystMiami';  \nSELECT *\nFROM wwi_mcw.CustomerInfo;\nrevert;\nREVOKE UNMASK TO DataAnalystMiami;  \n\n----step:8 Reverting all the changes back to as it was.\nALTER TABLE wwi_mcw.CustomerInfo\nALTER COLUMN CreditCard DROP MASKED;\nGO\nALTER TABLE wwi_mcw.CustomerInfo\nALTER COLUMN Email DROP MASKED;\nGO",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SampleQueries')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/* Compute Summary Statistics over dataset */\n\n    SELECT b.Quartername,\n           COUNT(a.PickupTimeID) AS \"TotalTrips\",\n           SUM([TripDistanceMiles]) AS \"TotalMiles\",\n           SUM([PassengerCount]) AS \"TotalPassengers\",\n           AVG([FareAmount]) AS \"AvgFare\",\n           MAX([FareAmount]) AS \"MaxFare\"\n    FROM dbo.Trip a\n    LEFT JOIN dbo.Date b ON a.[DateID] = b.[DateID]\n    GROUP BY b.Quartername,\n             b.Quarter\n    ORDER BY b.Quarter\n    \n    \n    /* Windowing functions - Find top 3 cities per county in NY state having a min of 100 trips */\n    \n    SELECT c.*\n    FROM\n      (SELECT b.County,\n              b.city,\n              count(a.dateid) AS total_trips,\n              rank() OVER (PARTITION BY b.county\n                           ORDER BY count(a.dateid) DESC) AS rank\n       FROM dbo.Trip a\n       LEFT JOIN dbo.Geography b ON a.[PickupGeographyID] = b.[GeographyID]\n       WHERE State = 'NY'\n       GROUP BY b.County,\n                b.city) c\n    WHERE rank <=3\n      AND total_trips > 100\n    ORDER BY County,\n             City,\n             total_trips,\n             rank",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlCompute"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SanskaJson')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "--NOTE: PLEASE REPLACE XXXXXX WITH YOUR ALDS GEN2 STORAGE ACCOUNT NAME\n--NOTICE BOTH JSON FUNCTIONS JSON_VALUE & JSON_QUERY \n\n--############## QUERY INSPECTION CHECKLISTS\nSELECT TOP 100\n    JSON_VALUE (jsonContent, '$.id') id,\n    JSON_QUERY(jsonContent, '$.sections') sections,\n    JSON_VALUE(jsonContent, '$.sections[0].items[3].name') section_item_name,\n    JSON_VALUE(jsonContent, '$.sections[0].items[3].type.category') section_item_type_category,\n    jsonContent\n/* --> place the keys that you see in JSON documents in the WITH clause:\n       , JSON_VALUE (jsonContent, '$.key1') ASheader1\n       , JSON_VALUE (jsonContent, '$.key2')ASheader2\n*/\nFROM\n    OPENROWSET(\n        BULK 'https://XXXXXX.dfs.core.windows.net/staging/inspection_checklists_14033710077.json',\n        FORMAT = 'CSV',\n        FIELDQUOTE = '0x0b',\n        FIELDTERMINATOR ='0x0b',\n        ROWTERMINATOR = '0x0b'\n    )\n    WITH (\n        jsonContent varchar(MAX)\n    ) AS [result]\n\n--############## QUERY DRAWINGS JSON\nSELECT TOP 100\n   JSON_VALUE (jsonContent, '$[0].id') id,\n    JSON_VALUE (jsonContent, '$[0].title') title,\n    JSON_VALUE (jsonContent, '$[0].current_revision.floorplan') floorplan,\n    JSON_VALUE (jsonContent, '$[0].current_revision.pdf_size') pdf_size,\n    jsonContent\n  /*--> place the keys that you see in JSON documents in the WITH clause:\n       , JSON_VALUE (jsonContent, '$.key1') ASheader1\n       , JSON_VALUE (jsonContent, '$.key2')ASheader2\n*/\nFROM\n    OPENROWSET(\n        BULK 'https://XXXXXX.dfs.core.windows.net/staging/Drawings_597028_1017221 (raw).json',\n        FORMAT = 'CSV',\n        FIELDQUOTE = '0x0b',\n        FIELDTERMINATOR ='0x0b',\n        ROWTERMINATOR = '0x0b'\n    )\n    WITH (\n        jsonContent varchar(MAX)\n    ) AS [result]\n\n--############## \n/* The example extracts scalar and objects values from COVID-19 Open Research Dataset JSON file with nested objects is shown below.*/\nSELECT\n    title = JSON_VALUE(doc, '$.metadata.title'),\n    first_author = JSON_QUERY(doc, '$.metadata.authors[0]'),\n    first_author_name = JSON_VALUE(doc, '$.metadata.authors[0].first'),\n    complex_object = doc\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/covid19temp/comm_use_subset/pdf_json/000b7d1517ceebb34e1e3e817695b6de03e2fa78.json',\n        FORMAT='CSV', FIELDTERMINATOR ='0x0b', FIELDQUOTE = '0x0b', ROWTERMINATOR = '0x0b'\n    )\n    WITH ( doc varchar(MAX) ) AS docs;\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/serverless_cost_per_query')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "virshah"
				},
				"content": {
					"query": "--testing GitHub changes\nSELECT \n       ERH.status as [status],\n       ERH.login_name as [login_name],\n       ERH.start_time as [start_time],\n       ERH.end_time as [end_time],\n       ERH.total_elapsed_time_ms as [duration_ms],\n\n       /* Data processed =  data scanned + data moved + data written */\n       ERH.data_processed_mb as [data_processed_MB],\n\n       /* Cost management for serverless SQL pool\n       The amount of data processed is rounded up to the nearest MB per query. \n       Each query has a minimum of 10 MB of data processed. */\n       CASE WHEN ERH.data_processed_mb < 10 THEN 10 ELSE ERH.data_processed_mb END as [data_pricing_MB],\n       \n       cast(ERH.total_elapsed_time_ms/1000.0 as decimal(12,2)) as [duration_sec],\n       /*$5 per 1TB scan, minimum 10M */\n       cast((CASE WHEN ERH.data_processed_mb < 10 THEN 10 ELSE ERH.data_processed_mb END)*5/100000.0 as decimal(19,7))  as cost_in_$,\n       ERH.command as [statement],\n       ERH.query_text as [command]       \nFROM sys.dm_exec_requests_history ERH\nORDER BY ERH.start_time desc\n--order by cast((CASE WHEN ERH.data_processed_mb < 10 THEN 10 ELSE ERH.data_processed_mb END)*5/100000.0 as decimal(19,7)) desc\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapse_dmv_reporter')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/****** Object:  StoredProcedure [dbo].[synapse_dmv_reporter]    Script Date: 10/21/2020 3:50:13 PM ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\ncreate SCHEMA SYNAPSE_TOOLKIT\nGO\n--testing incremental change\n\nIF EXISTS(SELECT * FROM INFORMATION_SCHEMA.ROUTINES where ROUTINE_NAME = 'synapse_dmv_reporter' AND ROUTINE_SCHEMA = 'SYNAPSE_TOOLKIT')\n       DROP PROCEDURE [SYNAPSE_TOOLKIT].[synapse_dmv_reporter]; \nGO\n\nCREATE PROC [SYNAPSE_TOOLKIT].[synapse_dmv_reporter] @label [nvarchar](255), @requestid [nvarchar](32) AS\n-- ============================================================================================================================================\n-- General syntax use:\tEXEC [SYNAPSE_TOOLKIT].[synapse_dmv_reporter] NULL, NULL\n--\t\t\t\t\t\tEXEC [SYNAPSE_TOOLKIT].[synapse_dmv_reporter] 'query label', NULL\n--\t\t\t\t\t\tEXEC [SYNAPSE_TOOLKIT].[synapse_dmv_reporter] NULL, QID123456\n-- \n-- Author:      Diego Caracciolo, Customer Architecture and Engineering (CAE), Microsoft\n-- Create Date: 10/20/2020\n-- Description: This sproc compiles several queries -- to DMVs that provide\n-- helpful information for troubleshooting long running operations in\n-- Synapse Dedicated SQL Pools based on either a query label or a QID\n-- ============================================================================================================================================\n\nBEGIN\nSET NOCOUNT ON\n\n-- Declare variables\nDECLARE @reqid nvarchar(32) = @requestid\nDECLARE @optype nvarchar(35)\nDECLARE @stepindex INT\nDECLARE @sessionid nvarchar(32)\n\nIF ((@requestid IS NULL or @requestid = '') AND @label IS NULL or @label = '') -- We show everything that is running as we haven't been provided with a label nor a QID\nBEGIN\n\t\n\tPRINT 'We show everything that is running as we have not been provided with a label nor a QID'\n\n\t-- Output all the requests and sessions that are running\n\tSELECT r.request_id, r.session_id, r.[label], r.resource_class, r.[status], r.submit_time, r.start_time, r.end_compile_time, r.total_elapsed_time/60000 as total_elapsed_time_minutes, \n\t\tr.total_elapsed_time/1000 as total_elapsed_time_seconds, r.command\n\tFROM sys.dm_pdw_exec_requests AS r\n\t\tJOIN sys.dm_pdw_exec_sessions AS s ON r.SESSION_ID = s.SESSION_ID\n\tWHERE r.status ='running'\n\nEND\nIF ((@requestid IS NULL or @requestid = '') AND @label IS NOT NULL ) -- We work with @label and report based on that label for a running request\nBEGIN\n\n\tPRINT 'We work with @label and report based on that label, not a QID'\n\t\n\t-- Obtain request_id_/QID based on the label of a running query or sproc\n\tSELECT @reqid = r.request_id\n\t, @sessionid = r.session_id\n\tFROM sys.dm_pdw_exec_requests AS r\n\t\tJOIN sys.dm_pdw_exec_sessions AS s ON r.SESSION_ID = s.SESSION_ID\n\tWHERE 1=1\n\t\tAND r.status ='running'\n\t\tAND r.[label] LIKE '%'+ @label + '%'\n\n\t-- Output the full session steps\n\tSELECT * , total_elapsed_time/1000 as total_elapsed_time_seconds, total_elapsed_time/60000 as total_elapsed_time_minutes\n\tFROM sys.dm_pdw_exec_requests\n\tWHERE session_id = @sessionid\n\tORDER BY submit_time DESC\t\n\n\t-- Output the steps for the obtained request_id/QID\n\tSELECT *, total_elapsed_time/1000 as total_elapsed_time_seconds, total_elapsed_time/60000 as total_elapsed_time_minutes\n\tFROM sys.dm_pdw_request_steps\n\tWHERE request_id = @reqid\n\t\t--AND status = 'Running'\n\n\t-- Assign values to the valiables for the running request_id\n\tSELECT @optype = operation_type, @stepindex = step_index\n\tFROM sys.dm_pdw_request_steps\n\tWHERE request_id = @reqid\n\t\tAND status = 'Running'\n\n\t-- Output the sessions working for the identified request_id\n\tSELECT --#RemoveThisMetaQueryInResult\n\t\tSes.session_id ,Ses.request_id\n\t,Req.[label],Req.command\n\t,steps.operation_type ,steps.distribution_type ,steps.[status] ,steps.start_time ,steps.end_time ,steps.row_count ,steps.command\n\tFROM sys.dm_pdw_exec_requests Req\n\t\tjoin sys.dm_pdw_exec_sessions Ses\n\t\t\tON Ses.request_id=Req.request_id\n\t\tjoin sys.dm_pdw_request_steps steps\n\t\t\tON steps.request_id=Req.request_id\n\tWHERE steps.request_id = @reqid\n\t\tAND Req.command not like '%RemoveThisMetaQueryInResult%'\n\tORDER BY steps.start_time\n\n\tIF @optype IN ('OnOperation','RemoteOperation','ReturnOperation')\n\tBEGIN\n\t\tPRINT 'Running a SQL Operation'\n\t\tPRINT @optype\n\t\tPRINT @stepindex\n\t\t-- Output information from dm_pdw_nodes_exec_requests related to the nodes that are executing a SQL request for this request_id/QID\n\t\tSELECT DISTINCT\n\t\t\tgetdate() as CaptureTime,\n\t\t\tper.request_id, per.session_id, per.[status] as PERStatus, per.start_time, per.total_elapsed_time, per.database_id, per.command as PERCommand,\n\t\t\tper.resource_class, psr.step_index, psr.distribution_ID, psr.[status] as PSRStatus, psr.Start_time as PSR_StartTime,\n\t\t\tpsr.total_elapsed_time as PSRTotal_Elapsed_Time, psr.command as  PSRCommand, ser.session_id as CMPSPID, ser.start_time as CMPStartTime,\n\t\t\tser.[status] as CMPStatus, ser.blocking_session_id as CMPBlocking_SPID, ser.wait_type as CMPWait_type, ser.wait_time as CMPwait_time,\n\t\t\tser.last_wait_type as CMPLast_Wait_Type, ser.wait_resource as CMPWait_resource, ser.cpu_time as CMPcpu_time, ser.total_elapsed_time as CMPtotal_elapsed_time,\n\t\t\tser.reads as CMPReads, ser.writes as CMPWrites, ser.logical_reads as CMPlogical_reads, ser.granted_query_memory as CMPgranted_query_memory,\n\t\t\tser.pdw_node_id as PDW_node_id, ser.writes\n\t\tFROM sys.dm_pdw_exec_requests per\n\t\t\tINNER JOIN sys.dm_pdw_sql_requests psr\n\t\t\t\tON per.request_id = psr.request_id\n\t\t\tINNER JOIN sys.dm_pdw_nodes_exec_requests ser\n\t\t\t\tON psr.spid = ser.session_id\n\t\t\t\tAND ser.pdw_node_id = psr.pdw_node_id\n\t\tWHERE per.status='Running' AND per.request_id = @reqid\n\tEND\n\n\tIF @optype IN ('ShuffleMoveOperation','BroadcastMoveOperation','TrimMoveOperation','PartitionMoveOperation','MoveOperation','CopyOperation')\n\tBEGIN\n\t\tPRINT 'Running a Data Movement OperatiON of type: ' + @optype\n\t\tPRINT 'Running step_index: ' + CONVERT(char,@stepindex)\n\t\t-- Output information about all the workers completing a Data Movement Step\n\t\tSELECT DISTINCT @stepindex AS step_index, *\n\t\tFROM sys.dm_pdw_exec_requests per               \n\t\t\tINNER JOIN sys.dm_pdw_request_steps prs               \n\t\t\t\tON per.request_id = prs.request_id       \n\t\t\tleft outer join sys.dm_pdw_dms_workers pdw                \n\t\t\t\tON prs.request_id = pdw.request_id       \n\t\t\t\tAND prs.step_index = pdw.step_index\n\t\tWHERE per.request_id=@reqid\n\t\tORDER BY per.request_id, prs.step_index, pdw.dms_step_index\n\tEND\nEND\n\nIF (@label IS NULL OR @label = '') AND @requestid IS NOT NULL --  We work with a QID and report based on it whether is running or not \nBEGIN\n\n\tPRINT 'We work with a QID and report based on that, not a label'\n\t\n\tPRINT 'Request ID is: ' + CONVERT(char,@reqid)\n\n\t-- Obtain the steps for the request_id/QID\n\tSELECT *, total_elapsed_time/1000 as total_elapsed_time_seconds, total_elapsed_time/60000 as total_elapsed_time_minutes\n\tFROM sys.dm_pdw_request_steps\n\tWHERE request_id = @reqid\n\t\t--AND status = 'Running'\n\n\t-- Assign values to the valiables for the running \n\tSELECT @optype = operation_type, @stepindex = step_index\n\tFROM sys.dm_pdw_request_steps\n\tWHERE request_id = @reqid\n\t\tAND status = 'Running'\n\n\t-- Output the sessions working for the identified request_id\n\tSELECT --#RemoveThisMetaQueryInResult\n\t\tSes.session_id ,Ses.request_id\n\t,Req.[label],Req.command\n\t,steps.operation_type ,steps.distribution_type ,steps.[status] ,steps.start_time ,steps.end_time ,steps.row_count ,steps.command\n\tFROM sys.dm_pdw_exec_requests Req\n\t\tjoin sys.dm_pdw_exec_sessions Ses\n\t\t\tON Ses.request_id=Req.request_id\n\t\tjoin sys.dm_pdw_request_steps steps\n\t\t\tON steps.request_id=Req.request_id\n\tWHERE steps.request_id = @reqid\n\t\tAND Req.command not like '%RemoveThisMetaQueryInResult%'\n\tORDER BY steps.start_time\n\n\tIF @optype IN ('OnOperation','RemoteOperation','ReturnOperation')\n\tBEGIN\n\t\tPRINT 'Running a SQL Operation'\n\t\tPRINT @optype\n\t\tPRINT @stepindex\n\t\t-- Output information from dm_pdw_nodes_exec_requests related to the nodes that are executing a SQL request for this request_id/QID\n\t\tSELECT DISTINCT\n\t\t\tgetdate() as CaptureTime,\n\t\t\tper.request_id, per.session_id, per.[status] as PERStatus, per.start_time, per.total_elapsed_time, per.database_id, per.command as PERCommand,\n\t\t\tper.resource_class, psr.step_index, psr.distribution_ID, psr.[status] as PSRStatus, psr.Start_time as PSR_StartTime,\n\t\t\tpsr.total_elapsed_time as PSRTotal_Elapsed_Time, psr.command as  PSRCommand, ser.session_id as CMPSPID, ser.start_time as CMPStartTime,\n\t\t\tser.[status] as CMPStatus, ser.blocking_session_id as CMPBlocking_SPID, ser.wait_type as CMPWait_type, ser.wait_time as CMPwait_time,\n\t\t\tser.last_wait_type as CMPLast_Wait_Type, ser.wait_resource as CMPWait_resource, ser.cpu_time as CMPcpu_time, ser.total_elapsed_time as CMPtotal_elapsed_time,\n\t\t\tser.reads as CMPReads, ser.writes as CMPWrites, ser.logical_reads as CMPlogical_reads, ser.granted_query_memory as CMPgranted_query_memory,\n\t\t\tser.pdw_node_id as PDW_node_id, ser.writes\n\t\tFROM sys.dm_pdw_exec_requests per\n\t\t\tINNER JOIN sys.dm_pdw_sql_requests psr\n\t\t\t\tON per.request_id = psr.request_id\n\t\t\tINNER JOIN sys.dm_pdw_nodes_exec_requests ser\n\t\t\t\tON psr.spid = ser.session_id\n\t\t\t\tAND ser.pdw_node_id = psr.pdw_node_id\n\t\tWHERE per.status='Running' AND per.request_id = @reqid\n\tEND\n\n\tIF @optype IN ('ShuffleMoveOperation','BroadcastMoveOperation','TrimMoveOperation','PartitionMoveOperation','MoveOperation','CopyOperation')\n\tBEGIN\n\t\tPRINT 'Running a Data Movement OperatiON of type: ' + @optype\n\t\tPRINT 'Running step_index: ' + CONVERT(char,@stepindex)\n\t\t-- Find informatiON about all the workers completing a Data Movement Step\n\t\tSELECT DISTINCT @stepindex AS step_index, *\n\t\tFROM sys.dm_pdw_exec_requests per               \n\t\t\tINNER JOIN sys.dm_pdw_request_steps prs               \n\t\t\t\tON per.request_id = prs.request_id       \n\t\t\tleft outer join sys.dm_pdw_dms_workers pdw                \n\t\t\t\tON prs.request_id = pdw.request_id       \n\t\t\t\tAND prs.step_index = pdw.step_index\n\t\tWHERE per.request_id=@reqid\n\t\tORDER BY per.request_id, prs.step_index, pdw.dms_step_index\n\tEND\nEND\n\nEND\nGO\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sys_sqlpool_distribution')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\ndistinct db_name() as DBName,\ns.name as SchemaName,\nt.name as TableName,\nIs_external,\ntdp.distribution_policy_desc,\nCASE WHEN cdp.distribution_ordinal = 1 then c.name ELSE NULL END as DistCol,\nCase when cdp.distribution_ordinal = 1 then ty.Name ELSE NULL END as DistCOL_DataType,\ni.type_desc as StorageType,\nCASE WHEN count(p.rows) > 1 THEN 'YES' ELSE 'NO' END as IsPartitioned,\ncount(p.rows) as NumPartitions,\nsum(p.rows) as NumRows,\ndb_name() + '_' + s.name + '_' + t.name as row_key\nFROM\nsys.tables AS t\nINNER JOIN sys.schemas AS s ON t.schema_id = s.schema_id\nINNER JOIN sys.pdw_table_distribution_properties AS tdp ON t.object_id = tdp.object_id\nINNER JOIN sys.columns AS c ON t.object_id = c.object_id\nINNER join sys.types ty ON C.system_type_id = ty.system_type_id\nINNER JOIN sys.pdw_column_distribution_properties AS cdp ON c.object_id = cdp.object_id\nAND c.column_id = cdp.column_id --note rowcount from sys.partitions assumes PDW stats are accurate\n--to get stats from nodes use pdw_nodes_partitions instead\nINNER JOIN sys.partitions p ON t.object_id = p.object_id\nINNER JOIN sys.indexes i ON t.object_id = i.object_id\nWHERE\n(\ntdp.distribution_policy_desc <> 'HASH'\nor cdp.distribution_ordinal = 1\n)\nAND i.index_ID < 2\nand is_external = '0'\nGROUP BY\ns.name,\nt.name,\ntdp.distribution_policy_desc,\ncdp.distribution_ordinal,\nc.name,\ni.type_desc,\nIs_external,\nty.Name\nunion\nSELECT\ndistinct db_name() as DBName,\ns.name as SchemaName,\nt.name as TableName,\nIs_external,\n'' as distribution_policy_desc,\nNULL AS DataType,\nNULL as DistCol,\n'HADOOP' StorageType,\n'NO' as IsPartitioned,\n0 as NumPartitions,\n0 as NumRows,\ndb_name() + '_' + s.name + '_' + t.name as row_key\nFROM\nsys.tables AS t\nINNER JOIN sys.schemas AS s ON t.schema_id = s.schema_id\nWhere\nIs_External = '1'\nORDER BY\ndb_name(),\nS.name,\nt.name",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "SQLPool01",
						"type": "SqlPool"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureSynapse-pyspark-ecdc-covid-19-cases')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 0,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"kernelspec": {
						"name": "python3",
						"display_name": "Python 3"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"scrolled": false
						},
						"source": [
							"# Azure storage access info\n",
							"blob_account_name = \"pandemicdatalake\"\n",
							"blob_container_name = \"public\"\n",
							"blob_relative_path = \"curated/covid-19/ecdc_cases/latest/ecdc_cases.parquet\"\n",
							"blob_sas_token = r\"\""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"source": [
							"# Allow SPARK to read from Blob remotely\n",
							"wasbs_path = 'wasbs://%s@%s.blob.core.windows.net/%s' % (blob_container_name, blob_account_name, blob_relative_path)\n",
							"spark.conf.set(\n",
							"  'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"  blob_sas_token)\n",
							"print('Remote blob path: ' + wasbs_path)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "code",
						"metadata": {
							"scrolled": true
						},
						"source": [
							"# SPARK read parquet, note that it won't load any data yet by now\n",
							"df = spark.read.parquet(wasbs_path)\n",
							"print('Register the DataFrame as a SQL temporary view: source')\n",
							"df.createOrReplaceTempView('source')"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"date_rep"
									],
									"values": [
										"day"
									],
									"yLabel": "day",
									"xLabel": "date_rep",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"aggData": "{\"day\":{\"2020-09-13\":13,\"2020-09-14\":14,\"2020-09-15\":15,\"2020-09-16\":16,\"2020-09-17\":17,\"2020-09-18\":18,\"2020-09-19\":19,\"2020-09-20\":20,\"2020-09-21\":21,\"2020-09-22\":22}}",
								"isSummary": false,
								"previewData": {
									"filter": null
								},
								"isSql": false
							}
						},
						"source": [
							"# Display top 10 rows\n",
							"print('Displaying top 10 rows: ')\n",
							"display(spark.sql('SELECT * FROM source LIMIT 10'))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDBLink')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 3,
					"conf": {
						"spark.dynamicAllocation.minExecutors": "3",
						"spark.dynamicAllocation.maxExecutors": "3"
					}
				},
				"metadata": {
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "sparksql"
							},
							"tags": []
						},
						"source": [
							"%%sql\n",
							"-- To select a preferred list of regions in a multi-region Azure Cosmos DB account, add spark.cosmos.preferredRegions '<Region1>,<Region2>' in the config options\n",
							"\n",
							"create table tbl_vehicle_telemetry using cosmos.olap options (\n",
							"    spark.synapse.linkedService 'CosmosDb1',\n",
							"    spark.cosmos.container 'telemetry',\n",
							"    spark.cosmos.preferredRegions 'westus'\n",
							")"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							},
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"city"
									],
									"values": [
										"avg(speed)"
									],
									"yLabel": "avg(speed)",
									"xLabel": "city",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"aggData": "\"{\\\"avg(speed)\\\":{\\\"Chicago\\\":52.66677408959072,\\\"Los Angeles\\\":52.74830371567044,\\\"Madison\\\":52.21785368997744,\\\"Orlando\\\":77.1990082644628,\\\"San Diego\\\":53.17280265339967,\\\"Tampa\\\":51.55058674278465}}\"",
								"isSummary": false,
								"previewData": {
									"filter": null
								},
								"isSql": false
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"dfavgspeed_sql=spark.sql(\"select city, avg(speed) from tbl_vehicle_telemetry group by city\")\n",
							"display(dfavgspeed_sql)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 12
					},
					{
						"cell_type": "code",
						"source": [
							"# Load a streaming Spark DataFrame from a Cosmos DB container\n",
							"# To select a preferred list of regions in a multi-region Cosmos DB account, add .option(\"spark.cosmos.preferredRegions\", \"<Region1>,<Region2>\")\n",
							"\n",
							"dfStream = spark.read\\\n",
							"    .format(\"cosmos.oltp\")\\\n",
							"    .option(\"spark.synapse.linkedService\", \"CosmosDb1\")\\\n",
							"    .option(\"spark.cosmos.container\", \"telemetry\")\\\n",
							"    .load()\n",
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 9
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"_attachments"
									],
									"values": [
										"_ts"
									],
									"yLabel": "_ts",
									"xLabel": "_attachments",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"aggData": "\"{\\\"_ts\\\":{\\\"attachments/\\\":1602495820496}}\"",
								"isSummary": false,
								"previewData": {
									"filter": null
								},
								"isSql": false
							}
						},
						"source": [
							"dfStream.groupBy(\"city\").agg({'speed': 'avg'}).show()"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 10
					},
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "sparksql"
							},
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"city"
									],
									"values": [
										"avg(speed)"
									],
									"yLabel": "avg(speed)",
									"xLabel": "city",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"aggData": "\"{\\\"avg(speed)\\\":{\\\"Chicago\\\":52.66677408959072,\\\"Los Angeles\\\":52.74830371567044,\\\"Madison\\\":52.21785368997744,\\\"Orlando\\\":77.1990082644628,\\\"San Diego\\\":53.17280265339967,\\\"Tampa\\\":51.55058674278465}}\"",
								"isSummary": false,
								"previewData": {
									"filter": null
								},
								"isSql": true
							},
							"collapsed": false
						},
						"source": [
							"%%sql\n",
							"select city, avg(speed) from tbl_vehicle_telemetry\n",
							"group by city"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 11
					},
					{
						"cell_type": "code",
						"source": [
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/NYTaxi-pred-tripcost')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import matplotlib.pyplot as plt\n",
							"from datetime import datetime\n",
							"from dateutil import parser\n",
							"from pyspark.sql.functions import unix_timestamp, date_format, col, when\n",
							"from pyspark.ml import Pipeline\n",
							"from pyspark.ml import PipelineModel\n",
							"from pyspark.ml.feature import RFormula\n",
							"from pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorIndexer\n",
							"from pyspark.ml.classification import LogisticRegression\n",
							"from pyspark.mllib.evaluation import BinaryClassificationMetrics\n",
							"from pyspark.ml.evaluation import BinaryClassificationEvaluator"
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"source": [
							"from azureml.opendatasets import NycTlcYellow\n",
							"\n",
							"end_date = parser.parse('2018-06-06')\n",
							"start_date = parser.parse('2018-05-01')\n",
							"nyc_tlc = NycTlcYellow(start_date=start_date, end_date=end_date)\n",
							"filtered_df = nyc_tlc.to_spark_dataframe()"
						],
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "code",
						"source": [
							"# To make development easier, faster and less expensive down sample for now\n",
							"sampled_taxi_df = filtered_df.sample(True, 0.001, seed=1234)"
						],
						"outputs": [],
						"execution_count": 8
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"vendorID"
									],
									"values": [
										"passengerCount"
									],
									"yLabel": "passengerCount",
									"xLabel": "vendorID",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"aggData": {
									"passengerCount": {
										"1": 522,
										"2": 1119
									}
								},
								"isSummary": false,
								"previewData": {
									"filter": null
								},
								"isSql": false
							}
						},
						"source": [
							"#sampled_taxi_df.show(5)\n",
							"display(sampled_taxi_df)"
						],
						"outputs": [],
						"execution_count": 9
					},
					{
						"cell_type": "code",
						"source": [
							"sampled_taxi_df.createOrReplaceTempView(\"nytaxi\")"
						],
						"outputs": [],
						"execution_count": 11
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Understand the data\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"# The charting package needs a Pandas dataframe or numpy array do the conversion\n",
							"sampled_taxi_pd_df = sampled_taxi_df.toPandas()\n",
							"\n",
							"# Look at tips by amount count histogram\n",
							"ax1 = sampled_taxi_pd_df['tipAmount'].plot(kind='hist', bins=25, facecolor='lightblue')\n",
							"ax1.set_title('Tip amount distribution')\n",
							"ax1.set_xlabel('Tip Amount ($)')\n",
							"ax1.set_ylabel('Counts')\n",
							"plt.suptitle('')\n",
							"plt.show()\n",
							"\n",
							"# How many passengers tip'd by various amounts\n",
							"ax2 = sampled_taxi_pd_df.boxplot(column=['tipAmount'], by=['passengerCount'])\n",
							"ax2.set_title('Tip amount by Passenger count')\n",
							"ax2.set_xlabel('Passenger count')\n",
							"ax2.set_ylabel('Tip Amount ($)')\n",
							"plt.suptitle('')\n",
							"plt.show()\n",
							"\n",
							"# Look at the relationship between fare and tip amounts\n",
							"ax = sampled_taxi_pd_df.plot(kind='scatter', x= 'fareAmount', y = 'tipAmount', c='blue', alpha = 0.10, s=2.5*(sampled_taxi_pd_df['passengerCount']))\n",
							"ax.set_title('Tip amount by Fare amount')\n",
							"ax.set_xlabel('Fare Amount ($)')\n",
							"ax.set_ylabel('Tip Amount ($)')\n",
							"plt.axis([-2, 80, -2, 20])\n",
							"plt.suptitle('')\n",
							"plt.show()"
						],
						"outputs": [],
						"execution_count": 12
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Prepare Data\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"taxi_df = sampled_taxi_df.select('totalAmount', 'fareAmount', 'tipAmount', 'paymentType', 'rateCodeId', 'passengerCount'\\\n",
							"                                , 'tripDistance', 'tpepPickupDateTime', 'tpepDropoffDateTime'\\\n",
							"                                , date_format('tpepPickupDateTime', 'hh').alias('pickupHour')\\\n",
							"                                , date_format('tpepPickupDateTime', 'EEEE').alias('weekdayString')\\\n",
							"                                , (unix_timestamp(col('tpepDropoffDateTime')) - unix_timestamp(col('tpepPickupDateTime'))).alias('tripTimeSecs')\\\n",
							"                                , (when(col('tipAmount') > 0, 1).otherwise(0)).alias('tipped')\n",
							"                                )\\\n",
							"                        .filter((sampled_taxi_df.passengerCount > 0) & (sampled_taxi_df.passengerCount < 8)\\\n",
							"                                & (sampled_taxi_df.tipAmount >= 0) & (sampled_taxi_df.tipAmount <= 25)\\\n",
							"                                & (sampled_taxi_df.fareAmount >= 1) & (sampled_taxi_df.fareAmount <= 250)\\\n",
							"                                & (sampled_taxi_df.tipAmount < sampled_taxi_df.fareAmount)\\\n",
							"                                & (sampled_taxi_df.tripDistance > 0) & (sampled_taxi_df.tripDistance <= 100)\\\n",
							"                                & (sampled_taxi_df.rateCodeId <= 5)\n",
							"                                & (sampled_taxi_df.paymentType.isin({\"1\", \"2\"}))\n",
							"                                )"
						],
						"outputs": [],
						"execution_count": 13
					},
					{
						"cell_type": "code",
						"source": [
							"taxi_featurised_df = taxi_df.select('totalAmount', 'fareAmount', 'tipAmount', 'paymentType', 'passengerCount'\\\n",
							"                                                , 'tripDistance', 'weekdayString', 'pickupHour','tripTimeSecs','tipped'\\\n",
							"                                                , when((taxi_df.pickupHour <= 6) | (taxi_df.pickupHour >= 20),\"Night\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 7) & (taxi_df.pickupHour <= 10), \"AMRush\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 11) & (taxi_df.pickupHour <= 15), \"Afternoon\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 16) & (taxi_df.pickupHour <= 19), \"PMRush\")\\\n",
							"                                                .otherwise(0).alias('trafficTimeBins')\n",
							"                                              )\\\n",
							"                                       .filter((taxi_df.tripTimeSecs >= 30) & (taxi_df.tripTimeSecs <= 7200))"
						],
						"outputs": [],
						"execution_count": 14
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Create Logistic Regression Model\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"# The sample uses an algorithm that only works with numeric features convert them so they can be consumed\n",
							"sI1 = StringIndexer(inputCol=\"trafficTimeBins\", outputCol=\"trafficTimeBinsIndex\")\n",
							"en1 = OneHotEncoder(dropLast=False, inputCol=\"trafficTimeBinsIndex\", outputCol=\"trafficTimeBinsVec\")\n",
							"sI2 = StringIndexer(inputCol=\"weekdayString\", outputCol=\"weekdayIndex\")\n",
							"en2 = OneHotEncoder(dropLast=False, inputCol=\"weekdayIndex\", outputCol=\"weekdayVec\")\n",
							"\n",
							"# Create a new dataframe that has had the encodings applied\n",
							"encoded_final_df = Pipeline(stages=[sI1, en1, sI2, en2]).fit(taxi_featurised_df).transform(taxi_featurised_df)"
						],
						"outputs": [],
						"execution_count": 15
					},
					{
						"cell_type": "code",
						"source": [
							"#Decide on the split between training and testing data from the dataframe\n",
							"trainingFraction = 0.7\n",
							"testingFraction = (1-trainingFraction)\n",
							"seed = 1234\n",
							"\n",
							"# Split the dataframe into test and training dataframes\n",
							"train_data_df, test_data_df = encoded_final_df.randomSplit([trainingFraction, testingFraction], seed=seed)"
						],
						"outputs": [],
						"execution_count": 16
					},
					{
						"cell_type": "code",
						"source": [
							"## Create a new LR object for the model\n",
							"logReg = LogisticRegression(maxIter=10, regParam=0.3, labelCol = 'tipped')\n",
							"\n",
							"## The formula for the model\n",
							"classFormula = RFormula(formula=\"tipped ~ pickupHour + weekdayVec + passengerCount + tripTimeSecs + tripDistance + fareAmount + paymentType+ trafficTimeBinsVec\")\n",
							"\n",
							"## Undertake training and create an LR model\n",
							"lrModel = Pipeline(stages=[classFormula, logReg]).fit(train_data_df)\n",
							"\n",
							"## Saving the model is optional but its another form of inter session cache\n",
							"datestamp = datetime.now().strftime('%m-%d-%Y-%s')\n",
							"fileName = \"lrModel_\" + datestamp\n",
							"logRegDirfilename = fileName\n",
							"lrModel.save(logRegDirfilename)\n",
							"\n",
							"## Predict tip 1/0 (yes/no) on the test dataset, evaluation using AUROC\n",
							"predictions = lrModel.transform(test_data_df)\n",
							"predictionAndLabels = predictions.select(\"label\",\"prediction\").rdd\n",
							"metrics = BinaryClassificationMetrics(predictionAndLabels)\n",
							"print(\"Area under ROC = %s\" % metrics.areaUnderROC)"
						],
						"outputs": [],
						"execution_count": 17
					},
					{
						"cell_type": "code",
						"source": [
							"logRegDirfilename"
						],
						"outputs": [],
						"execution_count": 19
					},
					{
						"cell_type": "code",
						"source": [
							"## Plot the ROC curve, no need for pandas as this uses the modelSummary object\n",
							"modelSummary = lrModel.stages[-1].summary\n",
							"\n",
							"plt.plot([0, 1], [0, 1], 'r--')\n",
							"plt.plot(modelSummary.roc.select('FPR').collect(),\n",
							"         modelSummary.roc.select('TPR').collect())\n",
							"plt.xlabel('False Positive Rate')\n",
							"plt.ylabel('True Positive Rate')\n",
							"plt.show()"
						],
						"outputs": [],
						"execution_count": 18
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 1')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\r\n",
							"data_path = spark.read.load('abfss://wwi-02@asadatalakevshah.dfs.core.windows.net/sale-small/Year=2010/Quarter=Q4/Month=12/Day=20101231/sale-small-20101231-snappy.parquet', format='parquet')\r\n",
							"data_path.show(100)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 5
					},
					{
						"cell_type": "code",
						"source": [
							"data_path.printSchema()"
						],
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "code",
						"source": [
							"from pyspark.sql import SparkSession\n",
							"from pyspark.sql.types import *\n",
							"from pyspark.sql.functions import *\n",
							"\n",
							"profitByDateProduct = (data_path.groupBy(\"TransactionDate\",\"ProductId\")\n",
							"    .agg(\n",
							"        sum(\"ProfitAmount\").alias(\"(sum)ProfitAmount\"),\n",
							"        round(avg(\"Quantity\"), 4).alias(\"(avg)Quantity\"),\n",
							"        sum(\"Quantity\").alias(\"(sum)Quantity\"))\n",
							"    .orderBy(\"TransactionDate\"))\n",
							"profitByDateProduct.show(100)"
						],
						"outputs": [],
						"execution_count": 7
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 2')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"# Read from Cosmos DB analytical store into a Spark DataFrame and display 10 rows from the DataFrame\n",
							"# To select a preferred list of regions in a multi-region Cosmos DB account, add .option(\"spark.cosmos.preferredRegions\", \"<Region1>,<Region2>\")\n",
							"\n",
							"df = spark.read\\\n",
							"    .format(\"cosmos.olap\")\\\n",
							"    .option(\"spark.synapse.linkedService\", \"CosmosDb1\")\\\n",
							"    .option(\"spark.cosmos.container\", \"yelp_business\")\\\n",
							"    .load()\n",
							"\n",
							"display(df.limit(10))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"df = spark.read.load([\n",
							"    'abfss://sample-data@explrazstorage.dfs.core.windows.net/kaggle/Yelp/deltalake/business/part-00000-1f27cf86-c73e-44ef-b15b-26f8042f7a09-c000.snappy.parquet',\n",
							"    'abfss://sample-data@explrazstorage.dfs.core.windows.net/kaggle/Yelp/deltalake/business/part-00001-384a3390-3af0-4e1b-a12b-bbab30ac5f96-c000.snappy.parquet'\n",
							"    ], format='parquet')\n",
							"display(df.limit(10))"
						],
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"source": [
							"%%sql\n",
							"select count(*) from tbl_vehicle_telemetry"
						],
						"outputs": [],
						"execution_count": 4
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PUPYMo')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/982f0ec6-f886-45e3-9ba3-e777611a1369/resourceGroups/Synapse-MCW/providers/Microsoft.Synapse/workspaces/asaworkspacevshah/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://asaworkspacevshah.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import azureml.core\n",
							"\n",
							"from azureml.core import Experiment, Workspace, Dataset, Datastore\n",
							"from azureml.train.automl import AutoMLConfig\n",
							"from azureml.data.dataset_factory import TabularDatasetFactory"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"source": [
							"subscription_id = \"982f0ec6-f886-45e3-9ba3-e777611a1369\"\n",
							"resource_group = \"Synapse-MCW\"\n",
							"workspace_name = \"amlworkspacevshah\"\n",
							"experiment_name = \"asaworkspacevshah-vw_pupy_prediction_oppty-20201203102848\"\n",
							"\n",
							"ws = Workspace(subscription_id = subscription_id, resource_group = resource_group, workspace_name = workspace_name)\n",
							"experiment = Experiment(ws, experiment_name)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "code",
						"source": [
							"df = spark.sql(\"SELECT Customer,Product_Group,Product_Family,AAG_Category,Probability,Forecast_Category,Sector,Promo,Total_Price,Quantity,COGS_Total,Final_PSRP,Program_Discount,Channel_Discount,Price_USD_ACV,PUPY,License_count,license_bucket,Edition,Model,Revenue_Type,Geo,Stage,Close_Date,offering_category FROM default.vw_pupy_prediction_oppty where Product_Family  in ('Citrix Workspace')\")\n",
							"\n",
							"datastore = Datastore.get_default(ws)\n",
							"dataset = TabularDatasetFactory.register_spark_dataframe(df, datastore, name = experiment_name + \"-dataset2\")"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"source": [
							"automl_config = AutoMLConfig(spark_context = sc,\n",
							"                             task = \"regression\",\n",
							"                             training_data = dataset,\n",
							"                             label_column_name = \"PUPY\",\n",
							"                             n_cross_validations=2,\n",
							"                             allowed_models=['GradientBoosting'],\n",
							"                             blocked_models=['KNN','TensorFlowDNN'],\n",
							"                             primary_metric = \"spearman_correlation\",\n",
							"                             experiment_timeout_minutes = 60,\n",
							"                             max_concurrent_iterations = 2,\n",
							"                             enable_onnx_compatible_models = False)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"source": [
							"run = experiment.submit(automl_config)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 5
					},
					{
						"cell_type": "code",
						"source": [
							"displayHTML(\"<a href={} target='_blank'>Your experiment in Azure Machine Learning portal: {}</a>\".format(run.get_portal_url(), run.id))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "code",
						"source": [
							"run.wait_for_completion()\n",
							"\n",
							"# Install required dependency\n",
							"import pip\n",
							"pip.main([\"install\", \"azure-storage-blob==12.5.0\"])\n",
							"\n",
							"import mlflow\n",
							"\n",
							"# Get best model from automl run\n",
							"best_run, non_onnx_model = run.get_output()\n",
							"\n",
							"artifact_path = experiment_name + \"_artifact\"\n",
							"\n",
							"mlflow.set_tracking_uri(ws.get_mlflow_tracking_uri())\n",
							"mlflow.set_experiment(experiment_name)\n",
							"\n",
							"with mlflow.start_run() as run:\n",
							"    # Save the model to the outputs directory for capture\n",
							"    mlflow.sklearn.log_model(non_onnx_model, artifact_path)\n",
							"\n",
							"    # Register the model to AML model registry\n",
							"    mlflow.register_model(\"runs:/\" + run.info.run_id + \"/\" + artifact_path, \"asaworkspacevshah-vw_pupy_prediction_oppty-20201203102848-Best\")"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 7
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQLPool01')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		}
	]
}