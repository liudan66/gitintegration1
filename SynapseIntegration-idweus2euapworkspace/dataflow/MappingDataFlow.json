{
	"name": "MappingDataFlow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Transaction",
						"type": "DatasetReference"
					},
					"name": "Transaction"
				},
				{
					"dataset": {
						"referenceName": "TransactionLineItem",
						"type": "DatasetReference"
					},
					"name": "TransactionLineItem"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AdlsLinkedService",
						"type": "LinkedServiceReference"
					},
					"schemaLinkedService": {
						"referenceName": "AdlsLinkedService",
						"type": "LinkedServiceReference"
					},
					"name": "UnifiedDataLake"
				}
			],
			"transformations": [
				{
					"name": "Union"
				},
				{
					"name": "Select1"
				}
			],
			"script": "source(output(\n\t\tTransactionId as string,\n\t\tTransactionLineItemId as string,\n\t\tTransactionLineItemStartTimestamp as string,\n\t\tTransactionLineItemCompletedTimestamp as string,\n\t\tProductId as string,\n\t\tItemSku as string,\n\t\tUniversalProductCode as string,\n\t\tQuantity as string,\n\t\tUnitOfMeasureId as string,\n\t\tPreorderIndicator as string,\n\t\tProductListPriceAmount as string,\n\t\tTransactionProductPriceAmount as string,\n\t\tIsoCurrencyCode as string,\n\t\tFreeSampleIndicator as string,\n\t\tTotalTransactionLineItemAmount as string,\n\t\tTotalTransactionSalesPriceAmount as string,\n\t\tTransactionLineEntryMethodId as string,\n\t\tTransactionLineItemScanTimestamp as string,\n\t\tPosDeviceId as string,\n\t\tScaleUsedIndicator as string,\n\t\tScaleMeasuredItemWeight as string,\n\t\tWeightUomId as string,\n\t\tScaleQuantity as string,\n\t\tTransactionLineVolume as string,\n\t\tVolumeUomId as string,\n\t\tProductPriceOverrideIndicator as string,\n\t\tProductPriceAdjustmentAmount as string,\n\t\tProductPriceAdjustmentPercentage as string,\n\t\tTotalLineItemAdjustmentAmount as string,\n\t\tLineItemNote as string,\n\t\tQuantityBooked as string,\n\t\tQuantityBilled as string,\n\t\tQuantityBacklog as string,\n\t\tAcceptedQuantity as string,\n\t\tQuantityCancelled as string,\n\t\tQuantityReturned as string,\n\t\tBookedTimestamp as string,\n\t\tBilledTimestamp as string,\n\t\tCancelledTimestamp as string,\n\t\tReturnedTimestamp as string,\n\t\tCommittedShipmentTimestamp as string,\n\t\tRequestedDeliveryTimestamp as string,\n\t\tCommittedDeliveryTimestamp as string,\n\t\tCommittedAvailalbeForPickupTimestamp as string,\n\t\tPlannedPickTimestamp as string,\n\t\tActualPickTimestamp as string,\n\t\tPlannedShipmentTimestamp as string,\n\t\tActualShipmentTimestamp as string,\n\t\tPlannedDeliveryTimestamp as string,\n\t\tActualDeliveryTimestamp as string,\n\t\tDeliveryConfirmationTimestamp as string,\n\t\tShipmentChargeAmount as string,\n\t\tShipmentCostAmount as string,\n\t\tPickPackageCostAmount as string,\n\t\tShippingLocationId as string,\n\t\tShipmentMethodId as string,\n\t\tDropShipLineItemIndicator as string,\n\t\tWaybillNumber as string,\n\t\tTareWeight as string,\n\t\tNetWeight as string,\n\t\tShipCompleteIndicator as string,\n\t\tReturnTransactionId as string,\n\t\tReturnTransactionLineItemId as string,\n\t\tReturnToStockIndicator as string,\n\t\tReturnToStoreIndicator as string,\n\t\tApprovedByEmployeeId as string,\n\t\tSalesChannelId as string,\n\t\tDistributionChannelId as string,\n\t\tTransactionLineItemTypeId as string,\n\t\tTransactionLineItemStatusId as string,\n\t\tFuelPumpId as string,\n\t\tBuyClassId as string,\n\t\tPromotionId as string,\n\t\tPharmacyId as string,\n\t\tPharmacyTransactionId as string,\n\t\tPromotionOfferId as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Transaction\nsource(output(\n\t\tTransactionId as string,\n\t\tTransactionLineItemId as string,\n\t\tTransactionLineItemStartTimestamp as string,\n\t\tTransactionLineItemCompletedTimestamp as string,\n\t\tProductId as string,\n\t\tItemSku as string,\n\t\tUniversalProductCode as string,\n\t\tQuantity as string,\n\t\tUnitOfMeasureId as string,\n\t\tPreorderIndicator as string,\n\t\tProductListPriceAmount as string,\n\t\tTransactionProductPriceAmount as string,\n\t\tIsoCurrencyCode as string,\n\t\tFreeSampleIndicator as string,\n\t\tTotalTransactionLineItemAmount as string,\n\t\tTotalTransactionSalesPriceAmount as string,\n\t\tTransactionLineEntryMethodId as string,\n\t\tTransactionLineItemScanTimestamp as string,\n\t\tPosDeviceId as string,\n\t\tScaleUsedIndicator as string,\n\t\tScaleMeasuredItemWeight as string,\n\t\tWeightUomId as string,\n\t\tScaleQuantity as string,\n\t\tTransactionLineVolume as string,\n\t\tVolumeUomId as string,\n\t\tProductPriceOverrideIndicator as string,\n\t\tProductPriceAdjustmentAmount as string,\n\t\tProductPriceAdjustmentPercentage as string,\n\t\tTotalLineItemAdjustmentAmount as string,\n\t\tLineItemNote as string,\n\t\tQuantityBooked as string,\n\t\tQuantityBilled as string,\n\t\tQuantityBacklog as string,\n\t\tAcceptedQuantity as string,\n\t\tQuantityCancelled as string,\n\t\tQuantityReturned as string,\n\t\tBookedTimestamp as string,\n\t\tBilledTimestamp as string,\n\t\tCancelledTimestamp as string,\n\t\tReturnedTimestamp as string,\n\t\tCommittedShipmentTimestamp as string,\n\t\tRequestedDeliveryTimestamp as string,\n\t\tCommittedDeliveryTimestamp as string,\n\t\tCommittedAvailalbeForPickupTimestamp as string,\n\t\tPlannedPickTimestamp as string,\n\t\tActualPickTimestamp as string,\n\t\tPlannedShipmentTimestamp as string,\n\t\tActualShipmentTimestamp as string,\n\t\tPlannedDeliveryTimestamp as string,\n\t\tActualDeliveryTimestamp as string,\n\t\tDeliveryConfirmationTimestamp as string,\n\t\tShipmentChargeAmount as string,\n\t\tShipmentCostAmount as string,\n\t\tPickPackageCostAmount as string,\n\t\tShippingLocationId as string,\n\t\tShipmentMethodId as string,\n\t\tDropShipLineItemIndicator as string,\n\t\tWaybillNumber as string,\n\t\tTareWeight as string,\n\t\tNetWeight as string,\n\t\tShipCompleteIndicator as string,\n\t\tReturnTransactionId as string,\n\t\tReturnTransactionLineItemId as string,\n\t\tReturnToStockIndicator as string,\n\t\tReturnToStoreIndicator as string,\n\t\tApprovedByEmployeeId as string,\n\t\tSalesChannelId as string,\n\t\tDistributionChannelId as string,\n\t\tTransactionLineItemTypeId as string,\n\t\tTransactionLineItemStatusId as string,\n\t\tFuelPumpId as string,\n\t\tBuyClassId as string,\n\t\tPromotionId as string,\n\t\tPharmacyId as string,\n\t\tPharmacyTransactionId as string,\n\t\tPromotionOfferId as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> TransactionLineItem\nTransaction, TransactionLineItem union(byName: true)~> Union\nUnion select(mapColumn(\n\t\tTransactionId,\n\t\tTransactionLineItemId,\n\t\tTransactionLineItemStartTimestamp,\n\t\tTransactionLineItemCompletedTimestamp,\n\t\tProductId,\n\t\tItemSku,\n\t\tUniversalProductCode,\n\t\tQuantity,\n\t\tUnitOfMeasureId,\n\t\tPreorderIndicator,\n\t\tProductListPriceAmount,\n\t\tTransactionProductPriceAmount,\n\t\tIsoCurrencyCode,\n\t\tFreeSampleIndicator,\n\t\tTotalTransactionLineItemAmount,\n\t\tTotalTransactionSalesPriceAmount,\n\t\tTransactionLineEntryMethodId,\n\t\tTransactionLineItemScanTimestamp,\n\t\tPosDeviceId,\n\t\tScaleUsedIndicator,\n\t\tScaleMeasuredItemWeight,\n\t\tWeightUomId,\n\t\tScaleQuantity,\n\t\tTransactionLineVolume,\n\t\tVolumeUomId,\n\t\tProductPriceOverrideIndicator,\n\t\tProductPriceAdjustmentAmount,\n\t\tProductPriceAdjustmentPercentage,\n\t\tTotalLineItemAdjustmentAmount,\n\t\tLineItemNote,\n\t\tQuantityBooked,\n\t\tQuantityBilled,\n\t\tQuantityBacklog,\n\t\tAcceptedQuantity,\n\t\tQuantityCancelled,\n\t\tQuantityReturned,\n\t\tBookedTimestamp,\n\t\tBilledTimestamp,\n\t\tCancelledTimestamp,\n\t\tReturnedTimestamp,\n\t\tCommittedShipmentTimestamp,\n\t\tRequestedDeliveryTimestamp,\n\t\tCommittedDeliveryTimestamp,\n\t\tCommittedAvailalbeForPickupTimestamp,\n\t\tPlannedPickTimestamp,\n\t\tActualPickTimestamp,\n\t\tPlannedShipmentTimestamp,\n\t\tActualShipmentTimestamp,\n\t\tPlannedDeliveryTimestamp,\n\t\tActualDeliveryTimestamp,\n\t\tDeliveryConfirmationTimestamp,\n\t\tShipmentChargeAmount,\n\t\tShipmentCostAmount,\n\t\tPickPackageCostAmount,\n\t\tShippingLocationId,\n\t\tShipmentMethodId,\n\t\tDropShipLineItemIndicator,\n\t\tWaybillNumber,\n\t\tTareWeight,\n\t\tNetWeight,\n\t\tShipCompleteIndicator,\n\t\tReturnTransactionId,\n\t\tReturnTransactionLineItemId,\n\t\tReturnToStockIndicator,\n\t\tReturnToStoreIndicator,\n\t\tApprovedByEmployeeId,\n\t\tSalesChannelId,\n\t\tDistributionChannelId,\n\t\tTransactionLineItemTypeId,\n\t\tTransactionLineItemStatusId,\n\t\tFuelPumpId,\n\t\tBuyClassId,\n\t\tPromotionId,\n\t\tPharmacyId,\n\t\tPharmacyTransactionId,\n\t\tPromotionOfferId\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tentity: '/demotarget1/corpus/CustomerTransactionInsight.cdm.json',\n\tformat: 'cdm',\n\tmanifestType: 'manifest',\n\tmanifestName: 'targetmodel2',\n\tfolderPath: 'corpus',\n\tfileSystem: 'demotarget1',\n\tcolumnDelimiter: ',',\n\tcolumnNamesAsHeader: false,\n\tcorpusPath: 'corpus',\n\tcorpusStore: 'adlsgen2',\n\tadlsgen2_fileSystem: 'sourcedata',\n\ttruncate: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> UnifiedDataLake"
		}
	}
}