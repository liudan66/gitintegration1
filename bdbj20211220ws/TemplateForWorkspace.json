{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "bdbj20211220ws"
		},
		"AzureBlobStorage_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage'"
		},
		"AzureBlobStorage1220_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage1220'"
		},
		"AzureDataExplorer_servicePrincipalKey": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalKey' of 'AzureDataExplorer'"
		},
		"AzureDataExplorer1220_servicePrincipalKey": {
			"type": "secureString",
			"metadata": "Secure string for 'servicePrincipalKey' of 'AzureDataExplorer1220'"
		},
		"AzureDataLakeStorage_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage'"
		},
		"AzureDataLakeStorage1220_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1220'"
		},
		"CosmosDb_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDb'"
		},
		"CosmosDb1220_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDb1220'"
		},
		"CosmosDbMongoDbApi_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDbMongoDbApi'"
		},
		"CosmosDbMongoDbApi1220_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDbMongoDbApi1220'"
		},
		"bdbj20211220ws-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'bdbj20211220ws-WorkspaceDefaultSqlServer'"
		},
		"AzureDataExplorer_properties_typeProperties_tenant": {
			"type": "string",
			"defaultValue": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
		},
		"AzureDataExplorer_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "8f6caa4c-31d9-4562-8084-bcbf13bb0068"
		},
		"AzureDataExplorer_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "bdbjkustodatabaseqingtest"
		},
		"AzureDataExplorer1220_properties_typeProperties_tenant": {
			"type": "string",
			"defaultValue": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
		},
		"AzureDataExplorer1220_properties_typeProperties_servicePrincipalId": {
			"type": "string",
			"defaultValue": "8f6caa4c-31d9-4562-8084-bcbf13bb0068"
		},
		"AzureDataExplorer1220_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "bdbjkustodatabaseqingtest"
		},
		"AzureDataLakeStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://bdbjgen2qingtest.dfs.core.windows.net"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://lanjlgen2.dfs.core.windows.net"
		},
		"AzureDataLakeStorage1220_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://bdbjgen2qingtest.dfs.core.windows.net"
		},
		"AzureKeyVault1_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://hditoolingkeyvault.vault.azure.net/"
		},
		"CosmosDbMongoDbApi_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "Test0510"
		},
		"CosmosDbMongoDbApi1220_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "mongodbapidatabaseqingtest"
		},
		"bdbj20211220ws-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://honghaigen2.dfs.core.windows.net"
		},
		"bing-covid-19-data_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'bing-covid-19-data'"
		},
		"nyc_tlc_fhv_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'nyc_tlc_fhv'"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/chen')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/zhao')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/zhao1')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/zhao2')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Pipeline 1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Notebook 3",
						"type": "SynapseNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "Notebook 3",
								"type": "NotebookReference"
							},
							"snapshot": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "New folder"
				},
				"annotations": [],
				"lastPublishTime": "2021-12-20T07:12:07Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/notebooks/Notebook 3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapse_job_definition_pipeline1220')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "20211220 Test",
				"activities": [
					{
						"name": "Spark job definition1",
						"type": "SparkJob",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"sparkJob": {
								"referenceName": "Spark job definition 1220",
								"type": "SparkJobDefinitionReference"
							},
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					},
					{
						"name": "Execute Pipeline1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Spark job definition1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "synapse_notebook_pipeline1220",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [
					"test purpose"
				],
				"lastPublishTime": "2021-12-20T07:01:13Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/sparkJobDefinitions/Spark job definition 1220')]",
				"[concat(variables('workspaceId'), '/pipelines/synapse_notebook_pipeline1220')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapse_job_definition_pipeline_1222hou')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Spark job definition1",
						"type": "SparkJob",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"sparkJob": {
								"referenceName": "Spark job definition 1221",
								"type": "SparkJobDefinitionReference"
							},
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					},
					{
						"name": "Execute Pipeline1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Spark job definition1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "synapse_notebook_pipeline_1222hou_copy1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2021-12-22T06:13:48Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/sparkJobDefinitions/Spark job definition 1221')]",
				"[concat(variables('workspaceId'), '/pipelines/synapse_notebook_pipeline_1222hou_copy1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapse_notebook_pipeline1220')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 30
						}
					},
					{
						"name": "Notebook1",
						"type": "SynapseNotebook",
						"dependsOn": [
							{
								"activity": "Wait1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "CopyDataBetweenSparkTables1220",
								"type": "NotebookReference"
							},
							"parameters": {
								"pipeline_name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "string"
								},
								"tag": {
									"value": "hello_world",
									"type": "string"
								}
							},
							"snapshot": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2021-12-20T06:11:32Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/notebooks/CopyDataBetweenSparkTables1220')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/synapse_notebook_pipeline_1222hou_copy1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 30
						}
					},
					{
						"name": "Notebook1",
						"type": "SynapseNotebook",
						"dependsOn": [
							{
								"activity": "Wait1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "CopyDataBetweenSparkTables1222hou",
								"type": "NotebookReference"
							},
							"parameters": {
								"pipeline_name": {
									"value": {
										"value": "@pipeline().Pipeline",
										"type": "Expression"
									},
									"type": "string"
								},
								"tag": {
									"value": "hello_world",
									"type": "string"
								}
							},
							"snapshot": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "New folder"
				},
				"annotations": [],
				"lastPublishTime": "2021-12-22T06:27:55Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/notebooks/CopyDataBetweenSparkTables1222hou')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataset1220')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Avro",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "episodes.avro",
						"fileSystem": "container02"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureDataLakeStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Input')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "bdbj20211220ws-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "fact_sale.parquet",
						"fileSystem": "default"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "SaleKey",
						"type": "INT32"
					},
					{
						"name": "CityKey",
						"type": "INT32"
					},
					{
						"name": "CustomerKey",
						"type": "INT32"
					},
					{
						"name": "BillToCustomerKey",
						"type": "INT32"
					},
					{
						"name": "StockItemKey",
						"type": "INT32"
					},
					{
						"name": "InvoiceDateKey",
						"type": "INT96"
					},
					{
						"name": "DeliveryDateKey",
						"type": "INT96"
					},
					{
						"name": "SalespersonKey",
						"type": "INT32"
					},
					{
						"name": "WWIInvoicID",
						"type": "INT32"
					},
					{
						"name": "Description",
						"type": "UTF8"
					},
					{
						"name": "Package",
						"type": "UTF8"
					},
					{
						"name": "Quantity",
						"type": "INT32"
					},
					{
						"name": "UnitPrice",
						"type": "DOUBLE"
					},
					{
						"name": "TaxRate",
						"type": "DOUBLE"
					},
					{
						"name": "TotalExcludingTax",
						"type": "DOUBLE"
					},
					{
						"name": "TaxAmount",
						"type": "DOUBLE"
					},
					{
						"name": "Profit",
						"type": "DOUBLE"
					},
					{
						"name": "TotalIncludingTax",
						"type": "DOUBLE"
					},
					{
						"name": "TotalDryItems",
						"type": "INT32"
					},
					{
						"name": "TotalChillerItems",
						"type": "INT32"
					},
					{
						"name": "LineageKey",
						"type": "INT32"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/bdbj20211220ws-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Output')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "bdbj20211220ws-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileSystem": "default"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "DateID",
						"type": "INT32"
					},
					{
						"name": "MedallionID",
						"type": "INT32"
					},
					{
						"name": "HackneyLicenseID",
						"type": "INT32"
					},
					{
						"name": "PickupTimeID",
						"type": "INT32"
					},
					{
						"name": "DropoffTimeID",
						"type": "INT32"
					},
					{
						"name": "PickupGeographyID",
						"type": "INT32"
					},
					{
						"name": "DropoffGeographyID",
						"type": "INT32"
					},
					{
						"name": "PickupLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLatLong",
						"type": "UTF8"
					},
					{
						"name": "DropoffLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLatLong",
						"type": "UTF8"
					},
					{
						"name": "PassengerCount",
						"type": "INT32"
					},
					{
						"name": "TripDurationSeconds",
						"type": "INT32"
					},
					{
						"name": "TripDistanceMiles",
						"type": "DOUBLE"
					},
					{
						"name": "PaymentType",
						"type": "UTF8"
					},
					{
						"name": "FareAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "SurchargeAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TaxAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TipAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TollsAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TotalAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/bdbj20211220ws-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureBlobStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"1220"
				],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureBlobStorage1220')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage1220_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataExplorer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"20211220"
				],
				"type": "AzureDataExplorer",
				"typeProperties": {
					"endpoint": "https://bdbjkustoqingtest.eastus.kusto.windows.net",
					"tenant": "[parameters('AzureDataExplorer_properties_typeProperties_tenant')]",
					"servicePrincipalId": "[parameters('AzureDataExplorer_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataExplorer_servicePrincipalKey')]"
					},
					"database": "[parameters('AzureDataExplorer_properties_typeProperties_database')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataExplorer1220')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureDataExplorer",
				"typeProperties": {
					"endpoint": "https://bdbjkustoqingtest.eastus.kusto.windows.net",
					"tenant": "[parameters('AzureDataExplorer1220_properties_typeProperties_tenant')]",
					"servicePrincipalId": "[parameters('AzureDataExplorer1220_properties_typeProperties_servicePrincipalId')]",
					"servicePrincipalKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataExplorer1220_servicePrincipalKey')]"
					},
					"database": "[parameters('AzureDataExplorer1220_properties_typeProperties_database')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"20211220test"
				],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "IntegrationRuntime1220",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntime1220')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
					"credential": {
						"referenceName": "Credential1",
						"type": "CredentialReference"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/credentials/Credential1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage1220')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1220_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage1220_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureKeyVault1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AzureKeyVault1_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDb')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"Test"
				],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDb_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDb1220')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"TEST"
				],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDb1220_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDbMongoDbApi')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"test"
				],
				"type": "CosmosDbMongoDbApi",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDbMongoDbApi_connectionString')]",
					"database": "[parameters('CosmosDbMongoDbApi_properties_typeProperties_database')]",
					"isServerVersionAbove32": true
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDbMongoDbApi1220')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "CosmosDbMongoDbApi",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDbMongoDbApi1220_connectionString')]",
					"database": "[parameters('CosmosDbMongoDbApi1220_properties_typeProperties_database')]",
					"isServerVersionAbove32": false
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspaceYanjunTest')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "this is a test description by yanjun gao",
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "0c1b7efd-fddf-44a1-bc88-ddbb9abf8a77",
					"tenantID": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspaceYanjunTest2')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "this is a test description by yanjun gao",
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "0c1b7efd-fddf-44a1-bc88-ddbb9abf8a77",
					"tenantID": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspaceYanjunTest3')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "this is a test description by yanjun gao",
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "0c1b7efd-fddf-44a1-bc88-ddbb9abf8a77",
					"tenantID": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspaceYanjunTest4')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "this is a test description by yanjun gao",
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "0c1b7efd-fddf-44a1-bc88-ddbb9abf8a77",
					"tenantID": "72bfe100-a448-4f25-af39-5b36c7bb62ef"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/bdbj20211220ws-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('bdbj20211220ws-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/bdbj20211220ws-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('bdbj20211220ws-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/bing-covid-19-data')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('bing-covid-19-data_sasUri')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/nyc_tlc_fhv')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('nyc_tlc_fhv_sasUri')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger 1220')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [
					"TestPurpose"
				],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "synapse_job_definition_pipeline1220",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 20,
						"startTime": "2021-12-20T06:12:00",
						"endTime": "2021-12-20T19:12:00",
						"timeZone": "China Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/synapse_job_definition_pipeline1220')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger 1221')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Pipeline 1",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 30,
						"startTime": "2021-12-20T07:05:00",
						"endTime": "2021-12-20T19:05:00",
						"timeZone": "China Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Pipeline 1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime1220')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 240,
							"cleanup": false
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime1221')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 240,
							"cleanup": false
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntime1222')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0,
							"cleanup": false
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataflow1')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Input",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Output",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "Sort1"
						}
					],
					"script": "source(output(\n\t\tSaleKey as integer,\n\t\tCityKey as integer,\n\t\tCustomerKey as integer,\n\t\tBillToCustomerKey as integer,\n\t\tStockItemKey as integer,\n\t\tInvoiceDateKey as timestamp,\n\t\tDeliveryDateKey as timestamp,\n\t\tSalespersonKey as integer,\n\t\tWWIInvoicID as integer,\n\t\tDescription as string,\n\t\tPackage as string,\n\t\tQuantity as integer,\n\t\tUnitPrice as double,\n\t\tTaxRate as double,\n\t\tTotalExcludingTax as double,\n\t\tTaxAmount as double,\n\t\tProfit as double,\n\t\tTotalIncludingTax as double,\n\t\tTotalDryItems as integer,\n\t\tTotalChillerItems as integer,\n\t\tLineageKey as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet') ~> source1\nsource1 sort(asc(SaleKey, true),\n\tcaseInsensitive: true) ~> Sort1\nSort1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tDateID as integer,\n\t\tMedallionID as integer,\n\t\tHackneyLicenseID as integer,\n\t\tPickupTimeID as integer,\n\t\tDropoffTimeID as integer,\n\t\tPickupGeographyID as integer,\n\t\tDropoffGeographyID as integer,\n\t\tPickupLatitude as double,\n\t\tPickupLongitude as double,\n\t\tPickupLatLong as string,\n\t\tDropoffLatitude as double,\n\t\tDropoffLongitude as double,\n\t\tDropoffLatLong as string,\n\t\tPassengerCount as integer,\n\t\tTripDurationSeconds as integer,\n\t\tTripDistanceMiles as double,\n\t\tPaymentType as string,\n\t\tFareAmount as decimal(19,4),\n\t\tSurchargeAmount as decimal(19,4),\n\t\tTaxAmount as decimal(19,4),\n\t\tTipAmount as decimal(19,4),\n\t\tTollsAmount as decimal(19,4),\n\t\tTotalAmount as decimal(19,4)\n\t),\n\tformat: 'parquet',\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Input')]",
				"[concat(variables('workspaceId'), '/datasets/Output')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Credential1')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {
					"resourceId": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.ManagedIdentity/userAssignedIdentities/lanjliidentity"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/lanjun')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ServicePrincipal",
				"typeProperties": {
					"tenant": "72bfe100-a448-4f25-af39-5b36c7bb62ef",
					"servicePrincipalId": "ca533369-ab94-46d4-85d9-bdb2ffdef08a",
					"servicePrincipalKey": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "hditoolingsercet"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Analyze Azure Open Datasets using serverless SQL pool')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "/*\nFull tutorial available on: https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/tutorial-data-analyst\nIn this tutorial, you learn how to perform exploratory data analysis by combining different Azure Open Datasets using serverless SQL pool and then visualizing the results in Azure Synapse Studio.\n\nIn particular, you analyze the New York City (NYC) Taxi dataset that includes:\n\n - Pickup and drop-off dates and times.\n - Pick up and drop-off locations.\n - Trip distances.\n - Itemized fares.\n - Rate types.\n - Payment types.\n - Driver-reported passenger counts.*/\n\n\n/*\n * * * * * * * * * * * * * * * *\n * Automatic schema inference  *\n * * * * * * * * * * * * * * * *\n\nSince data is stored in the Parquet file format, automatic schema inference is available. You can easily query the data without listing the data types of all columns in the files. You also can use the virtual column mechanism and the filepath function to filter out a certain subset of files.\n\nLet's first get familiar with the NYC Taxi data by running the following query. */\n\nSELECT TOP 100 * FROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc];\n\n\n/* Similarly, you can query the Public Holidays dataset by using the following query. */\n\nSELECT TOP 100 * FROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/holidaydatacontainer/Processed/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [holidays];\n\n/* Lastly, you can also query the Weather Data dataset by using the following query. */\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/isdweatherdatacontainer/ISDWeather/year=*/month=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [weather];\n\n/* You can learn more about the meaning of the individual columns in the descriptions\nof the NYC Taxi, Public Holidays, and Weather Data datasets on the Azure Opendatasets page. */\n\n\n/*\n * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Time series, seasonality, and outlier analysis  *\n * * * * * * * * * * * * * * * * * * * * * * * * * *\nYou can easily summarize the yearly number of taxi rides by using the following query. */\n\nSELECT\n    YEAR(tpepPickupDateTime) AS current_year,\n    COUNT(*) AS rides_per_year\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc]\nWHERE nyc.filepath(1) >= '2009' AND nyc.filepath(1) <= '2019'\nGROUP BY YEAR(tpepPickupDateTime)\nORDER BY 1 ASC;\n\n/* The data can be visualized in Synapse Studio by switching from the Table to the Chart view.\nYou can choose among different chart types, such as Area, Bar, Column, Line, Pie, and Scatter.\nIn this case, plot the Column chart with the Category column set to current_year.\n\nFrom this visualization, a trend of a decreasing number of rides over years can be clearly seen.\nPresumably, this decrease is due to the recent increased popularity of ride-sharing companies.\n*/\n\n/* Next, let's focus the analysis on a single year, for example, 2016.\nThe following query returns the daily number of rides during that year. */\n\nSELECT\n    CAST([tpepPickupDateTime] AS DATE) AS [current_day],\n    COUNT(*) as rides_per_day\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc]\nWHERE nyc.filepath(1) = '2016'\nGROUP BY CAST([tpepPickupDateTime] AS DATE)\nORDER BY 1 ASC;\n\n/* Again, you can easily visualize data by plotting the Column chart with\nthe Category column set to current_day and the Legend (series) column set to rides_per_day. */\n\n/* From the plot chart, you can see that there's a weekly pattern, with Saturdays as the peak day.\nDuring summer months, there are fewer taxi rides because of vacations.\nThere are also some significant drops in the number of taxi rides without a clear pattern of when and why they occur. */\n\n/* Next, let's see if the drops correlate with public holidays by joining the NYC Taxi rides dataset with the Public Holidays dataset. */\n\nWITH taxi_rides AS\n(\n    SELECT\n        CAST([tpepPickupDateTime] AS DATE) AS [current_day],\n        COUNT(*) as rides_per_day\n    FROM\n        OPENROWSET(\n            BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n            FORMAT='PARQUET'\n        ) AS [nyc]\n    WHERE nyc.filepath(1) = '2016'\n    GROUP BY CAST([tpepPickupDateTime] AS DATE)\n),\npublic_holidays AS\n(\n    SELECT\n        holidayname as holiday,\n        date\n    FROM\n        OPENROWSET(\n            BULK 'https://azureopendatastorage.blob.core.windows.net/holidaydatacontainer/Processed/*.parquet',\n            FORMAT='PARQUET'\n        ) AS [holidays]\n    WHERE countryorregion = 'United States' AND YEAR(date) = 2016\n)\nSELECT\n*\nFROM taxi_rides t\nLEFT OUTER JOIN public_holidays p on t.current_day = p.date\nORDER BY current_day ASC;\n\n/* This time, we want to highlight the number of taxi rides during public holidays.\nFor that purpose, we choose none for the Category column and rides_per_day and holiday as the Legend (series) columns. */\n\n/* From the plot chart, you can see that during public holidays the number of taxi rides is lower.\nThere's still one unexplained large drop on January 23. Let's check the weather in NYC on that day by querying the Weather Data dataset. */\n\nSELECT\n    AVG(windspeed) AS avg_windspeed,\n    MIN(windspeed) AS min_windspeed,\n    MAX(windspeed) AS max_windspeed,\n    AVG(temperature) AS avg_temperature,\n    MIN(temperature) AS min_temperature,\n    MAX(temperature) AS max_temperature,\n    AVG(sealvlpressure) AS avg_sealvlpressure,\n    MIN(sealvlpressure) AS min_sealvlpressure,\n    MAX(sealvlpressure) AS max_sealvlpressure,\n    AVG(precipdepth) AS avg_precipdepth,\n    MIN(precipdepth) AS min_precipdepth,\n    MAX(precipdepth) AS max_precipdepth,\n    AVG(snowdepth) AS avg_snowdepth,\n    MIN(snowdepth) AS min_snowdepth,\n    MAX(snowdepth) AS max_snowdepth\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/isdweatherdatacontainer/ISDWeather/year=*/month=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [weather]\nWHERE countryorregion = 'US' AND CAST([datetime] AS DATE) = '2016-01-23' AND stationname = 'JOHN F KENNEDY INTERNATIONAL AIRPORT';\n\n/* The results of the query indicate that the drop in the number of taxi rides occurred because:\n\n1. There was a blizzard on that day in NYC with heavy snow (~30 cm).\n2. It was cold (temperature was below zero degrees Celsius).\n3. It was windy (~10 m/s). */\n\n\n/* This tutorial has shown how a data analyst can quickly perform exploratory data analysis, easily combine different\ndatasets by using serverless SQL pool, and visualize the results by using Azure Synapse Studio. */\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "database1220",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Blob - Explorer -Select a folder - Right click to check context menu - new sql script - select top 100 rows')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- This is auto-generated code\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bdbjblobstorageqingtest.blob.core.windows.net/container02/New folder 1220/New folder 122002/**',\n        FORMAT = 'PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Cosmos DB- analytical store enabled -metadata - new sql script - select top 100 rows')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "IF (EXISTS(SELECT * FROM sys.credentials WHERE name = 'bdbjsqlapiqingtest'))\nDROP CREDENTIAL [bdbjsqlapiqingtest]\nGO\n\nCREATE CREDENTIAL [bdbjsqlapiqingtest]\nWITH IDENTITY = 'SHARED ACCESS SIGNATURE',\nSECRET = 'pzQibicjdf49Aoacwj8vDRytwFQTXfKnShLfavYVqfUyaiWy9P9uvi6Zo1TR7M396HOgUCNn4QS8MPJDnzztUA=='\nGO\n\nSELECT TOP 100 *\nFROM OPENROWSET(â€‹PROVIDER = 'CosmosDB',\n                CONNECTION = 'Account=bdbjsqlapiqingtest;Database=sqlapidatabaseqingtest',\n                OBJECT = 'container02',\n                SERVER_CREDENTIAL = 'bdbjsqlapiqingtest'\n) AS [container02]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Create external table')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "IF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat')\n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat]\n\tWITH ( FORMAT_TYPE = PARQUET)\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'nyctlc_azureopendatastorage_blob_core_windows_net')\n\tCREATE EXTERNAL DATA SOURCE [nyctlc_azureopendatastorage_blob_core_windows_net]\n\tWITH (\n\t\tLOCATION = 'wasbs://nyctlc@azureopendatastorage.blob.core.windows.net',\n\t\tTYPE     = HADOOP\n\t)\nGO\n\nCREATE EXTERNAL TABLE nyc_tlc_yellow_trip_ext (\n\t[vendorID] varchar(8000),\n\t[tpepPickupDateTime] datetime2(7),\n\t[tpepDropoffDateTime] datetime2(7),\n\t[passengerCount] int,\n\t[tripDistance] float,\n\t[puLocationId] varchar(8000),\n\t[doLocationId] varchar(8000),\n\t[startLon] float,\n\t[startLat] float,\n\t[endLon] float,\n\t[endLat] float,\n\t[rateCodeId] int,\n\t[storeAndFwdFlag] varchar(8000),\n\t[paymentType] varchar(8000),\n\t[fareAmount] float,\n\t[extra] float,\n\t[mtaTax] float,\n\t[improvementSurcharge] varchar(8000),\n\t[tipAmount] float,\n\t[tollsAmount] float,\n\t[totalAmount] float\n\t)\n\tWITH (\n    LOCATION = 'yellow/puYear=2014/puMonth=3/',\n    -- LOCATION = 'yellow'\n\tDATA_SOURCE = [nyctlc_azureopendatastorage_blob_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat],\n\tREJECT_TYPE = VALUE,\n\tREJECT_VALUE = 0\n\t)\nGO\n\nSELECT TOP 100 * FROM nyc_tlc_yellow_trip_ext\nGO\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "SampleSQL",
						"poolName": "SampleSQL"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Interview')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP 100 * FROM fhv\nGO\n--å‡ºç§Ÿæ±½è½¦ï¼ˆâ€œFHVâ€ï¼‰è¡Œç¨‹è®°å½•åŒ…æ‹¬æ±½è½¦ç‰Œç…§ã€ä¸Šè½¦æ—¥æœŸã€ä¸‹è½¦æ—¶é—´å’Œå‡ºç§Ÿè½¦åŒºåŸŸä½ç½®IDçš„å­—æ®µ\n--ä¸»æ„ï¼šè€ƒè™‘æœ‰æ•°æ®é‡å¤\n-- # 1.æ±‚æ¯å¤©å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡\n\n-- # 2.æ±‚æ¯æœˆï¼ˆä»¥æ¯æœˆä¸€å·ä¸ºæ ‡è¯†ï¼‰è½¦è¾†æ•°é‡ï¼Œæ·»åŠ ä¸€åˆ—æ˜¯å¦è¶…è¿‡500è¾†è½¦\n\n-- # 3.æ±‚æ¯å‘¨ï¼ˆä»¥å‘¨æ—¥ä¸ºæ ‡è¯†ï¼‰å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡ï¼ŒæŒ‰æ—¶é—´é€†åº\n\n-- # 4. æ±‚2019å¹´æ¯ä¸ªæœˆçš„å¹³å‡æ¯è¾†è½¦çš„å‡ºè½¦çŽ‡\n\n-- # 5. è¿žç»­å‡ºè½¦3ä¸ªæœˆçš„è½¦è¾†\n\n-- # 6. è¿è¥è¡Œé©¶æ—¶é—´æœ€é•¿çš„çš„å‰100è¾†è½¦,å¹¶æ˜¾ç¤ºè¡Œé©¶å°æ—¶æ•°\n\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "database1220",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Interview2')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT TOP 100 * FROM fhv\nGO\n--å‡ºç§Ÿæ±½è½¦ï¼ˆâ€œFHVâ€ï¼‰è¡Œç¨‹è®°å½•åŒ…æ‹¬æ±½è½¦ç‰Œç…§ã€ä¸Šè½¦æ—¥æœŸã€ä¸‹è½¦æ—¶é—´å’Œå‡ºç§Ÿè½¦åŒºåŸŸä½ç½®IDçš„å­—æ®µ\n--ä¸»æ„ï¼šè€ƒè™‘æœ‰æ•°æ®é‡å¤\n-- # 1.æ±‚æ¯å¤©å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡\n\n-- # 2.æ±‚æ¯æœˆï¼ˆä»¥æ¯æœˆä¸€å·ä¸ºæ ‡è¯†ï¼‰è½¦è¾†æ•°é‡ï¼Œæ·»åŠ ä¸€åˆ—æ˜¯å¦è¶…è¿‡500è¾†è½¦\n\n-- # 3.æ±‚æ¯å‘¨ï¼ˆä»¥å‘¨æ—¥ä¸ºæ ‡è¯†ï¼‰å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡ï¼ŒæŒ‰æ—¶é—´é€†åº\n\n-- # 4. æ±‚2019å¹´æ¯ä¸ªæœˆçš„å¹³å‡æ¯è¾†è½¦çš„å‡ºè½¦çŽ‡\n\n-- # 5. è¿žç»­å‡ºè½¦3ä¸ªæœˆçš„è½¦è¾†\n\n-- # 6. è¿è¥è¡Œé©¶æ—¶é—´æœ€é•¿çš„çš„å‰100è¾†è½¦,å¹¶æ˜¾ç¤ºè¡Œé©¶å°æ—¶æ•°\n\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "database1220",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 1')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- This is auto-generated code\nSELECT\n    TOPâ€¯100â€¯*\nFROM\n    OPENROWSET(\n        BULKâ€¯â€¯â€¯â€¯â€¯'https://pandemicdatalake.blob.core.windows.net/public/curated/covid-19/bing_covid-19_data/latest/bing_covid-19_data.parquet',\n        FORMATâ€¯=â€¯'parquet'\n    ) AS [result];",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "master",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 2')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "IF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat] \n\tWITH ( FORMAT_TYPE = PARQUET)\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'public_pandemicdatalake_blob_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [public_pandemicdatalake_blob_core_windows_net] \n\tWITH (\n\t\tLOCATION   = 'https://pandemicdatalake.blob.core.windows.net/public', \n\t)\nGo\n\nCREATE EXTERNAL TABLE [Test1220] (\n\t[id] int,\n\t[updated] date,\n\t[confirmed] int,\n\t[confirmed_change] int,\n\t[deaths] int,\n\t[deaths_change] smallint,\n\t[recovered] int,\n\t[recovered_change] int,\n\t[latitude] float,\n\t[longitude] float,\n\t[iso2] varchar(8000),\n\t[iso3] varchar(8000),\n\t[country_region] varchar(8000),\n\t[admin_region_1] varchar(8000),\n\t[iso_subdivision] varchar(8000),\n\t[admin_region_2] varchar(8000),\n\t[load_time] datetime2(7)\n\t)\n\tWITH (\n\tLOCATION = 'curated/covid-19/bing_covid-19_data/latest/bing_covid-19_data.parquet',\n\tDATA_SOURCE = [public_pandemicdatalake_blob_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat]\n\t)\nGO\n\nSELECT TOP 100 * FROM [Test1220]\nGO\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "database1220",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 3')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE TABLE [dbo].[TABLE2]\n(\n    Id INT NOT NULL,\n    created_time DATETIME NOT NULL\n)\n--add msg column\nALTER TABLE [dbo].[TABLE2]\n    ADD msg varchar(255)\n\n--insert some test data\nDECLARE @i int = 1;\nDECLARE @alphabet varchar(36) = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\nWHILE @i <= 500\nBegin\nDECLARE @stamp datetime = CURRENT_TIMESTAMP;\nDECLARE @msg varchar(36)=\nsubstring(@alphabet, convert(int, rand()*36), 1) +\nsubstring(@alphabet, convert(int, rand()*36), 1) +\nsubstring(@alphabet, convert(int, rand()*36), 1) +\nsubstring(@alphabet, convert(int, rand()*36), 1) +\nsubstring(@alphabet, convert(int, rand()*36), 1);\nINSERT INTO [dbo].[TABLE2] VALUES(@i,@stamp,@msg);\nSET @i+=1;\nEND\n\n--select\nSELECT * FROM TABLE2 ORDER BY [TABLE2].[Id] \nSELECT Id,msg FROM TABLE2 WHERE Id=10 OR Id=20\nSELECT * FROM TABLE2 WHERE Id>=200 ORDER BY Id\nSELECT * FROM TABLE2 WHERE Id>=10 AND Id<240 ORDER BY Id\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "testsqlpool",
						"poolName": "testsqlpool"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 4')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "IF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat] \n\tWITH ( FORMAT_TYPE = PARQUET)\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'default_honghaigen2_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [default_honghaigen2_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'abfss://default@honghaigen2.dfs.core.windows.net' \n\t)\nGO\n--drop EXTERNAL TABLE fhv\n \nCREATE EXTERNAL TABLE fhv (\n\t[dispatchBaseNum] nvarchar(4000),\n\t[pickupDateTime] datetime2(7),\n\t[dropOffDateTime] datetime2(7),\n\t[puLocationId] nvarchar(4000),\n\t[doLocationId] nvarchar(4000),\n\t[srFlag] nvarchar(4000),\n\t[puYear] int,\n\t[puMonth] int\n\t)\n\tWITH (\n\tLOCATION = 'Guest/fhv/*.parquet',\n\tDATA_SOURCE = [default_honghaigen2_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat]\n\t)\nGO\n\n\nSELECT TOP 100 * FROM dbo.fhv\nGO",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "database1220",
						"poolName": "Built-in"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/create table')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE TABLE [dbo].[person]\n(\n id int NOT NULL,\nname char(10) not null,\n age int not null\n)\ngo\n\nInsert into dbo.person values(0,'a',18) go\nInsert into dbo.person values(1,'b',29) go\nInsert into dbo.person values(2,'c',30) go\nInsert into dbo.person values(3,'d',11) go\nInsert into dbo.person values(4,'e',22) go\nInsert into dbo.person values(5,'f',33) go\nInsert into dbo.person values(6,'g',14) go\nInsert into dbo.person values(7,'h',25) go\nInsert into dbo.person values(8,'i',36) go\nInsert into dbo.person values(9,'j',17) go\nInsert into dbo.person values(10,'k',28) go\nInsert into dbo.person values(11,'l',39) go\nInsert into dbo.person values(12,'m',18) go\nInsert into dbo.person values(13,'n',29) go\nInsert into dbo.person values(14,'o',30) go\nInsert into dbo.person values(15,'p',14) go\nInsert into dbo.person values(16,'q',26) go\nInsert into dbo.person values(17,'r',32) go\nInsert into dbo.person values(18,'s',14) go\nInsert into dbo.person values(19,'t',20) go\nInsert into dbo.person values(20,'u',30) go\nInsert into dbo.person values(21,'v',16) go\nInsert into dbo.person values(22,'w',28) go\nInsert into dbo.person values(23,'x',34) go\nInsert into dbo.person values(24,'y',22) go\nInsert into dbo.person values(25,'z',28) go\n\nSELECT TOP (100) [id]\n,[name]\n,[age]\n FROM [dbo].[person]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "SampleSQL",
						"poolName": "SampleSQL"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/testbiq')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "CREATE table testpowerbi\n(id int,name nvarchar(20),quarter int,number int)\ninsert into testpowerbi values(1,N'è‹¹æžœ',1,1000)\ninsert into testpowerbi values(1,N'è‹¹æžœ',2,2000)\ninsert into testpowerbi values(1,N'è‹¹æžœ',3,4000)\ninsert into testpowerbi values(1,N'è‹¹æžœ',4,5000)\ninsert into testpowerbi values(2,N'æ¢¨å­',1,3000)\ninsert into testpowerbi values(2,N'æ¢¨å­',2,3500)\ninsert into testpowerbi values(2,N'æ¢¨å­',3,4200)\ninsert into testpowerbi values(2,N'æ¢¨å­',4,5500)\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"databaseName": "SampleSQL",
						"poolName": "SampleSQL"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KQL script 1')]",
			"type": "Microsoft.Synapse/workspaces/kqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "| where timestamp > ago(7d)\n| where name == \"PBI.Navigation.RouteChange\"\n| extend toPath = tostring(customDimensions.toPath)\n| where toPath has \"manageembed\" \n| summarize count() by toPath\n",
					"metadata": {
						"language": "kql"
					}
				},
				"type": "KqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Blob - Explorer - Select a file - Top menu - New notebook - load to Dataframe - json')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "72d70a4e-640b-4ce6-9598-5929e1d0b692"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1",
						"state": {
							"9bfb94c6-9b2a-4cc0-98be-ce5437670300": {
								"type": "Synapse.DataFrame",
								"sync_state": {
									"table": {
										"rows": [
											{
												"0": [
													[
														"7216441",
														"64853",
														"302",
														"202",
														"192",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"242",
														"DBA joke mug - two types of DBAs (White)",
														"Each",
														"2",
														"13",
														"15",
														"26",
														"3.9",
														"17",
														"29.9",
														"2",
														"0",
														"11"
													],
													[
														"7230122",
														"56883",
														"0",
														"0",
														"188",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"1527",
														"Developer joke mug - that's a hardware problem (White)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7213683",
														"41081",
														"380",
														"202",
														"96",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"263",
														"Ogre battery-powered slippers (Green) L",
														"Each",
														"4",
														"32",
														"15",
														"128",
														"19.2",
														"96",
														"147.2",
														"4",
														"0",
														"11"
													],
													[
														"7214884",
														"38886",
														"0",
														"0",
														"150",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"262",
														"Ride on toy sedan car (Green) 1/12 scale",
														"Each",
														"7",
														"230",
														"15",
														"1610",
														"241.5",
														"595",
														"1851.5",
														"7",
														"0",
														"11"
													],
													[
														"7236965",
														"66773",
														"299",
														"202",
														"180",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"482",
														"Developer joke mug - (hip, hip, array) (White)",
														"Each",
														"1",
														"13",
														"15",
														"13",
														"1.95",
														"8.5",
														"14.95",
														"1",
														"0",
														"11"
													],
													[
														"7315206",
														"46801",
														"0",
														"0",
														"83",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"12",
														"444",
														"Animal with big feet slippers (Brown) XL",
														"Each",
														"10",
														"32",
														"15",
														"320",
														"48",
														"235",
														"368",
														"10",
														"0",
														"11"
													],
													[
														"7205287",
														"65982",
														"0",
														"0",
														"124",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"186",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (Black) XXL\"",
														"Each",
														"24",
														"18",
														"15",
														"432",
														"64.8",
														"252",
														"496.8",
														"24",
														"0",
														"11"
													],
													[
														"7317068",
														"46564",
														"181",
														"1",
														"132",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"25",
														"783",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (White) 7XL\"",
														"Each",
														"36",
														"18",
														"15",
														"648",
														"97.2",
														"342",
														"745.2",
														"36",
														"0",
														"11"
													],
													[
														"7211349",
														"41981",
														"0",
														"0",
														"185",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"506",
														"Developer joke mug - fun was unexpected at this time (Black)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7233310",
														"53360",
														"0",
														"0",
														"174",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"47",
														"2834",
														"Developer joke mug - a foo walks into a bar (White)",
														"Each",
														"5",
														"13",
														"15",
														"65",
														"9.75",
														"42.5",
														"74.75",
														"5",
														"0",
														"11"
													],
													[
														"7203731",
														"64565",
														"0",
														"0",
														"45",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"589",
														"Bubblewrap dispenser (Blue) 1.5m",
														"Each",
														"3",
														"240",
														"15",
														"720",
														"108",
														"390",
														"828",
														"3",
														"0",
														"11"
													],
													[
														"7210932",
														"51708",
														"0",
														"0",
														"177",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"126",
														"Developer joke mug - understanding recursion requires understanding recursion (Black)",
														"Each",
														"10",
														"13",
														"15",
														"130",
														"19.5",
														"85",
														"149.5",
														"10",
														"0",
														"11"
													],
													[
														"7312993",
														"52862",
														"355",
														"202",
														"118",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"12",
														"564",
														"Alien officer hoodie (Black) XL",
														"Each",
														"8",
														"35",
														"15",
														"280",
														"42",
														"144",
														"322",
														"8",
														"0",
														"11"
													],
													[
														"7304954",
														"50119",
														"0",
														"0",
														"215",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"21",
														"34",
														"USB food flash drive - hamburger",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"20",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7217175",
														"48519",
														"46",
														"1",
														"211",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"23",
														"994",
														"USB food flash drive - banana",
														"Each",
														"10",
														"32",
														"15",
														"320",
														"48",
														"200",
														"368",
														"10",
														"0",
														"11"
													],
													[
														"7213516",
														"68806",
														"0",
														"0",
														"94",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"643",
														"Plush shark slippers (Gray) S",
														"Each",
														"8",
														"32",
														"15",
														"256",
														"38.4",
														"192",
														"294.4",
														"8",
														"0",
														"11"
													],
													[
														"7211597",
														"47757",
														"0",
														"0",
														"181",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"35",
														"1245",
														"Developer joke mug - inheritance is the OO way to become wealthy (Black)",
														"Each",
														"7",
														"13",
														"15",
														"91",
														"13.65",
														"59.5",
														"104.65",
														"7",
														"0",
														"11"
													],
													[
														"7216098",
														"40778",
														"127",
														"1",
														"93",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"39",
														"2533",
														"Plush shark slippers (Gray) M",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"24",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7198639",
														"60159",
														"0",
														"0",
														"161",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"505",
														"RC toy sedan car with remote control (Red) 1/50 scale",
														"Each",
														"7",
														"25",
														"15",
														"175",
														"26.25",
														"87.5",
														"201.25",
														"7",
														"0",
														"11"
													],
													[
														"7199000",
														"57156",
														"0",
														"0",
														"103",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"1077",
														"Superhero action jacket (Blue) 5XL",
														"Each",
														"2",
														"34",
														"15",
														"68",
														"10.2",
														"20",
														"78.2",
														"2",
														"0",
														"11"
													],
													[
														"7203141",
														"50767",
														"5",
														"1",
														"99",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"26",
														"590",
														"Dinosaur battery-powered slippers (Green) XL",
														"Each",
														"6",
														"32",
														"15",
														"192",
														"28.8",
														"141",
														"220.8",
														"6",
														"0",
														"11"
													],
													[
														"7200562",
														"53360",
														"0",
														"0",
														"14",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"403",
														"Permanent marker black 5mm nib (Black) 5mm",
														"Each",
														"96",
														"2.7",
														"15",
														"259.2",
														"38.88",
														"96",
														"298.08",
														"96",
														"0",
														"11"
													],
													[
														"7207883",
														"68806",
														"0",
														"0",
														"75",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"11",
														"742",
														"Halloween zombie mask (Light Brown) XL",
														"Each",
														"24",
														"18",
														"15",
														"432",
														"64.8",
														"-24",
														"496.8",
														"24",
														"0",
														"11"
													],
													[
														"7302144",
														"55146",
														"262",
														"202",
														"162",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"15",
														"1547",
														"RC toy sedan car with remote control (Black) 1/50 scale",
														"Each",
														"5",
														"25",
														"15",
														"125",
														"18.75",
														"62.5",
														"143.75",
														"5",
														"0",
														"11"
													],
													[
														"7306765",
														"63578",
														"0",
														"0",
														"3",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"35",
														"1306",
														"Void fill 200 L bag (White) 200L",
														"Each",
														"80",
														"25",
														"15",
														"2000",
														"300",
														"720",
														"2300",
														"80",
														"0",
														"11"
													],
													[
														"7218386",
														"38886",
														"0",
														"0",
														"77",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"29",
														"892",
														"Halloween zombie mask (Light Brown) M",
														"Each",
														"72",
														"18",
														"15",
														"1296",
														"194.4",
														"-72",
														"1490.4",
														"72",
														"0",
														"11"
													],
													[
														"7210947",
														"70923",
														"79",
														"1",
														"177",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"35",
														"1529",
														"Developer joke mug - understanding recursion requires understanding recursion (Black)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7201048",
														"73651",
														"0",
														"0",
														"189",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"23",
														"286",
														"Developer joke mug - Oct 31 = Dec 25 (Black)",
														"Each",
														"9",
														"13",
														"15",
														"117",
														"17.55",
														"76.5",
														"134.55",
														"9",
														"0",
														"11"
													],
													[
														"7197869",
														"45165",
														"0",
														"0",
														"87",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"828",
														"Furry gorilla with big eyes slippers (Black) XL",
														"Each",
														"7",
														"32",
														"15",
														"224",
														"33.6",
														"164.5",
														"257.6",
														"7",
														"0",
														"11"
													],
													[
														"7216410",
														"72450",
														"204",
														"202",
														"85",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"868",
														"Animal with big feet slippers (Brown) M",
														"Each",
														"7",
														"32",
														"15",
														"224",
														"33.6",
														"168",
														"257.6",
														"7",
														"0",
														"11"
													],
													[
														"7210831",
														"56294",
														"0",
														"0",
														"158",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"501",
														"RC toy sedan car with remote control (Yellow) 1/50 scale",
														"Each",
														"1",
														"25",
														"15",
														"25",
														"3.75",
														"12.5",
														"28.75",
														"1",
														"0",
														"11"
													],
													[
														"7213052",
														"72761",
														"0",
														"0",
														"50",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"36",
														"1968",
														"20 mm Anti static bubble wrap (Blue) 50m",
														"Each",
														"70",
														"102",
														"15",
														"7140",
														"1071",
														"3290",
														"8211",
														"70",
														"0",
														"11"
													],
													[
														"7201293",
														"63578",
														"0",
														"0",
														"91",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"402",
														"Plush shark slippers (Gray) XL",
														"Each",
														"5",
														"32",
														"15",
														"160",
														"24",
														"117.5",
														"184",
														"5",
														"0",
														"11"
													],
													[
														"7198054",
														"67391",
														"356",
														"202",
														"100",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"208",
														"Dinosaur battery-powered slippers (Green) L",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"24",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7203275",
														"40550",
														"98",
														"1",
														"98",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"991",
														"Ogre battery-powered slippers (Green) S",
														"Each",
														"9",
														"32",
														"15",
														"288",
														"43.2",
														"216",
														"331.2",
														"9",
														"0",
														"11"
													],
													[
														"7201896",
														"57834",
														"269",
														"202",
														"87",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"1584",
														"Furry gorilla with big eyes slippers (Black) XL",
														"Each",
														"2",
														"32",
														"15",
														"64",
														"9.6",
														"47",
														"73.6",
														"2",
														"0",
														"11"
													],
													[
														"7194817",
														"69424",
														"0",
														"0",
														"192",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"36",
														"1469",
														"DBA joke mug - two types of DBAs (White)",
														"Each",
														"9",
														"13",
														"15",
														"117",
														"17.55",
														"76.5",
														"134.55",
														"9",
														"0",
														"11"
													],
													[
														"7190558",
														"69264",
														"0",
														"0",
														"141",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"405",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (White) S\"",
														"Each",
														"72",
														"18",
														"15",
														"1296",
														"194.4",
														"792",
														"1490.4",
														"72",
														"0",
														"11"
													],
													[
														"7201119",
														"57487",
														"0",
														"0",
														"55",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"1141",
														"10 mm Anti static bubble wrap (Blue) 10m",
														"Each",
														"10",
														"26",
														"15",
														"260",
														"39",
														"90",
														"299",
														"10",
														"0",
														"11"
													],
													[
														"7207360",
														"38318",
														"187",
														"1",
														"89",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"31",
														"1667",
														"Furry gorilla with big eyes slippers (Black) M",
														"Each",
														"5",
														"32",
														"15",
														"160",
														"24",
														"120",
														"184",
														"5",
														"0",
														"11"
													],
													[
														"7390961",
														"48331",
														"347",
														"202",
														"215",
														"2000-03-15T00:00:00",
														"2000-03-16T00:00:00",
														"23",
														"724",
														"USB food flash drive - hamburger",
														"Each",
														"9",
														"32",
														"15",
														"288",
														"43.2",
														"180",
														"331.2",
														"9",
														"0",
														"11"
													],
													[
														"7185882",
														"64003",
														"0",
														"0",
														"195",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"166",
														"DBA joke mug - I will get you in order (Black)",
														"Each",
														"10",
														"13",
														"15",
														"130",
														"19.5",
														"85",
														"149.5",
														"10",
														"0",
														"11"
													],
													[
														"7207183",
														"68806",
														"0",
														"0",
														"179",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"644",
														"Developer joke mug - (hip, hip, array) (Black)",
														"Each",
														"8",
														"13",
														"15",
														"104",
														"15.6",
														"68",
														"119.6",
														"8",
														"0",
														"11"
													],
													[
														"7201844",
														"74028",
														"202",
														"202",
														"203",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"40",
														"2387",
														"DBA joke mug - mind if I join you? (Black)",
														"Each",
														"9",
														"13",
														"15",
														"117",
														"17.55",
														"76.5",
														"134.55",
														"9",
														"0",
														"11"
													],
													[
														"7195365",
														"55567",
														"0",
														"0",
														"41",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"6",
														"443",
														"Shipping carton (Brown) 229x229x229mm",
														"Each",
														"225",
														"1.05",
														"15",
														"236.25",
														"35.44",
														"112.5",
														"271.69",
														"225",
														"0",
														"11"
													],
													[
														"7191646",
														"39898",
														"194",
														"1",
														"200",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"786",
														"DBA joke mug - you might be a DBA if (White)",
														"Each",
														"6",
														"13",
														"15",
														"78",
														"11.7",
														"51",
														"89.7",
														"6",
														"0",
														"11"
													],
													[
														"7195667",
														"70871",
														"86",
														"1",
														"184",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"422",
														"Developer joke mug - when your hammer is C++ (White)",
														"Each",
														"6",
														"13",
														"15",
														"78",
														"11.7",
														"51",
														"89.7",
														"6",
														"0",
														"11"
													],
													[
														"7189368",
														"67996",
														"0",
														"0",
														"183",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"163",
														"Developer joke mug - when your hammer is C++ (Black)",
														"Each",
														"8",
														"13",
														"15",
														"104",
														"15.6",
														"68",
														"119.6",
														"8",
														"0",
														"11"
													],
													[
														"7184929",
														"72156",
														"0",
														"0",
														"200",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"209",
														"DBA joke mug - you might be a DBA if (White)",
														"Each",
														"1",
														"13",
														"15",
														"13",
														"1.95",
														"8.5",
														"14.95",
														"1",
														"0",
														"11"
													],
													[
														"7190090",
														"54129",
														"0",
														"0",
														"98",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"1468",
														"Ogre battery-powered slippers (Green) S",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"24",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7284171",
														"53792",
														"167",
														"1",
														"137",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"35",
														"1206",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (White) XXL\"",
														"Each",
														"120",
														"18",
														"15",
														"2160",
														"324",
														"1260",
														"2484",
														"120",
														"0",
														"11"
													],
													[
														"7182712",
														"58467",
														"324",
														"202",
														"200",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"205",
														"DBA joke mug - you might be a DBA if (White)",
														"Each",
														"1",
														"13",
														"15",
														"13",
														"1.95",
														"8.5",
														"14.95",
														"1",
														"0",
														"11"
													],
													[
														"7192553",
														"56757",
														"0",
														"0",
														"111",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"6",
														"71",
														"Superhero action jacket (Blue) XS",
														"Each",
														"7",
														"25",
														"15",
														"175",
														"26.25",
														"42",
														"201.25",
														"7",
														"0",
														"11"
													],
													[
														"7316874",
														"50539",
														"0",
														"0",
														"203",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"15",
														"1409",
														"DBA joke mug - mind if I join you? (Black)",
														"Each",
														"7",
														"13",
														"15",
														"91",
														"13.65",
														"59.5",
														"104.65",
														"7",
														"0",
														"11"
													],
													[
														"7178755",
														"39240",
														"22",
														"1",
														"204",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"23",
														"666",
														"DBA joke mug - mind if I join you? (White)",
														"Each",
														"7",
														"13",
														"15",
														"91",
														"13.65",
														"59.5",
														"104.65",
														"7",
														"0",
														"11"
													],
													[
														"7184636",
														"60159",
														"0",
														"0",
														"159",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"31",
														"1687",
														"RC toy sedan car with remote control (Green) 1/50 scale",
														"Each",
														"1",
														"25",
														"15",
														"25",
														"3.75",
														"12.5",
														"28.75",
														"1",
														"0",
														"11"
													],
													[
														"7189737",
														"56995",
														"289",
														"202",
														"170",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"1586",
														"Developer joke mug - old C developers never die (White)",
														"Each",
														"7",
														"13",
														"15",
														"91",
														"13.65",
														"59.5",
														"104.65",
														"7",
														"0",
														"11"
													],
													[
														"7176478",
														"51006",
														"119",
														"1",
														"34",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"424",
														"Shipping carton (Brown) 457x457x457mm",
														"Each",
														"175",
														"2.1",
														"15",
														"367.5",
														"55.13",
														"175",
														"422.63",
														"175",
														"0",
														"11"
													],
													[
														"7183739",
														"67967",
														"0",
														"0",
														"191",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"937",
														"DBA joke mug - two types of DBAs (Black)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7175460",
														"67832",
														"80",
														"1",
														"92",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"11",
														"1369",
														"Plush shark slippers (Gray) L",
														"Each",
														"3",
														"32",
														"15",
														"96",
														"14.4",
														"72",
														"110.4",
														"3",
														"0",
														"11"
													],
													[
														"7216501",
														"64853",
														"302",
														"202",
														"192",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"242",
														"DBA joke mug - two types of DBAs (White)",
														"Each",
														"2",
														"13",
														"15",
														"26",
														"3.9",
														"17",
														"29.9",
														"2",
														"0",
														"11"
													],
													[
														"7230182",
														"56883",
														"0",
														"0",
														"188",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"1527",
														"Developer joke mug - that's a hardware problem (White)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7213743",
														"41081",
														"380",
														"202",
														"96",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"263",
														"Ogre battery-powered slippers (Green) L",
														"Each",
														"4",
														"32",
														"15",
														"128",
														"19.2",
														"96",
														"147.2",
														"4",
														"0",
														"11"
													],
													[
														"7214944",
														"38886",
														"0",
														"0",
														"150",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"262",
														"Ride on toy sedan car (Green) 1/12 scale",
														"Each",
														"7",
														"230",
														"15",
														"1610",
														"241.5",
														"595",
														"1851.5",
														"7",
														"0",
														"11"
													],
													[
														"7239845",
														"66773",
														"299",
														"202",
														"180",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"482",
														"Developer joke mug - (hip, hip, array) (White)",
														"Each",
														"1",
														"13",
														"15",
														"13",
														"1.95",
														"8.5",
														"14.95",
														"1",
														"0",
														"11"
													],
													[
														"7315266",
														"46801",
														"0",
														"0",
														"83",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"12",
														"444",
														"Animal with big feet slippers (Brown) XL",
														"Each",
														"10",
														"32",
														"15",
														"320",
														"48",
														"235",
														"368",
														"10",
														"0",
														"11"
													],
													[
														"7205347",
														"65982",
														"0",
														"0",
														"124",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"186",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (Black) XXL\"",
														"Each",
														"24",
														"18",
														"15",
														"432",
														"64.8",
														"252",
														"496.8",
														"24",
														"0",
														"11"
													],
													[
														"7317128",
														"46564",
														"181",
														"1",
														"132",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"25",
														"783",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (White) 7XL\"",
														"Each",
														"36",
														"18",
														"15",
														"648",
														"97.2",
														"342",
														"745.2",
														"36",
														"0",
														"11"
													],
													[
														"7211409",
														"41981",
														"0",
														"0",
														"185",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"506",
														"Developer joke mug - fun was unexpected at this time (Black)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7233370",
														"53360",
														"0",
														"0",
														"174",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"47",
														"2834",
														"Developer joke mug - a foo walks into a bar (White)",
														"Each",
														"5",
														"13",
														"15",
														"65",
														"9.75",
														"42.5",
														"74.75",
														"5",
														"0",
														"11"
													],
													[
														"7203791",
														"64565",
														"0",
														"0",
														"45",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"589",
														"Bubblewrap dispenser (Blue) 1.5m",
														"Each",
														"3",
														"240",
														"15",
														"720",
														"108",
														"390",
														"828",
														"3",
														"0",
														"11"
													],
													[
														"7210992",
														"51708",
														"0",
														"0",
														"177",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"126",
														"Developer joke mug - understanding recursion requires understanding recursion (Black)",
														"Each",
														"10",
														"13",
														"15",
														"130",
														"19.5",
														"85",
														"149.5",
														"10",
														"0",
														"11"
													],
													[
														"7313053",
														"52862",
														"355",
														"202",
														"118",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"12",
														"564",
														"Alien officer hoodie (Black) XL",
														"Each",
														"8",
														"35",
														"15",
														"280",
														"42",
														"144",
														"322",
														"8",
														"0",
														"11"
													],
													[
														"7305014",
														"50119",
														"0",
														"0",
														"215",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"21",
														"34",
														"USB food flash drive - hamburger",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"20",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7217235",
														"48519",
														"46",
														"1",
														"211",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"23",
														"994",
														"USB food flash drive - banana",
														"Each",
														"10",
														"32",
														"15",
														"320",
														"48",
														"200",
														"368",
														"10",
														"0",
														"11"
													],
													[
														"7213576",
														"68806",
														"0",
														"0",
														"94",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"9",
														"643",
														"Plush shark slippers (Gray) S",
														"Each",
														"8",
														"32",
														"15",
														"256",
														"38.4",
														"192",
														"294.4",
														"8",
														"0",
														"11"
													],
													[
														"7211657",
														"47757",
														"0",
														"0",
														"181",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"35",
														"1245",
														"Developer joke mug - inheritance is the OO way to become wealthy (Black)",
														"Each",
														"7",
														"13",
														"15",
														"91",
														"13.65",
														"59.5",
														"104.65",
														"7",
														"0",
														"11"
													],
													[
														"7216158",
														"40778",
														"127",
														"1",
														"93",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"39",
														"2533",
														"Plush shark slippers (Gray) M",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"24",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7198699",
														"60159",
														"0",
														"0",
														"161",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"21",
														"505",
														"RC toy sedan car with remote control (Red) 1/50 scale",
														"Each",
														"7",
														"25",
														"15",
														"175",
														"26.25",
														"87.5",
														"201.25",
														"7",
														"0",
														"11"
													],
													[
														"7199060",
														"57156",
														"0",
														"0",
														"103",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"1077",
														"Superhero action jacket (Blue) 5XL",
														"Each",
														"2",
														"34",
														"15",
														"68",
														"10.2",
														"20",
														"78.2",
														"2",
														"0",
														"11"
													],
													[
														"7203201",
														"50767",
														"5",
														"1",
														"99",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"26",
														"590",
														"Dinosaur battery-powered slippers (Green) XL",
														"Each",
														"6",
														"32",
														"15",
														"192",
														"28.8",
														"141",
														"220.8",
														"6",
														"0",
														"11"
													],
													[
														"7200622",
														"53360",
														"0",
														"0",
														"14",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"403",
														"Permanent marker black 5mm nib (Black) 5mm",
														"Each",
														"96",
														"2.7",
														"15",
														"259.2",
														"38.88",
														"96",
														"298.08",
														"96",
														"0",
														"11"
													],
													[
														"7207943",
														"68806",
														"0",
														"0",
														"75",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"11",
														"742",
														"Halloween zombie mask (Light Brown) XL",
														"Each",
														"24",
														"18",
														"15",
														"432",
														"64.8",
														"-24",
														"496.8",
														"24",
														"0",
														"11"
													],
													[
														"7302204",
														"55146",
														"262",
														"202",
														"162",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"15",
														"1547",
														"RC toy sedan car with remote control (Black) 1/50 scale",
														"Each",
														"5",
														"25",
														"15",
														"125",
														"18.75",
														"62.5",
														"143.75",
														"5",
														"0",
														"11"
													],
													[
														"7306825",
														"63578",
														"0",
														"0",
														"3",
														"2000-03-14T00:00:00",
														"2000-03-15T00:00:00",
														"35",
														"1306",
														"Void fill 200 L bag (White) 200L",
														"Each",
														"80",
														"25",
														"15",
														"2000",
														"300",
														"720",
														"2300",
														"80",
														"0",
														"11"
													],
													[
														"7218446",
														"38886",
														"0",
														"0",
														"77",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"29",
														"892",
														"Halloween zombie mask (Light Brown) M",
														"Each",
														"72",
														"18",
														"15",
														"1296",
														"194.4",
														"-72",
														"1490.4",
														"72",
														"0",
														"11"
													],
													[
														"7211007",
														"70923",
														"79",
														"1",
														"177",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"35",
														"1529",
														"Developer joke mug - understanding recursion requires understanding recursion (Black)",
														"Each",
														"4",
														"13",
														"15",
														"52",
														"7.8",
														"34",
														"59.8",
														"4",
														"0",
														"11"
													],
													[
														"7201108",
														"73651",
														"0",
														"0",
														"189",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"23",
														"286",
														"Developer joke mug - Oct 31 = Dec 25 (Black)",
														"Each",
														"9",
														"13",
														"15",
														"117",
														"17.55",
														"76.5",
														"134.55",
														"9",
														"0",
														"11"
													],
													[
														"7197929",
														"45165",
														"0",
														"0",
														"87",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"15",
														"828",
														"Furry gorilla with big eyes slippers (Black) XL",
														"Each",
														"7",
														"32",
														"15",
														"224",
														"33.6",
														"164.5",
														"257.6",
														"7",
														"0",
														"11"
													],
													[
														"7216470",
														"72450",
														"204",
														"202",
														"85",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"868",
														"Animal with big feet slippers (Brown) M",
														"Each",
														"7",
														"32",
														"15",
														"224",
														"33.6",
														"168",
														"257.6",
														"7",
														"0",
														"11"
													],
													[
														"7210891",
														"56294",
														"0",
														"0",
														"158",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"501",
														"RC toy sedan car with remote control (Yellow) 1/50 scale",
														"Each",
														"1",
														"25",
														"15",
														"25",
														"3.75",
														"12.5",
														"28.75",
														"1",
														"0",
														"11"
													],
													[
														"7213112",
														"72761",
														"0",
														"0",
														"50",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"36",
														"1968",
														"20 mm Anti static bubble wrap (Blue) 50m",
														"Each",
														"70",
														"102",
														"15",
														"7140",
														"1071",
														"3290",
														"8211",
														"70",
														"0",
														"11"
													],
													[
														"7201353",
														"63578",
														"0",
														"0",
														"91",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"19",
														"402",
														"Plush shark slippers (Gray) XL",
														"Each",
														"5",
														"32",
														"15",
														"160",
														"24",
														"117.5",
														"184",
														"5",
														"0",
														"11"
													],
													[
														"7198114",
														"67391",
														"356",
														"202",
														"100",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"7",
														"208",
														"Dinosaur battery-powered slippers (Green) L",
														"Each",
														"1",
														"32",
														"15",
														"32",
														"4.8",
														"24",
														"36.8",
														"1",
														"0",
														"11"
													],
													[
														"7203335",
														"40550",
														"98",
														"1",
														"98",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"991",
														"Ogre battery-powered slippers (Green) S",
														"Each",
														"9",
														"32",
														"15",
														"288",
														"43.2",
														"216",
														"331.2",
														"9",
														"0",
														"11"
													],
													[
														"7201956",
														"57834",
														"269",
														"202",
														"87",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"1584",
														"Furry gorilla with big eyes slippers (Black) XL",
														"Each",
														"2",
														"32",
														"15",
														"64",
														"9.6",
														"47",
														"73.6",
														"2",
														"0",
														"11"
													],
													[
														"7194877",
														"69424",
														"0",
														"0",
														"192",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"36",
														"1469",
														"DBA joke mug - two types of DBAs (White)",
														"Each",
														"9",
														"13",
														"15",
														"117",
														"17.55",
														"76.5",
														"134.55",
														"9",
														"0",
														"11"
													],
													[
														"7190618",
														"69264",
														"0",
														"0",
														"141",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"12",
														"405",
														"\"\"\"The Gu\"\" red shirt XML tag t-shirt (White) S\"",
														"Each",
														"72",
														"18",
														"15",
														"1296",
														"194.4",
														"792",
														"1490.4",
														"72",
														"0",
														"11"
													],
													[
														"7228719",
														"57487",
														"0",
														"0",
														"55",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"25",
														"1141",
														"10 mm Anti static bubble wrap (Blue) 10m",
														"Each",
														"10",
														"26",
														"15",
														"260",
														"39",
														"90",
														"299",
														"10",
														"0",
														"11"
													],
													[
														"7207420",
														"38318",
														"187",
														"1",
														"89",
														"2000-03-13T00:00:00",
														"2000-03-14T00:00:00",
														"31",
														"1667",
														"Furry gorilla with big eyes slippers (Black) M",
														"Each",
														"5",
														"32",
														"15",
														"160",
														"24",
														"120",
														"184",
														"5",
														"0",
														"11"
													]
												],
												"1": [
													{
														"columnName": "SaleKey",
														"dataTypeName": "int",
														"ordinal": 0
													},
													{
														"columnName": "CityKey",
														"dataTypeName": "int",
														"ordinal": 1
													},
													{
														"columnName": "CustomerKey",
														"dataTypeName": "int",
														"ordinal": 2
													},
													{
														"columnName": "BillToCustomerKey",
														"dataTypeName": "int",
														"ordinal": 3
													},
													{
														"columnName": "StockItemKey",
														"dataTypeName": "int",
														"ordinal": 4
													},
													{
														"columnName": "InvoiceDateKey",
														"dataTypeName": "datetime2",
														"ordinal": 5
													},
													{
														"columnName": "DeliveryDateKey",
														"dataTypeName": "datetime2",
														"ordinal": 6
													},
													{
														"columnName": "SalespersonKey",
														"dataTypeName": "int",
														"ordinal": 7
													},
													{
														"columnName": "WWIInvoicID",
														"dataTypeName": "int",
														"ordinal": 8
													},
													{
														"columnName": "Description",
														"dataTypeName": "varchar",
														"ordinal": 9
													},
													{
														"columnName": "Package",
														"dataTypeName": "varchar",
														"ordinal": 10
													},
													{
														"columnName": "Quantity",
														"dataTypeName": "int",
														"ordinal": 11
													},
													{
														"columnName": "UnitPrice",
														"dataTypeName": "float",
														"ordinal": 12
													},
													{
														"columnName": "TaxRate",
														"dataTypeName": "float",
														"ordinal": 13
													},
													{
														"columnName": "TotalExcludingTax",
														"dataTypeName": "float",
														"ordinal": 14
													},
													{
														"columnName": "TaxAmount",
														"dataTypeName": "float",
														"ordinal": 15
													},
													{
														"columnName": "Profit",
														"dataTypeName": "float",
														"ordinal": 16
													},
													{
														"columnName": "TotalIncludingTax",
														"dataTypeName": "float",
														"ordinal": 17
													},
													{
														"columnName": "TotalDryItems",
														"dataTypeName": "int",
														"ordinal": 18
													},
													{
														"columnName": "TotalChillerItems",
														"dataTypeName": "int",
														"ordinal": 19
													},
													{
														"columnName": "LineageKey",
														"dataTypeName": "int",
														"ordinal": 20
													}
												]
											}
										],
										"schema": [
											{
												"key": "0",
												"name": "data",
												"type": "ArrayType(ArrayType(StringType,true),true)"
											},
											{
												"key": "1",
												"name": "schema",
												"type": "ArrayType(StructType(StructField(columnName,StringType,true), StructField(dataTypeName,StringType,true), StructField(ordinal,LongType,true)),true)"
											}
										]
									},
									"isSummary": false,
									"language": "scala"
								},
								"persist_state": {
									"view": {
										"type": "details",
										"chartOptions": {
											"chartType": "bar",
											"aggregationType": "count",
											"categoryFieldKeys": [],
											"seriesFieldKeys": [
												"0"
											],
											"isStacked": false
										}
									}
								}
							}
						}
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"bdbjblobstorageqingtest\"\n",
							"blob_container_name = \"container02\"\n",
							"from pyspark.sql import SparkSession\n",
							"\n",
							"sc = SparkSession.builder.getOrCreate()\n",
							"token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
							"blob_sas_token = token_library.getConnectionString(\"AzureBlobStorage\")\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.load('wasbs://container02@bdbjblobstorageqingtest.blob.core.windows.net/New folder 1220/SQL script 5.json', format='json')\n",
							"display(df.limit(10))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Blob - Explorer - Select a file - Top menu - New notebook - load to Dataframe - txt')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "52fc197f-787f-4650-83e2-f30f412a4e63"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"bdbjblobstorageqingtest\"\n",
							"blob_container_name = \"container02\"\n",
							"from pyspark.sql import SparkSession\n",
							"\n",
							"sc = SparkSession.builder.getOrCreate()\n",
							"token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
							"blob_sas_token = token_library.getConnectionString(\"AzureBlobStorage\")\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.load('wasbs://container02@bdbjblobstorageqingtest.blob.core.windows.net/New folder 1220/SearchLog.txt', format='text')\n",
							"df.write.mode(\"overwrite\").saveAsTable(\"default.YourTableName\")"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Blob - Explorer - Select a file - Top menu - New notebook - load to Dataframe')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "e5a9996d-c672-4e5e-b9e9-a4c7e2ecfe10"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"bdbjblobstorageqingtest\"\n",
							"blob_container_name = \"container02\"\n",
							"from pyspark.sql import SparkSession\n",
							"\n",
							"sc = SparkSession.builder.getOrCreate()\n",
							"token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
							"blob_sas_token = token_library.getConnectionString(\"AzureBlobStorage\")\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.load('wasbs://container02@bdbjblobstorageqingtest.blob.core.windows.net/New folder 1220/S312.csv', format='csv'\n",
							"## Ifâ€¯headerâ€¯existsâ€¯uncommentâ€¯lineâ€¯below\n",
							"##, header=True\n",
							")\n",
							"display(df.limit(10))"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Blob - Explorer - Select a file - Top menu - New notebook - new spark table')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "4052d33d-108c-4d87-9144-51eeeeb39a75"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"bdbjblobstorageqingtest\"\n",
							"blob_container_name = \"container02\"\n",
							"from pyspark.sql import SparkSession\n",
							"\n",
							"sc = SparkSession.builder.getOrCreate()\n",
							"token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
							"blob_sas_token = token_library.getConnectionString(\"AzureBlobStorage\")\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.load('wasbs://container02@bdbjblobstorageqingtest.blob.core.windows.net/New folder 1220/S312.csv', format='csv'\n",
							"## Ifâ€¯headerâ€¯existsâ€¯uncommentâ€¯lineâ€¯below\n",
							"##, header=True\n",
							")\n",
							"df.write.mode(\"overwrite\").saveAsTable(\"default.YourTableName\")"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyDataBetweenSparkTables1220')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "45085683-6e05-46df-a72a-47c877a9ea59"
					}
				},
				"metadata": {
					"saveOutput": false,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true,
							"tags": [
								"parameters"
							]
						},
						"source": [
							"pipeline_name = 'pipeline_name'\r\n",
							"tag = 'tag'"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"source": [
							"source_df = spark.sql(\"SELECT * FROM default.NYC_Taxi\")"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"import time\r\n",
							"a = time.strftime(\"%Y%m%d_%H%M%S\", time.localtime())"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"source_df.write.mode(\"overwrite\").saveAsTable(\"default.NYC_Taxi_\" + pipeline_name + \"_\" + tag + \"_\" + a)"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyDataBetweenSparkTables1222hou')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "5c23cfb7-4cb8-46c1-97e3-165ed38da884"
					}
				},
				"metadata": {
					"saveOutput": false,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true,
							"tags": [
								"parameters"
							]
						},
						"source": [
							"pipeline_name = 'pipeline_name'\r\n",
							"tag = 'tag'"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"source": [
							"source_df = spark.sql(\"SELECT * FROM default.NYC_Taxi\")"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"import time\r\n",
							"a = time.strftime(\"%Y%m%d_%H%M%S\", time.localtime())"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"source_df.write.mode(\"overwrite\").saveAsTable(\"default.NYC_Taxi_\" + pipeline_name + \"_\" + tag + \"_\" + a)"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Interview')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "fe9c71c5-3550-446d-9997-9c644dbbd27b"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"azureopendatastorage\"\n",
							"blob_container_name = \"nyctlc\"\n",
							"blob_relative_path = \"fhv\"\n",
							"blob_sas_token = r\"\"\n",
							"# Allow SPARK to read from Blob remotely\n",
							"wasbs_path = 'wasbs://%s@%s.blob.core.windows.net/%s' % (blob_container_name, blob_account_name, blob_relative_path)\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.parquet(wasbs_path)\n",
							"df.printSchema()\n",
							"\n",
							"#å‡ºç§Ÿæ±½è½¦ï¼ˆâ€œFHVâ€ï¼‰è¡Œç¨‹è®°å½•åŒ…æ‹¬æ±½è½¦ç‰Œç…§ã€ä¸Šè½¦æ—¥æœŸã€ä¸‹è½¦æ—¶é—´å’Œå‡ºç§Ÿè½¦åŒºåŸŸä½ç½®IDçš„å­—æ®µ\n",
							"#æ³¨æ„è€ƒè™‘æ•°æ®é‡å¤"
						],
						"outputs": [],
						"execution_count": 38
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\r\n",
							"display(df.limit(10))"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"df=df.sample(False,0.01,0).unionAll(df.sample(False,0.001,0))"
						],
						"outputs": [],
						"execution_count": 39
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"from pyspark.sql.functions import *"
						],
						"outputs": [],
						"execution_count": 40
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 1.æ±‚æ¯å¤©å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 2.æ±‚æ¯æœˆï¼ˆä»¥æ¯æœˆä¸€å·ä¸ºæ ‡è¯†ï¼‰è½¦è¾†æ•°é‡ï¼Œæ·»åŠ ä¸€åˆ—æ˜¯å¦è¶…è¿‡500è¾†è½¦"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 10
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 3.æ±‚æ¯å‘¨ï¼ˆä»¥å‘¨æ—¥ä¸ºæ ‡è¯†ï¼‰å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡ï¼ŒæŒ‰æ—¶é—´é€†åº"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"from pyspark.sql.types import *"
						],
						"outputs": [],
						"execution_count": 27
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 33
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 34
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 4. æ±‚2019å¹´æ¯ä¸ªæœˆçš„å¹³å‡æ¯è¾†è½¦å‡ºè½¦çŽ‡\r\n",
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 44
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 5. æ±‚è¿žç»­å‡ºè½¦3ä¸ªæœˆçš„è½¦è¾†"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 53
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 6. æ±‚è¡Œé©¶æ—¶é—´æœ€é•¿çš„çš„å‰100è¾†è½¦,å¹¶æ˜¾ç¤ºè¡Œé©¶å°æ—¶æ•°"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 58
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Interview2')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "562b33fb-6c3c-4cc5-b529-a813244c45e8"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"azureopendatastorage\"\n",
							"blob_container_name = \"nyctlc\"\n",
							"blob_relative_path = \"fhv\"\n",
							"blob_sas_token = r\"\"\n",
							"# Allow SPARK to read from Blob remotely\n",
							"wasbs_path = 'wasbs://%s@%s.blob.core.windows.net/%s' % (blob_container_name, blob_account_name, blob_relative_path)\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.parquet(wasbs_path)\n",
							"df.printSchema()\n",
							"\n",
							"#å‡ºç§Ÿæ±½è½¦ï¼ˆâ€œFHVâ€ï¼‰è¡Œç¨‹è®°å½•åŒ…æ‹¬æ±½è½¦ç‰Œç…§ã€ä¸Šè½¦æ—¥æœŸã€ä¸‹è½¦æ—¶é—´å’Œå‡ºç§Ÿè½¦åŒºåŸŸä½ç½®IDçš„å­—æ®µ\n",
							"#æ³¨æ„è€ƒè™‘æ•°æ®é‡å¤"
						],
						"outputs": [],
						"execution_count": 38
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\r\n",
							"display(df.limit(10))"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"df=df.sample(False,0.01,0).unionAll(df.sample(False,0.001,0))"
						],
						"outputs": [],
						"execution_count": 39
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"from pyspark.sql.functions import *"
						],
						"outputs": [],
						"execution_count": 40
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 1.æ±‚æ¯å¤©å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 2.æ±‚æ¯æœˆï¼ˆä»¥æ¯æœˆä¸€å·ä¸ºæ ‡è¯†ï¼‰è½¦è¾†æ•°é‡ï¼Œæ·»åŠ ä¸€åˆ—æ˜¯å¦è¶…è¿‡500è¾†è½¦"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 10
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 3.æ±‚æ¯å‘¨ï¼ˆä»¥å‘¨æ—¥ä¸ºæ ‡è¯†ï¼‰å‡ºè½¦æ•°é‡å’Œè½¦è¾†æ•°é‡ï¼ŒæŒ‰æ—¶é—´é€†åº"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"from pyspark.sql.types import *"
						],
						"outputs": [],
						"execution_count": 27
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 33
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 34
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 4. æ±‚2019å¹´æ¯ä¸ªæœˆçš„å¹³å‡æ¯è¾†è½¦å‡ºè½¦çŽ‡\r\n",
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 44
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 5. æ±‚è¿žç»­å‡ºè½¦3ä¸ªæœˆçš„è½¦è¾†"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 53
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# 6. æ±‚è¡Œé©¶æ—¶é—´æœ€é•¿çš„çš„å‰100è¾†è½¦,å¹¶æ˜¾ç¤ºè¡Œé©¶å°æ—¶æ•°"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": 58
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Kusto - OE - A table - New notebook -  Write DataFrame to table')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "c5834627-f1df-42e8-b773-5e70fdaf2e9d"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"\n",
							"# Write data to a Azure Data Explorer table\n",
							"# Full Sample Code available at: https://github.com/Azure/azure-kusto-spark/blob/master/samples/src/main/python/SynapseSample.py\n",
							"\n",
							"df.write \\\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasource\") \\\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\n",
							"    .option(\"kustoTable\", \"Qingtest\") \\\n",
							"    .option(\"tableCreateOptions\",\"CreateIfNotExist\") \\\n",
							"    .mode(\"Append\") \\\n",
							"    .save()\n",
							""
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Kusto - OE - A table - New notebook - Write DataFrame to table')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "728bb7d5-adb8-4b3b-a589-c8d1f315585c"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1",
						"state": {
							"79ce3caf-f148-43bc-9af4-8deffa27fd94": {
								"type": "Synapse.DataFrame",
								"sync_state": {
									"table": {
										"rows": [
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 00:00:00",
												"2": "2592",
												"3": "13208",
												"4": "NORTH CAROLINA",
												"5": "Thunderstorm Wind",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "0",
												"11": "0",
												"12": "Public",
												"13": "CASAR",
												"14": "CASAR",
												"15": "35.52",
												"16": "-81.63",
												"17": "35.52",
												"18": "-81.63",
												"19": "A small cluster of thunderstorms moved rapidly across the foothills and piedmont of western North Carolina, producing scattered wind damage.",
												"20": "Several trees down.",
												"21": "{\"TotalDamages\":0,\"Details\":{\"Description\":\"Several trees down.\",\"Location\":\"NORTH CAROLINA\"},\"EndTime\":\"2007-01-01T00:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 05:00:00",
												"2": "4171",
												"3": "23358",
												"4": "WISCONSIN",
												"5": "Winter Storm",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "0",
												"11": "0",
												"12": "COOP Observer",
												"13": "",
												"14": "",
												"19": "A powerful storm system moved from the southern plains through eastern Wisconsin, bringing copious amounts of precipitation to northwest Wisconsin from December 30th through the morning of January 1st. Deep tropical moisture out ahead of the storm brought heavy rains to the area on December 30th and 31st. Many areas saw over 1 inch of rain. Cold air wrapped around the system and changed the rain over to snow New Year's Eve. The snow finally ended during the early morning hours of New Year's Day, with the heaviest amounts of 6 to 12 inches reported across Ashland and Iron counties.",
												"20": "",
												"21": "{\"TotalDamages\":0,\"Details\":{\"Description\":\"\",\"Location\":\"WISCONSIN\"},\"EndTime\":\"2007-01-01T05:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 05:00:00",
												"2": "4171",
												"3": "23357",
												"4": "WISCONSIN",
												"5": "Winter Storm",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "0",
												"11": "0",
												"12": "COOP Observer",
												"13": "",
												"14": "",
												"19": "A powerful storm system moved from the southern plains through eastern Wisconsin, bringing copious amounts of precipitation to northwest Wisconsin from December 30th through the morning of January 1st. Deep tropical moisture out ahead of the storm brought heavy rains to the area on December 30th and 31st. Many areas saw over 1 inch of rain. Cold air wrapped around the system and changed the rain over to snow New Year's Eve. The snow finally ended during the early morning hours of New Year's Day, with the heaviest amounts of 6 to 12 inches reported across Ashland and Iron counties.",
												"20": "",
												"21": "{\"TotalDamages\":0,\"Details\":{\"Description\":\"\",\"Location\":\"WISCONSIN\"},\"EndTime\":\"2007-01-01T05:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9494",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "2000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":2000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9488",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "2000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":2000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9487",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "2000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":2000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9485",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "3000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":3000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9486",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "3000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":3000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9493",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "2000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":2000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											},
											{
												"0": "2007-01-01 00:00:00",
												"1": "2007-01-01 06:00:00",
												"2": "1930",
												"3": "9489",
												"4": "NEW YORK",
												"5": "Winter Weather",
												"6": "0",
												"7": "0",
												"8": "0",
												"9": "0",
												"10": "2000",
												"11": "0",
												"12": "Department of Highways",
												"13": "",
												"14": "",
												"19": "A weak area of low pressure moved across Ontario and Quebec provinces in Canada during the morning and afternoon of the 1st. Mild, moist air traveled over a seasonably cool airmass across New York and this resulted in a period of freezing rain from around Midnight to just before dawn. Freezing rain accumulated up to 1/4 of an inch across northern New York resulting in slick roads and several vehicle accidents.",
												"20": "",
												"21": "{\"TotalDamages\":2000,\"Details\":{\"Description\":\"\",\"Location\":\"NEW YORK\"},\"EndTime\":\"2007-01-01T06:00:00.0000000Z\",\"StartTime\":\"2007-01-01T00:00:00.0000000Z\"}"
											}
										],
										"schema": [
											{
												"key": "0",
												"name": "StartTime",
												"type": "timestamp"
											},
											{
												"key": "1",
												"name": "EndTime",
												"type": "timestamp"
											},
											{
												"key": "2",
												"name": "EpisodeId",
												"type": "int"
											},
											{
												"key": "3",
												"name": "EventId",
												"type": "int"
											},
											{
												"key": "4",
												"name": "State",
												"type": "string"
											},
											{
												"key": "5",
												"name": "EventType",
												"type": "string"
											},
											{
												"key": "6",
												"name": "InjuriesDirect",
												"type": "int"
											},
											{
												"key": "7",
												"name": "InjuriesIndirect",
												"type": "int"
											},
											{
												"key": "8",
												"name": "DeathsDirect",
												"type": "int"
											},
											{
												"key": "9",
												"name": "DeathsIndirect",
												"type": "int"
											},
											{
												"key": "10",
												"name": "DamageProperty",
												"type": "int"
											},
											{
												"key": "11",
												"name": "DamageCrops",
												"type": "int"
											},
											{
												"key": "12",
												"name": "Source",
												"type": "string"
											},
											{
												"key": "13",
												"name": "BeginLocation",
												"type": "string"
											},
											{
												"key": "14",
												"name": "EndLocation",
												"type": "string"
											},
											{
												"key": "15",
												"name": "BeginLat",
												"type": "double"
											},
											{
												"key": "16",
												"name": "BeginLon",
												"type": "double"
											},
											{
												"key": "17",
												"name": "EndLat",
												"type": "double"
											},
											{
												"key": "18",
												"name": "EndLon",
												"type": "double"
											},
											{
												"key": "19",
												"name": "EpisodeNarrative",
												"type": "string"
											},
											{
												"key": "20",
												"name": "EventNarrative",
												"type": "string"
											},
											{
												"key": "21",
												"name": "StormSummary",
												"type": "string"
											}
										]
									},
									"isSummary": false,
									"language": "scala"
								},
								"persist_state": {
									"view": {
										"type": "details",
										"chartOptions": {
											"chartType": "bar",
											"aggregationType": "sum",
											"categoryFieldKeys": [
												"0"
											],
											"seriesFieldKeys": [
												"2"
											],
											"isStacked": false
										}
									}
								}
							}
						}
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"\n",
							"# Read data from Azure Data Explorer table(s)\n",
							"# Full Sample Code available at: https://github.com/Azure/azure-kusto-spark/blob/master/samples/src/main/python/SynapseSample.py\n",
							"\n",
							"kustoDf  = spark.read \\\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasource\") \\\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\n",
							"    .option(\"kustoQuery\", \"Qingtest | take 10\") \\\n",
							"    .load()\n",
							"\n",
							"display(kustoDf)\n",
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Kusto - OE - A table - New notebook - Write streaming DataFrame to table')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "3286bc65-805d-4b34-8393-269d82eca8f6"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"\n",
							"# Write a streaming Spark DataFrame to a Azure Data Explorer table\n",
							"# Full Sample Code available at: https://github.com/Azure/azure-kusto-spark/blob/master/samples/src/main/python/SynapseSample.py\n",
							"\n",
							"dfStream = spark \\\n",
							"  .readStream \\\n",
							"  .schema([customSchema]) \\\n",
							"  .csv([filename]) \\\n",
							"\n",
							"spark.conf.set(\"spark.sql.streaming.checkpointLocation\", \"/localWriteCheckpointFolder\")\n",
							"spark.conf.set(\"spark.sql.codegen.wholeStage\", \"false\")\n",
							"\n",
							"kustoQ = dfStream \\\n",
							"    .writeStream \\\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasink.KustoSynapseSinkProvider\") \\\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\n",
							"    .option(\"kustoTable\", \"Qingtest\") \\\n",
							"    .option(\"tableCreateOptions\",\"CreateIfNotExist\") \\\n",
							"    .trigger(once = True)\n",
							"\n",
							"kustoQ.start().awaitTermination(60*8)\n",
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 2
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Kusto Sample')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "c1fcc19f-cca3-4658-a2b4-9411756833b3"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"\n",
							"# Read data from Azure Data Explorer table(s)\n",
							"# Full Sample Code available at: https://github.com/Azure/azure-kusto-spark/blob/master/samples/src/main/python/SynapseSample.py\n",
							"\n",
							"kustoDf  = spark.read \\\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasource\") \\\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\n",
							"    .option(\"kustoQuery\", \"Qingtest | take 10\") \\\n",
							"    .load()\n",
							"\n",
							"display(kustoDf)\n",
							""
						],
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"kustoDf.write \\\r\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasource\") \\\r\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\r\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\r\n",
							"    .option(\"kustoTable\", \"Qingtest1011\") \\\r\n",
							"    .option(\"tableCreateOptions\",\"CreateIfNotExist\") \\\r\n",
							"    .mode(\"Append\") \\\r\n",
							"    .save()"
						],
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"from pyspark.sql.types import *\r\n",
							"customSchema = StructType([StructField('Id_P', IntegerType(), True),  \\\r\n",
							"                           StructField('LastName', StringType(), True), \\\r\n",
							"                           StructField('FirstName', StringType(), True), \\\r\n",
							"                           StructField('Address', StringType(), True), \\\r\n",
							"                           StructField('City', StringType(), True)] )\r\n",
							"                 \r\n",
							"\r\n",
							"dfStream = spark \\\r\n",
							"  .readStream \\\r\n",
							"  .schema(customSchema) \\\r\n",
							"  .csv(\"abfss://default@honghaigen2.dfs.core.windows.net/csv/\") \\\r\n",
							"\r\n",
							"spark.conf.set(\"spark.sql.streaming.checkpointLocation\", \"/localWriteCheckpointFolder\")\r\n",
							"spark.conf.set(\"spark.sql.codegen.wholeStage\", \"false\")\r\n",
							"\r\n",
							"kustoQ = dfStream \\\r\n",
							"    .writeStream \\\r\n",
							"    .format(\"com.microsoft.kusto.spark.synapse.datasink.KustoSynapseSinkProvider\") \\\r\n",
							"    .option(\"spark.synapse.linkedService\", \"AzureDataExplorer\") \\\r\n",
							"    .option(\"kustoDatabase\", \"bdbjkustodatabaseqingtest\") \\\r\n",
							"    .option(\"kustoTable\", \"Qingtest101101\") \\\r\n",
							"    .option(\"tableCreateOptions\",\"CreateIfNotExist\") \\\r\n",
							"    .trigger(once = True)\r\n",
							"\r\n",
							"kustoQ.start().awaitTermination(60*8)"
						],
						"outputs": [],
						"execution_count": 3
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 1')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "8c049941-04d6-4c74-8911-9eb5238e75a0"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"pandemicdatalake\"\n",
							"blob_container_name = \"public\"\n",
							"blob_relative_path = \"curated/covid-19/bing_covid-19_data/latest/bing_covid-19_data.parquet\"\n",
							"blob_sas_token = r\"\"\n",
							"# Allow SPARK to read from Blob remotely\n",
							"wasbs_path = 'wasbs://%s@%s.blob.core.windows.net/%s' % (blob_container_name, blob_account_name, blob_relative_path)\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.parquet(wasbs_path)\n",
							"display(df.limit(10))"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 2')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "561c99f9-7eb3-4e62-8350-f27d4159bc61"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"automaticScaleJobs": true
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {},
						"source": [
							"%%pyspark\n",
							"blob_account_name = \"pandemicdatalake\"\n",
							"blob_container_name = \"public\"\n",
							"blob_relative_path = \"curated/covid-19/bing_covid-19_data/latest/bing_covid-19_data.parquet\"\n",
							"blob_sas_token = r\"\"\n",
							"# Allow SPARK to read from Blob remotely\n",
							"wasbs_path = 'wasbs://%s@%s.blob.core.windows.net/%s' % (blob_container_name, blob_account_name, blob_relative_path)\n",
							"\n",
							"spark.conf.set(\n",
							"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
							"    blob_sas_token)\n",
							"df = spark.read.parquet(wasbs_path)\n",
							"df.write.mode(\"overwrite\").saveAsTable(\"default.YourTableName\")"
						],
						"outputs": [],
						"execution_count": 1
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 3')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "New folder"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao2",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "5b7a3470-0be4-4b23-998b-2d2ec80a3915"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao2",
						"name": "zhao2",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao2",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"print(1+1)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 4')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "New folder"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "11b0135a-4e70-41a7-85c8-2aed3ed07b9e"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import math\r\n",
							"from pyspark.context import SparkContext\r\n",
							"import pandas.core.accessor as abc\r\n",
							"\r\n",
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"a"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 5')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "New folder"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "96770419-de67-42fd-b1a1-7ecab06dc798"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "scala"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%spark\n",
							"val df = spark.read.sqlanalytics(\"SampleSQL.dbo.person\") \n",
							"df.write.mode(\"overwrite\").saveAsTable(\"default.t1\")"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 3
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebooktest1222hou')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "New folder"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1,
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "0eb90d3b-2c64-41d0-acbc-ecceb7b27aab"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/ee9a0083-b9db-4f2d-9cb9-05a291e9c158/resourceGroups/bdbjqa/providers/Microsoft.Synapse/workspaces/bdbj20211220ws/bigDataPools/zhao",
						"name": "zhao",
						"type": "Spark",
						"endpoint": "https://bdbj20211220ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/zhao",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28,
						"extraHeader": null
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import time\r\n",
							"a = time.strftime(\"%Y%m%d_%H%M%S\", time.localtime())"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"print(a)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Spark job definition 1220')]",
			"type": "Microsoft.Synapse/workspaces/sparkJobDefinitions",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"targetBigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"requiredSparkVersion": "3.1",
				"language": "python",
				"jobProperties": {
					"name": "Spark job definition 1220",
					"file": "abfss://default@honghaigen2.dfs.core.windows.net/synapse/workspaces/bdbj20211220ws/batchjobs/Spark%20job%20definition%201220/copy_opendataset_to_spark_table.py",
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "1",
						"spark.autotune.trackingId": "be5b1469-36c5-4eb4-ac76-1164f1a059fe"
					},
					"args": [],
					"jars": [],
					"files": [],
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Spark job definition 1221')]",
			"type": "Microsoft.Synapse/workspaces/sparkJobDefinitions",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"targetBigDataPool": {
					"referenceName": "zhao",
					"type": "BigDataPoolReference"
				},
				"requiredSparkVersion": "3.1",
				"language": "python",
				"jobProperties": {
					"name": "Spark job definition 1221",
					"file": "abfss://default@honghaigen2.dfs.core.windows.net/synapse/workspaces/bdbj20211220ws/batchjobs/Spark%20job%20definition%201221/copy_opendataset_to_spark_table.py",
					"conf": {
						"spark.dynamicAllocation.enabled": "true",
						"spark.dynamicAllocation.minExecutors": "1",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "8b6d735c-2bc0-405b-8070-e467cdba6125"
					},
					"args": [],
					"jars": [],
					"files": [],
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 1
				}
			},
			"dependsOn": []
		}
	]
}